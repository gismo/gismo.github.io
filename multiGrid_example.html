<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<title>G+Smo: multiGrid_example.cpp</title>
<link href="gismodoxy_tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://people.ricam.oeaw.ac.at/gismo/mj/MathJax.js"></script>
<link href="doxygen.css"   rel="stylesheet" type="text/css" />
<link href="gismodoxy.css" rel="stylesheet" type="text/css">
<!--  -->
<!-- <script type="text/javascript"> -->
<!-- </script> -->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- <a name="top"></a> -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="gslogo-doxy.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname"><a href="index.html"><font style="font-variant:small-caps;">G+S</font><font style="font-variant:small-caps;"
															    color="#000000">mo</font></a>
   &#160;<span id="projectnumber">25.01.0</span>
   </div>
   <div id="projectbrief">Geometry + Simulation Modules</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('multiGrid_example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">multiGrid_example.cpp</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>We consider the Poisson boundary value problem (for simplicity here only with Dirichlet conditions):  </p><p class="formulaDsp">
\begin{eqnarray*}
           -\Delta u &amp;=&amp; f \quad \text{in} \quad \Omega,         \\
                   u &amp;=&amp; g \quad \text{on} \quad \partial\Omega.
\end{eqnarray*}
</p>
<p> Its variational form is: Find \( u\in V_g \) such that  </p><p class="formulaDsp">
\[
    \int_\Omega \nabla u \nabla v \text{ d} x = \int_\Omega f v \text{ d}x
\]
</p>
<p> for all \( u\in V_0 \).</p>
<p>For a hierarchy of grids with levels \(\ell=0 \mbox{ (=coarsest)},
1,2,\ldots,L \mbox{ (=finest)} \), we have subspaces \( V_\ell \subset H^1(\Omega) \) and  </p><p class="formulaDsp">
\[
    V_{\ell,g} = V_\ell \cap V_g
    \quad\mbox{and}\quad
    V_{\ell,0} = V_\ell \cap V_0.
\]
</p>
<p> On each of the levels, we have a linear system  </p><p class="formulaDsp">
\[
    A_\ell \; \underline u_\ell = \underline f_\ell.
\]
</p>
<p>The relation between these spaces are realized for \( \ell = 0,1,\ldots,L-1 \) by transfer matrices  </p><p class="formulaDsp">
\[
    P_\ell \in \mathbb R^{\dim V_{\ell+1} \times \dim V_\ell}\;,
\]
</p>
<p> which represent the canonical embedding  </p><p class="formulaDsp">
\[
    V_{\ell} \rightarrow V_{\ell+1}.
\]
</p>
<p>Having the matrix \( A_L \) on the finest grid level, we can set up the fine-grid matrices via the Galerkin principle:  </p><p class="formulaDsp">
\[
      A_{\ell} = P_\ell^{\top} A_{\ell+1} P_\ell.
      \qquad (*)
\]
</p>
<p>Now, we discuss the example file <em>multiGrid_example.cpp</em>. After reading the command line arguments, we read in the geometry file and modify the geometry as desired:</p>
<div class="fragment"><div class="line">    <a class="code hl_typedef" href="classgismo_1_1gsMultiPatch.html#ad7190c68d8ead80bd1b6fd7256779894">gsMultiPatch&lt;&gt;::uPtr</a> mpPtr = gsReadFile&lt;&gt;(geometry);</div>
<div class="ttc" id="aclassgismo_1_1gsMultiPatch_html_ad7190c68d8ead80bd1b6fd7256779894"><div class="ttname"><a href="classgismo_1_1gsMultiPatch.html#ad7190c68d8ead80bd1b6fd7256779894">gismo::gsMultiPatch::uPtr</a></div><div class="ttdeci">memory::unique_ptr&lt; gsMultiPatch &gt; uPtr</div><div class="ttdoc">Unique pointer for gsMultiPatch.</div><div class="ttdef"><b>Definition</b> gsMultiPatch.h:109</div></div>
</div><!-- fragment --> <div class="fragment"><div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i=0; i&lt;splitPatches; ++i)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;split patches uniformly... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line">        mp = mp.uniformSplit();</div>
<div class="line">    }</div>
<div class="ttc" id="agsConfig_8h_html_ad722078677c063a09661059674fb996c"><div class="ttname"><a href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a></div><div class="ttdeci">#define index_t</div><div class="ttdef"><b>Definition</b> gsConfig.h:32</div></div>
<div class="ttc" id="agsDebug_8h_html_af6177e1e282640c3cb9175565f84a432"><div class="ttname"><a href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a></div><div class="ttdeci">#define gsInfo</div><div class="ttdef"><b>Definition</b> gsDebug.h:43</div></div>
</div><!-- fragment --><p>Then, we set up the right-hand-side \( f \) and a <em><a class="el" href="classgismo_1_1gsBoundaryConditions.html" title="Class containing a set of boundary conditions.">gsBoundaryConditions</a></em> object based on the command line arguments:</p>
<div class="fragment"><div class="line">    <span class="comment">// Right-hand-side</span></div>
<div class="line">    gsFunctionExpr&lt;&gt; f( <span class="stringliteral">&quot;2*sin(x)*cos(y)&quot;</span>, mp.geoDim() );</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Dirichlet function</span></div>
<div class="line">    gsFunctionExpr&lt;&gt; gD( <span class="stringliteral">&quot;sin(x)*cos(y)&quot;</span>, mp.geoDim() );</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Neumann</span></div>
<div class="line">    gsConstantFunction&lt;&gt; gN( 1.0, mp.geoDim() );</div>
<div class="line"> </div>
<div class="line">    gsBoundaryConditions&lt;&gt; bc;</div>
</div><!-- fragment --><p>Then, we extract the basis from the multi patch object to obtain a multi basis.</p>
<div class="fragment"><div class="line">    gsMultiBasis&lt;&gt; mb(mp);</div>
</div><!-- fragment --><p>There are a few possibilities to modify the geometry, which can be activated using the command line and which can found in the full listings.</p>
<p>Since the multigrid solver also works for a discontinuous Galerkin (dG) setting, we allow to modify the discretizations in order to obtain non-matching discretizations at the interfaces as a more appropriate test case for a dG setting.</p>
<div class="fragment"><div class="line">    <span class="keywordflow">if</span> (nonMatching)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Option NonMatching: Make uniform refinement for every third patch... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; mb.nBases(); ++i)</div>
<div class="line">            <span class="keywordflow">if</span> ( i%3 == 0 )</div>
<div class="line">                mb[i].uniformRefine();</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done.\n&quot;</span>;</div>
<div class="line">        --refinements;</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Option NonMatching: Increase spline degree for every other third patch... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; mb.nBases(); ++i)</div>
<div class="line">            <span class="keywordflow">if</span> ( i%3 == 1 )</div>
<div class="line">                mb[i].setDegreePreservingMultiplicity(degree+1);</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done.\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (!dg)</div>
<div class="line">        {</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;\nThe option --NonMatching does not allow a conforming discretization. Thus, option --DG is required.\n&quot;</span>;</div>
<div class="line">            <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">    }</div>
</div><!-- fragment --><p>We set the spline degree as required at the command line. Moreover, we apply the given number of uniform refinement steps.</p>
<div class="fragment"><div class="line">    <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> i = 0; i &lt; mb.nBases(); ++ i )</div>
<div class="line">        mb[i].setDegreePreservingMultiplicity(degree);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> ( <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i = 0; i &lt; refinements; ++i )</div>
<div class="line">        mb.uniformRefine();</div>
</div><!-- fragment --><p>Now, we assemble the linear system and the right-hand side using the <em>gsPoissionAssembler</em>.</p>
<div class="fragment"><div class="line">    gsPoissonAssembler&lt;&gt; assembler(</div>
<div class="line">        mp,</div>
<div class="line">        mb,</div>
<div class="line">        bc,</div>
<div class="line">        f,</div>
<div class="line">        (dirichlet::strategy) cmd.getInt(<span class="stringliteral">&quot;MG.DirichletStrategy&quot;</span>),</div>
<div class="line">        (iFace::strategy)     cmd.getInt(<span class="stringliteral">&quot;MG.InterfaceStrategy&quot;</span>)</div>
<div class="line">    );</div>
<div class="line">    assembler.assemble();</div>
</div><!-- fragment --><p>Here, we set up a vector that stores the transfer matrices. Moreover, we set up data structures that are needed for the subspace corrected mass smoother.</p>
<div class="fragment"><div class="line">    std::vector&lt; gsSparseMatrix&lt;real_t,RowMajor&gt; &gt; transferMatrices;</div>
<div class="line">    std::vector&lt; gsMultiBasis&lt;real_t&gt; &gt; multiBases;  <span class="comment">// Needed for setupSubspaceCorrectedMassSmoother</span></div>
<div class="line">    std::vector&lt;real_t&gt; patchLocalDampingParameters; <span class="comment">// Needed for setupSubspaceCorrectedMassSmoother</span></div>
</div><!-- fragment --><p>The class <em><a class="el" href="classgismo_1_1gsGridHierarchy.html" title="Grid Hierarchy.">gsGridHierarchy</a></em> allows to set up a grid hierarchy. In a Finite Element setting, the coarsening of meshes is a non-trivial task. For tensor-product grids in Isogeometric Analysis, the coarsening of grids is a rather simple task. Therefore, we use a coarsening algorithm (alternatively, the class also provides refinement strategies).</p>
<p>The function has to know the boundary conditions and the assembler options in order to know about the eliminated dofs (particularly on the Dirichlet boundary) and the coupled dofs on the interfaces between the patches.</p>
<p>In any case, we have to export the transfer matrices \( P_\ell \). The subspace corrected mass smoother also requires the <em><a class="el" href="classgismo_1_1gsMultiBasis.html" title="Holds a set of patch-wise bases and their topology information.">gsMultiBasis</a></em> objects for all grid levels.</p>
<p>If one wants to apply this to systems of PDEs, it is expected to have individual grid hierarchies for all of the variables.</p>
<p>We use a unnamed temporary object, which means that the object cleaned up immediately after exporting the data.</p>
<div class="fragment"><div class="line">    <a class="code hl_function" href="classgismo_1_1gsGridHierarchy.html#ace87bc249f301ae48c9ac5683eae72c5">gsGridHierarchy&lt;&gt;::buildByCoarsening</a>(<a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(mb), bc, cmd.getGroup(<span class="stringliteral">&quot;MG&quot;</span>))</div>
<div class="line">        .<a class="code hl_function" href="classgismo_1_1gsGridHierarchy.html#a3cd75bdae99496321a275c20c8085d37">moveMultiBasesTo</a>(multiBases)</div>
<div class="line">        .<a class="code hl_function" href="classgismo_1_1gsGridHierarchy.html#ac7a26e8ea14b96b52d4e1154b1d6ead7">moveTransferMatricesTo</a>(transferMatrices);</div>
<div class="ttc" id="aclassgismo_1_1gsGridHierarchy_html_a3cd75bdae99496321a275c20c8085d37"><div class="ttname"><a href="classgismo_1_1gsGridHierarchy.html#a3cd75bdae99496321a275c20c8085d37">gismo::gsGridHierarchy::moveMultiBasesTo</a></div><div class="ttdeci">gsGridHierarchy &amp; moveMultiBasesTo(std::vector&lt; gsMultiBasis&lt; T &gt; &gt; &amp;o)</div><div class="ttdoc">Get the vector of gsMultiBasis objects.</div><div class="ttdef"><b>Definition</b> gsGridHierarchy.h:154</div></div>
<div class="ttc" id="aclassgismo_1_1gsGridHierarchy_html_ac7a26e8ea14b96b52d4e1154b1d6ead7"><div class="ttname"><a href="classgismo_1_1gsGridHierarchy.html#ac7a26e8ea14b96b52d4e1154b1d6ead7">gismo::gsGridHierarchy::moveTransferMatricesTo</a></div><div class="ttdeci">gsGridHierarchy &amp; moveTransferMatricesTo(std::vector&lt; gsSparseMatrix&lt; T, RowMajor &gt; &gt; &amp;o)</div><div class="ttdoc">Get the vector of transfer matrices.</div><div class="ttdef"><b>Definition</b> gsGridHierarchy.h:162</div></div>
<div class="ttc" id="aclassgismo_1_1gsGridHierarchy_html_ace87bc249f301ae48c9ac5683eae72c5"><div class="ttname"><a href="classgismo_1_1gsGridHierarchy.html#ace87bc249f301ae48c9ac5683eae72c5">gismo::gsGridHierarchy::buildByCoarsening</a></div><div class="ttdeci">static gsGridHierarchy buildByCoarsening(gsMultiBasis&lt; T &gt; mBasis, const gsBoundaryConditions&lt; T &gt; &amp;boundaryConditions, const gsOptionList &amp;assemblerOptions, index_t levels, index_t degreesOfFreedom=0, index_t unk=0)</div><div class="ttdoc">This function sets up a grid hierarchy by coarsening.</div><div class="ttdef"><b>Definition</b> gsGridHierarchy.hpp:57</div></div>
<div class="ttc" id="anamespacegismo_html_ab72442c3b5aeef49b3c60f6e9df77110"><div class="ttname"><a href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">gismo::give</a></div><div class="ttdeci">S give(S &amp;x)</div><div class="ttdef"><b>Definition</b> gsMemory.h:266</div></div>
</div><!-- fragment --><p>Having the transfer matrices, we set up the multigrid object. The class <em>gsMultiGrid</em> is purely algebraic, so it assumes as inputs only matrices (as <em><a class="el" href="classgismo_1_1gsSparseMatrix.html" title="Sparse matrix class, based on gsEigen::SparseMatrix.">gsSparseMatrix</a></em> or <em><a class="el" href="classgismo_1_1gsLinearOperator.html" title="Simple abstract class for discrete operators.">gsLinearOperator</a></em> for matrix-free implementations) and vectors (as a \gsMatrix).</p>
<p>It is possible to provide the stiffness matrices for all grid levels, the prolongation operators, the restriction operators and the solver for the coarsest grid level, all of them as <em><a class="el" href="classgismo_1_1gsLinearOperator.html" title="Simple abstract class for discrete operators.">gsLinearOperator</a></em>.</p>
<p>However, it is sufficient to provide the stiffness matrix for the <em>finest grid</em> as a <em><a class="el" href="classgismo_1_1gsSparseMatrix.html" title="Sparse matrix class, based on gsEigen::SparseMatrix.">gsSparseMatrix</a></em> and all of the transfer matrices as a RowMajor <em><a class="el" href="classgismo_1_1gsSparseMatrix.html" title="Sparse matrix class, based on gsEigen::SparseMatrix.">gsSparseMatrix</a></em>, as we do here. In this case</p>
<ul>
<li>the stiffness matrices on the coarse levels are constructed by the Galerkin principle (*),</li>
<li>the transfer matrices are used as prolongation operators, and</li>
<li>the transposed transfer matrices are used as restriction operators.</li>
</ul>
<p>With the member setOptions, we provide various settings, like the number of presmoothing steps, the number of post smoothing steps, and the type of the cycle (1 = V-cycle and 2 = W-cycle). These options can also be set using the corresponding member functions.</p>
<div class="fragment"><div class="line">    <a class="code hl_typedef" href="classgismo_1_1gsMultiGridOp.html#a1693f061596a1ece25c96f7900b573a3">gsMultiGridOp&lt;&gt;::Ptr</a> mg = <a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#aa379574148d989edf4572077d919d546">gsMultiGridOp&lt;&gt;::make</a>( assembler.matrix(), transferMatrices );</div>
<div class="line">    mg-&gt;setOptions( cmd.getGroup(<span class="stringliteral">&quot;MG&quot;</span>) );</div>
<div class="ttc" id="aclassgismo_1_1gsMultiGridOp_html_a1693f061596a1ece25c96f7900b573a3"><div class="ttname"><a href="classgismo_1_1gsMultiGridOp.html#a1693f061596a1ece25c96f7900b573a3">gismo::gsMultiGridOp::Ptr</a></div><div class="ttdeci">memory::shared_ptr&lt; gsMultiGridOp &gt; Ptr</div><div class="ttdoc">Shared pointer for gsMultiGridOp.</div><div class="ttdef"><b>Definition</b> gsMultiGrid.h:63</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiGridOp_html_aa379574148d989edf4572077d919d546"><div class="ttname"><a href="classgismo_1_1gsMultiGridOp.html#aa379574148d989edf4572077d919d546">gismo::gsMultiGridOp::make</a></div><div class="ttdeci">static uPtr make(SpMatrix fineMatrix, std::vector&lt; SpMatrixRowMajor &gt; transferMatrices, OpPtr coarseSolver=OpPtr())</div><div class="ttdoc">Make function returning smart pointer.</div><div class="ttdef"><b>Definition</b> gsMultiGrid.h:136</div></div>
</div><!-- fragment --><p>If we do not provide a coarse solver explicitly, a LU solver will be set up automatically with the first multigrid cycle that is applied. Since we are solving an elliptic problem in this example file, we explicitly set up a Cholesky solver.</p>
<p>Here, mg-&gt;matrix(0) refers to the matrix on the coarsest grid level.</p>
<div class="fragment"><div class="line">    mg-&gt;setCoarseSolver( makeSparseCholeskySolver( mg-&gt;matrix(0) ) );</div>
</div><!-- fragment --><p>The smoothers have to be provided for the grid levels \( \ell=1, 2, \ldots, L \). Depending on the command line options, we use</p><ul>
<li>a Richardson smoother,</li>
<li>a Jacobi smoother,</li>
<li>a Gauss-Seidel smoother,</li>
<li>an incomplete LU smoother,</li>
<li>a subspace corrected mass smoother, or</li>
<li>a hybrid smoother (subspace corrected mass smoother + Gauss-Seidel smoother).</li>
</ul>
<p>The subspace corrected mass smoother is a multi-patch version as introduced in</p>
<ul>
<li>C. Hofreither and S. Takacs. Robust multigrid for Isogeometric Analysis based on stable splittings of spline spaces. SIAM J. on Numerical Analysis, vol. 55 (4), p. 2004 &ndash; 2024, 2017.</li>
<li>S. Takacs. Robust approximation error estimates and multigrid solvers for isogeometric multi-patch discretizations. Mathematical Models and Methods in Applied Sciences, vol. 28 (10), p. 1899 &ndash; 1928, 2018.</li>
</ul>
<div class="fragment"><div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i = 1; i &lt; mg-&gt;numLevels(); ++i)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_typedef" href="classgismo_1_1gsPreconditionerOp.html#a73ef689606fbfc5909797bc3e417a4ce">gsPreconditionerOp&lt;&gt;::Ptr</a> smootherOp;</div>
<div class="line">        <span class="keywordflow">if</span> ( smoother == <span class="stringliteral">&quot;Richardson&quot;</span> || smoother == <span class="stringliteral">&quot;r&quot;</span> )</div>
<div class="line">            smootherOp = makeRichardsonOp(mg-&gt;matrix(i));</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( smoother == <span class="stringliteral">&quot;Jacobi&quot;</span> || smoother == <span class="stringliteral">&quot;j&quot;</span> )</div>
<div class="line">            smootherOp = makeJacobiOp(mg-&gt;matrix(i));</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( smoother == <span class="stringliteral">&quot;GaussSeidel&quot;</span> || smoother == <span class="stringliteral">&quot;gs&quot;</span> )</div>
<div class="line">            smootherOp = makeGaussSeidelOp(mg-&gt;matrix(i));</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( smoother == <span class="stringliteral">&quot;IncompleteLU&quot;</span> || smoother == <span class="stringliteral">&quot;ilu&quot;</span> )</div>
<div class="line">            smootherOp = makeIncompleteLUOp(mg-&gt;matrix(i));</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( smoother == <span class="stringliteral">&quot;SubspaceCorrectedMassSmoother&quot;</span> || smoother == <span class="stringliteral">&quot;scms&quot;</span> )</div>
<div class="line">            smootherOp = setupSubspaceCorrectedMassSmoother( i, mg-&gt;numLevels(), mg-&gt;matrix(i),</div>
<div class="line">                multiBases[i], bc, cmd.getGroup(<span class="stringliteral">&quot;MG&quot;</span>), patchLocalDampingParameters );</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( smoother == <span class="stringliteral">&quot;Hybrid&quot;</span> || smoother == <span class="stringliteral">&quot;hyb&quot;</span> )</div>
<div class="line">            smootherOp = <a class="code hl_function" href="classgismo_1_1gsCompositePrecOp.html#a885737d651450065132a97a910b7c9d3">gsCompositePrecOp&lt;&gt;::make</a>(</div>
<div class="line">                makeGaussSeidelOp(mg-&gt;matrix(i)),</div>
<div class="line">                setupSubspaceCorrectedMassSmoother( i, mg-&gt;numLevels(), mg-&gt;matrix(i),</div>
<div class="line">                    multiBases[i], bc, cmd.getGroup(<span class="stringliteral">&quot;MG&quot;</span>), patchLocalDampingParameters )</div>
<div class="line">                );</div>
<div class="ttc" id="aclassgismo_1_1gsCompositePrecOp_html_a885737d651450065132a97a910b7c9d3"><div class="ttname"><a href="classgismo_1_1gsCompositePrecOp.html#a885737d651450065132a97a910b7c9d3">gismo::gsCompositePrecOp::make</a></div><div class="ttdeci">static uPtr make(std::vector&lt; BasePtr &gt; ops)</div><div class="ttdoc">Make command returning a smart pointer.</div><div class="ttdef"><b>Definition</b> gsCompositePrecOp.h:66</div></div>
<div class="ttc" id="aclassgismo_1_1gsPreconditionerOp_html_a73ef689606fbfc5909797bc3e417a4ce"><div class="ttname"><a href="classgismo_1_1gsPreconditionerOp.html#a73ef689606fbfc5909797bc3e417a4ce">gismo::gsPreconditionerOp::Ptr</a></div><div class="ttdeci">memory::shared_ptr&lt; gsPreconditionerOp &gt; Ptr</div><div class="ttdoc">Shared pointer for gsLinearOperator.</div><div class="ttdef"><b>Definition</b> gsPreconditioner.h:47</div></div>
</div><!-- fragment --><p>We now provide the smoother with the respective options (like damping parameters).</p>
<div class="fragment"><div class="line">        smootherOp-&gt;setOptions( cmd.getGroup(<span class="stringliteral">&quot;MG&quot;</span>) );</div>
</div><!-- fragment --><p>Finally, we provide the smoother to the multigrid object.</p>
<div class="fragment"><div class="line">        mg-&gt;setSmoother(i, smootherOp);</div>
<div class="line">    } <span class="comment">// end for</span></div>
</div><!-- fragment --><p>We use a random vector as initial guess.</p>
<div class="fragment"><div class="line">    gsMatrix&lt;&gt; x;</div>
<div class="line">    x.setRandom( assembler.matrix().rows(), 1 );</div>
</div><!-- fragment --><p>As a next step, we solve the linear system using either a conjugate gradient solver with multigrid preconditioner or by iterating multigrid itself. The latter is to be represented as preconditioned gradient (=Richardson) solver.</p>
<div class="fragment"><div class="line">    <span class="keywordflow">if</span> (iterativeSolver==<span class="stringliteral">&quot;cg&quot;</span>)</div>
<div class="line">        gsConjugateGradient&lt;&gt;( assembler.matrix(), mg )</div>
<div class="line">            .setOptions( cmd.getGroup(<span class="stringliteral">&quot;Solver&quot;</span>) )</div>
<div class="line">            .solveDetailed( assembler.rhs(), x, errorHistory );</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iterativeSolver==<span class="stringliteral">&quot;d&quot;</span>)</div>
<div class="line">        gsGradientMethod&lt;&gt;( assembler.matrix(), mg )</div>
<div class="line">            .setOptions( cmd.getGroup(<span class="stringliteral">&quot;Solver&quot;</span>) )</div>
<div class="line">            .solveDetailed( assembler.rhs(), x, errorHistory );</div>
</div><!-- fragment --><h1><a class="anchor" id="multiGrid_exampleAnnotated"></a>
Annotated source file</h1>
<p>Here is the full file <code>examples/multiGrid_example.cpp</code>. Clicking on a function or class name will lead you to its reference documentation.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;ctime&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="gismo_8h.html">gismo.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacegismo.html">gismo</a>;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="classgismo_1_1gsPreconditionerOp.html#a73ef689606fbfc5909797bc3e417a4ce">gsPreconditionerOp&lt;&gt;::Ptr</a> setupSubspaceCorrectedMassSmoother(<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a>, <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a>, <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;&gt;</a>&amp;,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsMultiBasis.html">gsMultiBasis&lt;&gt;</a>&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsBoundaryConditions.html">gsBoundaryConditions&lt;&gt;</a>&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsOptionList.html">gsOptionList</a>&amp;, std::vector&lt;real_t&gt;&amp; );</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line"><span class="comment">    /************** Define command line options *************/</span></div>
<div class="line"> </div>
<div class="line">    std::string geometry(<span class="stringliteral">&quot;domain2d/yeti_mp2.xml&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> splitPatches = 0;</div>
<div class="line">    real_t stretchGeometry = 1;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> xRefine = 0;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> refinements = 3;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> degree = 2;</div>
<div class="line">    <span class="keywordtype">bool</span> nonMatching = <span class="keyword">false</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> dg = <span class="keyword">false</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> nitsche = <span class="keyword">false</span>;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> levels = -1;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> cycles = 1;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> presmooth = 1;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> postsmooth = 1;</div>
<div class="line">    <span class="keywordtype">bool</span> extrasmooth = <span class="keyword">false</span>;</div>
<div class="line">    std::string smoother(<span class="stringliteral">&quot;GaussSeidel&quot;</span>);</div>
<div class="line">    real_t damping = -1;</div>
<div class="line">    real_t scaling = 0.12;</div>
<div class="line">    std::string iterativeSolver(<span class="stringliteral">&quot;cg&quot;</span>);</div>
<div class="line">    real_t tolerance = 1.e-8;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> maxIterations = 100;</div>
<div class="line">    std::string boundaryConditions(<span class="stringliteral">&quot;d&quot;</span>);</div>
<div class="line">    std::string out;</div>
<div class="line">    <span class="keywordtype">bool</span> plot = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsCmdLine.html">gsCmdLine</a> cmd(<span class="stringliteral">&quot;Solves a PDE with an isogeometric discretization using a multigrid solver.&quot;</span>);</div>
<div class="line">    cmd.addString(<span class="stringliteral">&quot;g&quot;</span>, <span class="stringliteral">&quot;Geometry&quot;</span>,              <span class="stringliteral">&quot;Geometry file&quot;</span>, geometry);</div>
<div class="line">    cmd.addInt   (<span class="stringliteral">&quot;&quot;</span>,  <span class="stringliteral">&quot;SplitPatches&quot;</span>,          <span class="stringliteral">&quot;Split every patch that many times in 2^d patches&quot;</span>, splitPatches);</div>
<div class="line">    cmd.addReal  (<span class="stringliteral">&quot;&quot;</span>,  <span class="stringliteral">&quot;StretchGeometry&quot;</span>,       <span class="stringliteral">&quot;Stretch geometry in x-direction by the given factor&quot;</span>, stretchGeometry);</div>
<div class="line">    cmd.addInt   (<span class="stringliteral">&quot;&quot;</span>,  <span class="stringliteral">&quot;XRefine&quot;</span>,               <span class="stringliteral">&quot;Refine in x-direction by adding that many knots to every knot span&quot;</span>, xRefine);</div>
<div class="line">    cmd.addInt   (<span class="stringliteral">&quot;r&quot;</span>, <span class="stringliteral">&quot;Refinements&quot;</span>,           <span class="stringliteral">&quot;Number of uniform h-refinement steps to perform before solving&quot;</span>, refinements);</div>
<div class="line">    cmd.addInt   (<span class="stringliteral">&quot;p&quot;</span>, <span class="stringliteral">&quot;Degree&quot;</span>,                <span class="stringliteral">&quot;Degree of the B-spline discretization space&quot;</span>, degree);</div>
<div class="line">    cmd.addSwitch(<span class="stringliteral">&quot;&quot;</span>,  <span class="stringliteral">&quot;NonMatching&quot;</span>,           <span class="stringliteral">&quot;Set up a non-matching multi-patch discretization&quot;</span>, nonMatching);</div>
<div class="line">    cmd.addSwitch(<span class="stringliteral">&quot;&quot;</span>,  <span class="stringliteral">&quot;DG&quot;</span>,                    <span class="stringliteral">&quot;Use discontinuous Galerkin (SIPG) for coupling the patches&quot;</span>, dg);</div>
<div class="line">    cmd.addSwitch(<span class="stringliteral">&quot;&quot;</span>,  <span class="stringliteral">&quot;Nitsche&quot;</span>,               <span class="stringliteral">&quot;Use Nitsche method for Dirichlet boundary conditions&quot;</span>, nitsche);</div>
<div class="line">    cmd.addInt   (<span class="stringliteral">&quot;l&quot;</span>, <span class="stringliteral">&quot;MG.Levels&quot;</span>,             <span class="stringliteral">&quot;Number of levels to use for multigrid iteration&quot;</span>, levels);</div>
<div class="line">    cmd.addInt   (<span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;MG.NumCycles&quot;</span>,          <span class="stringliteral">&quot;Number of multi-grid cycles&quot;</span>, cycles);</div>
<div class="line">    cmd.addInt   (<span class="stringliteral">&quot;&quot;</span>,  <span class="stringliteral">&quot;MG.NumPreSmooth&quot;</span>,       <span class="stringliteral">&quot;Number of pre-smoothing steps&quot;</span>, presmooth);</div>
<div class="line">    cmd.addInt   (<span class="stringliteral">&quot;&quot;</span>,  <span class="stringliteral">&quot;MG.NumPostSmooth&quot;</span>,      <span class="stringliteral">&quot;Number of post-smoothing steps&quot;</span>, postsmooth);</div>
<div class="line">    cmd.addSwitch(<span class="stringliteral">&quot;&quot;</span>,  <span class="stringliteral">&quot;MG.Extrasmooth&quot;</span>,        <span class="stringliteral">&quot;Doubles the number of smoothing steps for each coarser level&quot;</span>, extrasmooth);</div>
<div class="line">    cmd.addString(<span class="stringliteral">&quot;s&quot;</span>, <span class="stringliteral">&quot;MG.Smoother&quot;</span>,           <span class="stringliteral">&quot;Smoothing method&quot;</span>, smoother);</div>
<div class="line">    cmd.addReal  (<span class="stringliteral">&quot;&quot;</span>,  <span class="stringliteral">&quot;MG.Damping&quot;</span>,            <span class="stringliteral">&quot;Damping factor for the smoother&quot;</span>, damping);</div>
<div class="line">    cmd.addReal  (<span class="stringliteral">&quot;&quot;</span>,  <span class="stringliteral">&quot;MG.Scaling&quot;</span>,            <span class="stringliteral">&quot;Scaling factor for the subspace corrected mass smoother&quot;</span>, scaling);</div>
<div class="line">    cmd.addString(<span class="stringliteral">&quot;i&quot;</span>, <span class="stringliteral">&quot;IterativeSolver&quot;</span>,       <span class="stringliteral">&quot;Iterative solver: apply multigrid directly (d) or as a preconditioner for &quot;</span></div>
<div class="line">                                                <span class="stringliteral">&quot;conjugate gradient (cg)&quot;</span>, iterativeSolver);</div>
<div class="line">    cmd.addReal  (<span class="stringliteral">&quot;t&quot;</span>, <span class="stringliteral">&quot;Solver.Tolerance&quot;</span>,      <span class="stringliteral">&quot;Stopping criterion for linear solver&quot;</span>, tolerance);</div>
<div class="line">    cmd.addInt   (<span class="stringliteral">&quot;&quot;</span>,  <span class="stringliteral">&quot;Solver.MaxIterations&quot;</span>,  <span class="stringliteral">&quot;Stopping criterion for linear solver&quot;</span>, maxIterations);</div>
<div class="line">    cmd.addString(<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;BoundaryConditions&quot;</span>,    <span class="stringliteral">&quot;Boundary conditions&quot;</span>, boundaryConditions);</div>
<div class="line">    cmd.addString(<span class="stringliteral">&quot;&quot;</span>,  <span class="stringliteral">&quot;out&quot;</span>,                   <span class="stringliteral">&quot;Write solution and used options to file&quot;</span>, out);</div>
<div class="line">    cmd.addSwitch(     <span class="stringliteral">&quot;plot&quot;</span>,                  <span class="stringliteral">&quot;Plot the result with Paraview&quot;</span>, plot);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">try</span> { cmd.getValues(argc,argv); } <span class="keywordflow">catch</span> (<span class="keywordtype">int</span> rv) { <span class="keywordflow">return</span> rv; }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Default case is levels:=refinements, so replace invalid default accordingly</span></div>
<div class="line">    <span class="keywordflow">if</span> (levels &lt;0) { levels = refinements; cmd.setInt( <span class="stringliteral">&quot;MG.Levels&quot;</span>, levels ); }</div>
<div class="line">    <span class="comment">// The smoothers know their defaults, so remove the invalid default</span></div>
<div class="line">    <span class="keywordflow">if</span> (damping&lt;0) { cmd.remove( <span class="stringliteral">&quot;MG.Damping&quot;</span> ); }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Define assembler options</span></div>
<div class="line">    cmd.remove( <span class="stringliteral">&quot;DG&quot;</span> );</div>
<div class="line">    cmd.addInt( <span class="stringliteral">&quot;MG.InterfaceStrategy&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a>)( dg      ? iFace::dg          : iFace::conforming      ) );</div>
<div class="line">    cmd.addInt( <span class="stringliteral">&quot;MG.DirichletStrategy&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a>)( nitsche ? dirichlet::nitsche : dirichlet::elimination ) );</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ( ! <a class="code hl_function" href="classgismo_1_1gsFileManager.html#a8da6832660ffb6bbf974846015f44a21">gsFileManager::fileExists</a>(geometry) )</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Geometry file could not be found.\n&quot;</span>;</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;I was searching in the current directory and in: &quot;</span> &lt;&lt; <a class="code hl_function" href="classgismo_1_1gsFileManager.html#a76962c9181651d5335c0712a38f0e6a6">gsFileManager::getSearchPaths</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Run multiGrid_example with options:\n&quot;</span> &lt;&lt; cmd &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">    /******************* Define geometry ********************/</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Define geometry... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_typedef" href="classgismo_1_1gsMultiPatch.html#ad7190c68d8ead80bd1b6fd7256779894">gsMultiPatch&lt;&gt;::uPtr</a> mpPtr = <a class="code hl_class" href="classgismo_1_1gsReadFile.html">gsReadFile&lt;&gt;</a>(geometry);</div>
<div class="line">    <span class="keywordflow">if</span> (!mpPtr)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;No geometry found in file &quot;</span> &lt;&lt; geometry &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch&lt;&gt;</a>&amp; mp = *mpPtr;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i=0; i&lt;splitPatches; ++i)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;split patches uniformly... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line">        mp = mp.uniformSplit();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// This allows to strech a single-patch geometry in x-direction.</span></div>
<div class="line">    <span class="keywordflow">if</span> (stretchGeometry!=1)</div>
<div class="line">    {</div>
<div class="line">       <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;and stretch it... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line">       <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0; i!=mp.nPatches(); ++i)</div>
<div class="line">           <span class="keyword">const_cast&lt;</span><a class="code hl_class" href="classgismo_1_1gsGeometry.html">gsGeometry&lt;&gt;</a>&amp;<span class="keyword">&gt;</span>(mp[i]).<a class="code hl_function" href="classgismo_1_1gsGeometry.html#a43e34549f7cc019b808fc40fd6a7a05f">scale</a>(stretchGeometry,0);</div>
<div class="line">       <span class="comment">// Const cast is allowed since the object itself is not const. Stretching the</span></div>
<div class="line">       <span class="comment">// overall domain keeps its topology.</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done.\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">    /************** Define boundary conditions **************/</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Define boundary conditions... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Right-hand-side</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a> f( <span class="stringliteral">&quot;2*sin(x)*cos(y)&quot;</span>, mp.geoDim() );</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Dirichlet function</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a> gD( <span class="stringliteral">&quot;sin(x)*cos(y)&quot;</span>, mp.geoDim() );</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Neumann</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsConstantFunction.html">gsConstantFunction&lt;&gt;</a> gN( 1.0, mp.geoDim() );</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsBoundaryConditions.html">gsBoundaryConditions&lt;&gt;</a> bc;</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> len = boundaryConditions.length();</div>
<div class="line">        <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i = 0;</div>
<div class="line">        <span class="keywordflow">for</span> (gsMultiPatch&lt;&gt;::const_biterator it = mp.bBegin(); it &lt; mp.bEnd(); ++it)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">char</span> b_local;</div>
<div class="line">            <span class="keywordflow">if</span> ( len == 1 )</div>
<div class="line">                b_local = boundaryConditions[0];</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( i &lt; len )</div>
<div class="line">                b_local = boundaryConditions[i];</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;\nNot enough boundary conditions given.\n&quot;</span>;</div>
<div class="line">                <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> ( b_local == <span class="charliteral">&#39;d&#39;</span> )</div>
<div class="line">                bc.<a class="code hl_function" href="classgismo_1_1gsBoundaryConditions.html#a1dd0c4f4cdae8082d37db999fc3932d2">addCondition</a>( *it, <a class="code hl_enumvalue" href="structgismo_1_1condition__type.html#a7aead736a07eaf25623ad7bfa1f0ee2da1b4f535d1f53363637f933002efc2b4b">condition_type::dirichlet</a>, &amp;gD );</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( b_local == <span class="charliteral">&#39;n&#39;</span> )</div>
<div class="line">                bc.<a class="code hl_function" href="classgismo_1_1gsBoundaryConditions.html#a1dd0c4f4cdae8082d37db999fc3932d2">addCondition</a>( *it, <a class="code hl_enumvalue" href="structgismo_1_1condition__type.html#a7aead736a07eaf25623ad7bfa1f0ee2da8e855db37d5c0fbd8eda96b2f51b8b20">condition_type::neumann</a>, &amp;gN );</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;\nInvalid boundary condition given; only &#39;d&#39; (Dirichlet) and &#39;n&#39; (Neumann) are supported.\n&quot;</span>;</div>
<div class="line">                <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            ++i;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> ( len &gt; i )</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;\nToo many boundary conditions have been specified. Ignoring the remaining ones.\n&quot;</span>;</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done. &quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot; boundary conditions set.\n&quot;</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">    /************ Setup bases and adjust degree *************/</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsMultiBasis.html">gsMultiBasis&lt;&gt;</a> mb(mp);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (xRefine)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (mp.nPatches() &gt; 1)</div>
<div class="line">        {</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;\nThe option --XRefine is only available for single-patch geometries..\n&quot;</span>;</div>
<div class="line">            <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">        }</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Option --XRefine: Refine the grid in x-direction by interting &quot;</span> &lt;&lt; xRefine</div>
<div class="line">               &lt;&lt; <span class="stringliteral">&quot; knots in every knot span... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line">        mb[0].component(0).uniformRefine(xRefine,1);</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done.\n&quot;</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Setup bases and adjust degree... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> i = 0; i &lt; mb.nBases(); ++ i )</div>
<div class="line">        mb[i].setDegreePreservingMultiplicity(degree);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> ( <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i = 0; i &lt; refinements; ++i )</div>
<div class="line">        mb.uniformRefine();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done.\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (nonMatching)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Option NonMatching: Make uniform refinement for every third patch... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; mb.nBases(); ++i)</div>
<div class="line">            <span class="keywordflow">if</span> ( i%3 == 0 )</div>
<div class="line">                mb[i].uniformRefine();</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done.\n&quot;</span>;</div>
<div class="line">        --refinements;</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Option NonMatching: Increase spline degree for every other third patch... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; mb.nBases(); ++i)</div>
<div class="line">            <span class="keywordflow">if</span> ( i%3 == 1 )</div>
<div class="line">                mb[i].setDegreePreservingMultiplicity(degree+1);</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done.\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (!dg)</div>
<div class="line">        {</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;\nThe option --NonMatching does not allow a conforming discretization. Thus, option --DG is required.\n&quot;</span>;</div>
<div class="line">            <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"><span class="comment">    /********* Setup assembler and assemble matrix **********/</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Setup assembler and assemble matrix... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsPoissonAssembler.html">gsPoissonAssembler&lt;&gt;</a> assembler(</div>
<div class="line">        mp,</div>
<div class="line">        mb,</div>
<div class="line">        bc,</div>
<div class="line">        f,</div>
<div class="line">        (dirichlet::strategy) cmd.getInt(<span class="stringliteral">&quot;MG.DirichletStrategy&quot;</span>),</div>
<div class="line">        (iFace::strategy)     cmd.getInt(<span class="stringliteral">&quot;MG.InterfaceStrategy&quot;</span>)</div>
<div class="line">    );</div>
<div class="line">    assembler.assemble();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done.\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">    /**************** Setup solver and solve ****************/</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Setup solver and solve... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line"> </div>
<div class="line">    std::vector&lt; gsSparseMatrix&lt;real_t,RowMajor&gt; &gt; transferMatrices;</div>
<div class="line">    std::vector&lt; gsMultiBasis&lt;real_t&gt; &gt; multiBases;  <span class="comment">// Needed for setupSubspaceCorrectedMassSmoother</span></div>
<div class="line">    std::vector&lt;real_t&gt; patchLocalDampingParameters; <span class="comment">// Needed for setupSubspaceCorrectedMassSmoother</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Setup grid hiearachy by coarsening of the given matrix</span></div>
<div class="line">    <span class="comment">// We move the constructed hiearchy of multi bases into a variable (only required for the subspace smoother)</span></div>
<div class="line">    <span class="comment">// Then we move the transfer matrices into a variable</span></div>
<div class="line">    <a class="code hl_function" href="classgismo_1_1gsGridHierarchy.html#ace87bc249f301ae48c9ac5683eae72c5">gsGridHierarchy&lt;&gt;::buildByCoarsening</a>(<a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(mb), bc, cmd.getGroup(<span class="stringliteral">&quot;MG&quot;</span>))</div>
<div class="line">        .<a class="code hl_function" href="classgismo_1_1gsGridHierarchy.html#a3cd75bdae99496321a275c20c8085d37">moveMultiBasesTo</a>(multiBases)</div>
<div class="line">        .<a class="code hl_function" href="classgismo_1_1gsGridHierarchy.html#ac7a26e8ea14b96b52d4e1154b1d6ead7">moveTransferMatricesTo</a>(transferMatrices);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Setup the multigrid solver</span></div>
<div class="line">    <a class="code hl_typedef" href="classgismo_1_1gsMultiGridOp.html#a1693f061596a1ece25c96f7900b573a3">gsMultiGridOp&lt;&gt;::Ptr</a> mg = <a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#aa379574148d989edf4572077d919d546">gsMultiGridOp&lt;&gt;::make</a>( assembler.matrix(), transferMatrices );</div>
<div class="line">    mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#a3683f06858b83266fa5ad2ac73752cbe">setOptions</a>( cmd.getGroup(<span class="stringliteral">&quot;MG&quot;</span>) );</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Since we are solving a symmetric positive definite problem,we can use a Cholesky solver</span></div>
<div class="line">    <span class="comment">// (instead of the LU solver that would be created by default).</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// mg-&gt;matrix(0) gives the matrix for the coarsest grid level (=level 0).</span></div>
<div class="line">    mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#a68354ca89c65a5c40310b185082ca557">setCoarseSolver</a>( makeSparseCholeskySolver( mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#a5f32ea32f05cc079ba02f961a280ae44">matrix</a>(0) ) );</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Set up of the smoothers</span></div>
<div class="line">    <span class="comment">// This has to be done for each grid level separately</span></div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i = 1; i &lt; mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#a20877367ee694da118b95a3d580653ab">numLevels</a>(); ++i)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_typedef" href="classgismo_1_1gsPreconditionerOp.html#a73ef689606fbfc5909797bc3e417a4ce">gsPreconditionerOp&lt;&gt;::Ptr</a> smootherOp;</div>
<div class="line">        <span class="keywordflow">if</span> ( smoother == <span class="stringliteral">&quot;Richardson&quot;</span> || smoother == <span class="stringliteral">&quot;r&quot;</span> )</div>
<div class="line">            smootherOp = makeRichardsonOp(mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#a5f32ea32f05cc079ba02f961a280ae44">matrix</a>(i));</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( smoother == <span class="stringliteral">&quot;Jacobi&quot;</span> || smoother == <span class="stringliteral">&quot;j&quot;</span> )</div>
<div class="line">            smootherOp = makeJacobiOp(mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#a5f32ea32f05cc079ba02f961a280ae44">matrix</a>(i));</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( smoother == <span class="stringliteral">&quot;GaussSeidel&quot;</span> || smoother == <span class="stringliteral">&quot;gs&quot;</span> )</div>
<div class="line">            smootherOp = makeGaussSeidelOp(mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#a5f32ea32f05cc079ba02f961a280ae44">matrix</a>(i));</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( smoother == <span class="stringliteral">&quot;IncompleteLU&quot;</span> || smoother == <span class="stringliteral">&quot;ilu&quot;</span> )</div>
<div class="line">            smootherOp = makeIncompleteLUOp(mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#a5f32ea32f05cc079ba02f961a280ae44">matrix</a>(i));</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( smoother == <span class="stringliteral">&quot;SubspaceCorrectedMassSmoother&quot;</span> || smoother == <span class="stringliteral">&quot;scms&quot;</span> )</div>
<div class="line">            smootherOp = setupSubspaceCorrectedMassSmoother( i, mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#a20877367ee694da118b95a3d580653ab">numLevels</a>(), mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#a5f32ea32f05cc079ba02f961a280ae44">matrix</a>(i),</div>
<div class="line">                multiBases[i], bc, cmd.getGroup(<span class="stringliteral">&quot;MG&quot;</span>), patchLocalDampingParameters );</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( smoother == <span class="stringliteral">&quot;Hybrid&quot;</span> || smoother == <span class="stringliteral">&quot;hyb&quot;</span> )</div>
<div class="line">            smootherOp = <a class="code hl_function" href="classgismo_1_1gsCompositePrecOp.html#a885737d651450065132a97a910b7c9d3">gsCompositePrecOp&lt;&gt;::make</a>(</div>
<div class="line">                makeGaussSeidelOp(mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#a5f32ea32f05cc079ba02f961a280ae44">matrix</a>(i)),</div>
<div class="line">                setupSubspaceCorrectedMassSmoother( i, mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#a20877367ee694da118b95a3d580653ab">numLevels</a>(), mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#a5f32ea32f05cc079ba02f961a280ae44">matrix</a>(i),</div>
<div class="line">                    multiBases[i], bc, cmd.getGroup(<span class="stringliteral">&quot;MG&quot;</span>), patchLocalDampingParameters )</div>
<div class="line">                );</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;\n\nThe chosen smoother is unknown.\n\nKnown are:\n  Richardson (r)\n  Jacobi (j)\n  GaussSeidel (gs)&quot;</span></div>
<div class="line">                      <span class="stringliteral">&quot;\n  IncompleteLU (ilu)\n  SubspaceCorrectedMassSmoother (scms)\n  Hybrid (hyb)\n\n&quot;</span>;</div>
<div class="line">            <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        smootherOp-&gt;<a class="code hl_function" href="classgismo_1_1gsPreconditionerOp.html#ac08d3df9c39d7a0e92c1a32438429157">setOptions</a>( cmd.getGroup(<span class="stringliteral">&quot;MG&quot;</span>) );</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Handle the extra-smooth option. On the finest grid level, there is nothing to handle.</span></div>
<div class="line">        <span class="keywordflow">if</span> (extrasmooth &amp;&amp; i &lt; mg-&gt;numLevels()-1)</div>
<div class="line">        {</div>
<div class="line">            smootherOp-&gt;<a class="code hl_function" href="classgismo_1_1gsPreconditionerOp.html#a27fb1b22169ec08f0ac8766443ecafba">setNumOfSweeps</a>( 1 &lt;&lt; (mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#a20877367ee694da118b95a3d580653ab">numLevels</a>()-1-i) );</div>
<div class="line">            smootherOp = <a class="code hl_function" href="classgismo_1_1gsPreconditionerFromOp.html#acb39d514900c1fc91c4e811867cb8dad">gsPreconditionerFromOp&lt;&gt;::make</a>(mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#ae5e4ee5cd7f1d28095d130c1ecb549e8">underlyingOp</a>(i),smootherOp);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#a575e42fb17150414509b0651bbaa7e8a">setSmoother</a>(i, smootherOp);</div>
<div class="line">    } <span class="comment">// end for</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a> errorHistory;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a> x;</div>
<div class="line">    x.setRandom( assembler.matrix().rows(), 1 );</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (iterativeSolver==<span class="stringliteral">&quot;cg&quot;</span>)</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsConjugateGradient.html">gsConjugateGradient&lt;&gt;</a>( assembler.matrix(), mg )</div>
<div class="line">            .<a class="code hl_function" href="classgismo_1_1gsConjugateGradient.html#a2f1378c42b1b46dbe9e58cb965b32f4e">setOptions</a>( cmd.getGroup(<span class="stringliteral">&quot;Solver&quot;</span>) )</div>
<div class="line">            .<a class="code hl_function" href="classgismo_1_1gsIterativeSolver.html#a6e04b51fc392c977e044b1c25f9d32c6">solveDetailed</a>( assembler.rhs(), x, errorHistory );</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iterativeSolver==<span class="stringliteral">&quot;d&quot;</span>)</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsGradientMethod.html">gsGradientMethod&lt;&gt;</a>( assembler.matrix(), mg )</div>
<div class="line">            .<a class="code hl_function" href="classgismo_1_1gsGradientMethod.html#a1d8dd3f4247a3fb238c0447f64e03110">setOptions</a>( cmd.getGroup(<span class="stringliteral">&quot;Solver&quot;</span>) )</div>
<div class="line">            .<a class="code hl_function" href="classgismo_1_1gsIterativeSolver.html#a6e04b51fc392c977e044b1c25f9d32c6">solveDetailed</a>( assembler.rhs(), x, errorHistory );</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;\n\nThe chosen iterative solver is unknown.\n\nKnown are:\n  conjugate gradient (cg)\n  direct (d)\n\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done.\n\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">    /******************** Print end Exit ********************/</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> iter = errorHistory.rows()-1;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">bool</span> success = errorHistory(iter,0) &lt; tolerance;</div>
<div class="line">    <span class="keywordflow">if</span> (success)</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Reached desired tolerance after &quot;</span> &lt;&lt; iter &lt;&lt; <span class="stringliteral">&quot; iterations:\n&quot;</span>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Did not reach desired tolerance after &quot;</span> &lt;&lt; iter &lt;&lt; <span class="stringliteral">&quot; iterations:\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (errorHistory.rows() &lt; 20)</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; errorHistory.transpose() &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; errorHistory.topRows(5).transpose() &lt;&lt; <span class="stringliteral">&quot; ... &quot;</span> &lt;&lt; errorHistory.bottomRows(5).transpose()  &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!out.empty())</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsFileData.html">gsFileData&lt;&gt;</a> fd;</div>
<div class="line">        std::time_t time = std::time(NULL);</div>
<div class="line">        fd.add(cmd);</div>
<div class="line">        fd.add(x);</div>
<div class="line">        fd.addComment(std::string(<span class="stringliteral">&quot;multiGrid_example   Timestamp:&quot;</span>)+std::ctime(&amp;time));</div>
<div class="line">        fd.save(out);</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Write solution to file &quot;</span> &lt;&lt; out &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (plot)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Construct the solution as a scalar field</span></div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch&lt;&gt;</a> mpsol;</div>
<div class="line">        assembler.constructSolution(x, mpsol);</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsField.html">gsField&lt;&gt;</a> sol( assembler.patches(), mpsol );</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Write solution to paraview files</span></div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Write Paraview data to file multiGrid_result.pvd\n&quot;</span>;</div>
<div class="line">        gsWriteParaview&lt;&gt;(sol, <span class="stringliteral">&quot;multiGrid_result&quot;</span>, 1000);</div>
<div class="line">        <a class="code hl_function" href="classgismo_1_1gsFileManager.html#a0f725eecb78d3bc1f482326cb9e85eee">gsFileManager::open</a>(<span class="stringliteral">&quot;multiGrid_result.pvd&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (!plot&amp;&amp;out.empty())</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Done. No output created, re-run with --plot to get a ParaView &quot;</span></div>
<div class="line">                  <span class="stringliteral">&quot;file containing the solution or --out to write solution to xml file.\n&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> success ? EXIT_SUCCESS : EXIT_FAILURE;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="classgismo_1_1gsPreconditionerOp.html#a73ef689606fbfc5909797bc3e417a4ce">gsPreconditionerOp&lt;&gt;::Ptr</a> setupSubspaceCorrectedMassSmoother(</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> level,</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> nrLevels,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;&gt;</a>&amp; matrix,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsMultiBasis.html">gsMultiBasis&lt;&gt;</a>&amp; mb,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsBoundaryConditions.html">gsBoundaryConditions&lt;&gt;</a>&amp; bc,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsOptionList.html">gsOptionList</a>&amp; opt,</div>
<div class="line">    std::vector&lt;real_t&gt;&amp; patchLocalDampingParameters</div>
<div class="line">)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// This function sets up a patchwise version of the subspace corrected mass smoother.</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#a368985810450e531ca9324d659d9e1e2">short_t</a> dim = mb.topology().dim();</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> iFace::strategy iFaceStrategy = (iFace::strategy)opt.<a class="code hl_function" href="classgismo_1_1gsOptionList.html#a92e4bc71116fe3878d4f1a31956cb8f1">askInt</a>(<span class="stringliteral">&quot;InterfaceStrategy&quot;</span>, 1);</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#afef28a292b09ce4b06f94e6ed3b8abb4">GISMO_ASSERT</a>( iFaceStrategy == iFace::dg || iFaceStrategy == iFace::conforming,</div>
<div class="line">      <span class="stringliteral">&quot;Unknown interface strategy.&quot;</span> );</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Setup dof mapper</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsDofMapper.html">gsDofMapper</a> dm;</div>
<div class="line">    mb.getMapper(</div>
<div class="line">       (dirichlet::strategy)opt.<a class="code hl_function" href="classgismo_1_1gsOptionList.html#a92e4bc71116fe3878d4f1a31956cb8f1">askInt</a>(<span class="stringliteral">&quot;DirichletStrategy&quot;</span>,11),</div>
<div class="line">       iFaceStrategy,</div>
<div class="line">       bc,</div>
<div class="line">       dm,</div>
<div class="line">       0</div>
<div class="line">    );</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> nTotalDofs = dm.<a class="code hl_function" href="classgismo_1_1gsDofMapper.html#aae5019a3c2c3bb7d79ff5d05b090101f">freeSize</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Decompose the whole domain into components</span></div>
<div class="line">    std::vector&lt; std::vector&lt;patchComponent&gt; &gt; components = mb.topology().allComponents(<span class="keyword">true</span>);</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> nr_components = components.size();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (patchLocalDampingParameters.size() == 0)</div>
<div class="line">        patchLocalDampingParameters.resize(nr_components);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Setup Dirichlet boundary conditions</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsBoundaryConditions.html">gsBoundaryConditions&lt;&gt;</a> dir_bc;</div>
<div class="line">    <span class="keywordflow">for</span>( <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> ps=0; ps &lt; 2*dim; ++ps )</div>
<div class="line">        dir_bc.<a class="code hl_function" href="classgismo_1_1gsBoundaryConditions.html#a1dd0c4f4cdae8082d37db999fc3932d2">addCondition</a>( 0, 1+ps, <a class="code hl_enumvalue" href="structgismo_1_1condition__type.html#a7aead736a07eaf25623ad7bfa1f0ee2da1b4f535d1f53363637f933002efc2b4b">condition_type::dirichlet</a>, NULL );</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Setup transfer matrices and local preconditioners</span></div>
<div class="line">    std::vector&lt; gsSparseMatrix&lt;real_t,RowMajor&gt; &gt; transfers;</div>
<div class="line">    transfers.reserve(nr_components);</div>
<div class="line"> </div>
<div class="line">    std::vector&lt; gsLinearOperator&lt;&gt;::Ptr &gt; ops;</div>
<div class="line">    ops.reserve(nr_components);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i=0; i&lt;nr_components; ++i)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> cdim = components[i][0].dim();</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;index_t&gt;</a> indices;</div>
<div class="line">        std::vector&lt;gsBasis&lt;&gt;::uPtr&gt; bases = mb.componentBasis_withIndices(components[i],dm,indices,<span class="keyword">true</span>);</div>
<div class="line">        <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> sz = indices.rows();</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsSparseEntries.html">gsSparseEntries&lt;&gt;</a> se;</div>
<div class="line">        se.reserve(sz);</div>
<div class="line">        <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> j=0; j&lt;sz; ++j)</div>
<div class="line">            se.add(indices(j,0),j,(real_t)1);</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;real_t,RowMajor&gt;</a> transfer(nTotalDofs,sz);</div>
<div class="line">        transfer.setFrom(se);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (sz&gt;0)  <span class="comment">// It might be the case that there is no active dof in some components.</span></div>
<div class="line">        {</div>
<div class="line">            <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;&gt;</a> localMatrix = transfer.transpose() * matrix * transfer;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (cdim &gt;= 2 &amp;&amp; cdim &gt;= dim-1)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// If the component has dimension of at least 2, we have to do something fancy.</span></div>
<div class="line">                <span class="comment">// For dim &gt; 3, we ignore interaces of dimensionality dim-2 and smaller (for simplicity).</span></div>
<div class="line">                <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> nrDifferentBases;</div>
<div class="line">                real_t stiffFactor, massFactor;</div>
<div class="line">                <span class="keywordflow">if</span> ( cdim == dim )</div>
<div class="line">                {</div>
<div class="line">                    nrDifferentBases = 1;</div>
<div class="line">                    stiffFactor = 1;</div>
<div class="line">                    massFactor = 0;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="comment">// cdim == dim-1</span></div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span> ( iFaceStrategy == iFace::dg &amp;&amp; components[i].size() == 2 )</div>
<div class="line">                    {</div>
<div class="line">                        <span class="comment">// components[i].size() == 2 means that we consider an interface, not a boundary</span></div>
<div class="line">                        <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> patch0 = components[i][0].patch(),</div>
<div class="line">                                      patch1 = components[i][1].patch();</div>
<div class="line">                        <span class="keyword">const</span> real_t h = math::min( mb[patch0].getMinCellLength(), mb[patch1].getMinCellLength() );</div>
<div class="line">                        <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> p = math::max( mb[patch0].maxDegree(), mb[patch1].maxDegree() );</div>
<div class="line">                        nrDifferentBases = 2;</div>
<div class="line">                        stiffFactor = h/p;</div>
<div class="line">                        massFactor = p/h;</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span></div>
<div class="line">                    {</div>
<div class="line">                        <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> patch = components[i][0].patch();</div>
<div class="line">                        <span class="keyword">const</span> real_t h  = mb[patch].getMinCellLength();</div>
<div class="line">                        <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> p = mb[patch].maxDegree();</div>
<div class="line">                        nrDifferentBases = 1;</div>
<div class="line">                        stiffFactor = h/p;</div>
<div class="line">                        massFactor = p/h;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <a class="code hl_typedef" href="classgismo_1_1gsLinearOperator.html#a163b1e148c033563e282a26371f7f59a">gsLinearOperator&lt;&gt;::uPtr</a> localOperators[2];</div>
<div class="line">                <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> j=0; j!=nrDifferentBases; ++j)</div>
<div class="line">                {</div>
<div class="line">                    localOperators[j] = <a class="code hl_function" href="classgismo_1_1gsPatchPreconditionersCreator.html#a92f824618424603cb01fdb2cfc4f8009">gsPatchPreconditionersCreator&lt;&gt;::subspaceCorrectedMassSmootherOp</a>(</div>
<div class="line">                        *(bases[j]),</div>
<div class="line">                        dir_bc,</div>
<div class="line">                        <a class="code hl_class" href="classgismo_1_1gsOptionList.html">gsOptionList</a>(),</div>
<div class="line">                        opt.<a class="code hl_function" href="classgismo_1_1gsOptionList.html#a7c40ddd4ee31ebbd48cc64fb0ba6a3c9">getReal</a>(<span class="stringliteral">&quot;Scaling&quot;</span>),</div>
<div class="line">                        massFactor,</div>
<div class="line">                        stiffFactor</div>
<div class="line">                    );</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> ( nrDifferentBases &gt; 1 )</div>
<div class="line">                {</div>
<div class="line">                    <span class="comment">// In the case of dG, we use a conjugate gradient solver with a block-diagonal</span></div>
<div class="line">                    <span class="comment">// preconditioner</span></div>
<div class="line">                    <a class="code hl_typedef" href="classgismo_1_1gsLinearOperator.html#a7e083f6c92575f77236d6cb193997e84">gsLinearOperator&lt;&gt;::Ptr</a> underlying = makeMatrixOp( localMatrix.<a class="code hl_function" href="classgismo_1_1gsSparseMatrix.html#a24da616b328c15186de32aa2c9a51938">moveToPtr</a>() );</div>
<div class="line"> </div>
<div class="line">                    <a class="code hl_typedef" href="classgismo_1_1gsBlockOp.html#a1faa5957098c4011318994fb8366fbac">gsBlockOp&lt;&gt;::uPtr</a> blockPreconder = <a class="code hl_function" href="classgismo_1_1gsBlockOp.html#a22235d2eb083c4eeef229e854010cf2a">gsBlockOp&lt;&gt;::make</a>(nrDifferentBases, nrDifferentBases);</div>
<div class="line">                    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> j=0; j!=nrDifferentBases; ++j)</div>
<div class="line">                        blockPreconder-&gt;<a class="code hl_function" href="classgismo_1_1gsBlockOp.html#aa60335cc14995e613ea9a8cc797f2fba">addOperator</a>(j,j,<a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(localOperators[j]));</div>
<div class="line"> </div>
<div class="line">                    ops.push_back( <a class="code hl_class" href="classgismo_1_1gsIterativeSolverOp.html">gsIterativeSolverOp</a>&lt; <a class="code hl_class" href="classgismo_1_1gsConjugateGradient.html">gsConjugateGradient&lt;&gt;</a> &gt;::make(underlying, <a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(blockPreconder)) );</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    <span class="comment">// Otherwiese, we just scale the local solvers properly</span></div>
<div class="line">                    <a class="code hl_typedef" href="classgismo_1_1gsLinearOperator.html#a7e083f6c92575f77236d6cb193997e84">gsLinearOperator&lt;&gt;::Ptr</a> underlying = makeMatrixOp( localMatrix.<a class="code hl_function" href="classgismo_1_1gsSparseMatrix.html#a24da616b328c15186de32aa2c9a51938">moveToPtr</a>() );</div>
<div class="line">                    <a class="code hl_typedef" href="classgismo_1_1gsPreconditionerFromOp.html#aa652d511af0f292dfe34fcad49afd896">gsPreconditionerFromOp&lt;&gt;::uPtr</a> pc = <a class="code hl_function" href="classgismo_1_1gsPreconditionerFromOp.html#acb39d514900c1fc91c4e811867cb8dad">gsPreconditionerFromOp&lt;&gt;::make</a>(underlying,<a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(localOperators[0]));</div>
<div class="line">                    <span class="keywordflow">if</span> (patchLocalDampingParameters[i] == 0)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keyword">const</span> real_t damping = 1/pc-&gt;<a class="code hl_function" href="classgismo_1_1gsPreconditionerOp.html#a9d3f12c6b2267899ff36c5e8419fbc07">estimateLargestEigenvalueOfPreconditionedSystem</a>(10);</div>
<div class="line">                        pc-&gt;<a class="code hl_function" href="classgismo_1_1gsPreconditionerFromOp.html#a7edb7738288ce2539d39d31fb111603f">setDamping</a>(damping);</div>
<div class="line"> </div>
<div class="line">                        <span class="comment">// We store the local damping parameter if we can expect that it does not change</span></div>
<div class="line">                        <span class="comment">// too much any more. When the number of inner knots is p or smaller, the subspace</span></div>
<div class="line">                        <span class="comment">// corrected mass smoother is an exact solver. Thus, these cases are not comparable.</span></div>
<div class="line">                        <span class="keywordtype">bool</span> saveLambda = (level &gt; nrLevels - 5);</div>
<div class="line">                        <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> j=0; j!=bases[0]-&gt;dim(); ++j)</div>
<div class="line">                            saveLambda &amp;= bases[0]-&gt;component(j).numElements()</div>
<div class="line">                                              &gt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>( bases[0]-&gt;component(j).maxDegree() );</div>
<div class="line">                        <span class="keywordflow">if</span> ( saveLambda )</div>
<div class="line">                            patchLocalDampingParameters[i] = damping;</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span></div>
<div class="line">                        pc-&gt;<a class="code hl_function" href="classgismo_1_1gsPreconditionerFromOp.html#a7edb7738288ce2539d39d31fb111603f">setDamping</a>(patchLocalDampingParameters[i]);</div>
<div class="line">                    ops.push_back(<a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(pc));</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// If the component has dimension 0 or 1, we can just use direct solves</span></div>
<div class="line">                ops.push_back( makeSparseCholeskySolver(localMatrix) );</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            transfers.push_back(<a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(transfer));</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_typedef" href="classgismo_1_1gsPreconditionerFromOp.html#a1c577739b62bc922252245d13a670388">gsPreconditionerFromOp&lt;&gt;::Ptr</a> result</div>
<div class="line">        = <a class="code hl_function" href="classgismo_1_1gsPreconditionerFromOp.html#acb39d514900c1fc91c4e811867cb8dad">gsPreconditionerFromOp&lt;&gt;::make</a>(</div>
<div class="line">            makeMatrixOp(matrix),</div>
<div class="line">            <a class="code hl_class" href="classgismo_1_1gsAdditiveOp.html">gsAdditiveOp&lt;&gt;::make</a>(transfers, ops)</div>
<div class="line">        );</div>
<div class="line">    result-&gt;<a class="code hl_function" href="classgismo_1_1gsPreconditionerFromOp.html#a1af0a9f84f3b44c17c51b5483c11a7e3">setOptions</a>(opt);</div>
<div class="line">    <span class="keywordflow">return</span> result;</div>
<div class="line">}</div>
<div class="ttc" id="aclassgismo_1_1gsAdditiveOp_html"><div class="ttname"><a href="classgismo_1_1gsAdditiveOp.html">gismo::gsAdditiveOp</a></div><div class="ttdoc">Generic preconditioner which applies an arbitrary linear operator to the residual.</div><div class="ttdef"><b>Definition</b> gsAdditiveOp.h:51</div></div>
<div class="ttc" id="aclassgismo_1_1gsBlockOp_html_a1faa5957098c4011318994fb8366fbac"><div class="ttname"><a href="classgismo_1_1gsBlockOp.html#a1faa5957098c4011318994fb8366fbac">gismo::gsBlockOp::uPtr</a></div><div class="ttdeci">memory::unique_ptr&lt; gsBlockOp&lt; T &gt; &gt; uPtr</div><div class="ttdoc">Unique pointer for gsBlockOp.</div><div class="ttdef"><b>Definition</b> gsBlockOp.h:51</div></div>
<div class="ttc" id="aclassgismo_1_1gsBlockOp_html_a22235d2eb083c4eeef229e854010cf2a"><div class="ttname"><a href="classgismo_1_1gsBlockOp.html#a22235d2eb083c4eeef229e854010cf2a">gismo::gsBlockOp::make</a></div><div class="ttdeci">static uPtr make(index_t nRows, index_t nCols)</div><div class="ttdoc">Make function returning a smart pointer.</div><div class="ttdef"><b>Definition</b> gsBlockOp.h:60</div></div>
<div class="ttc" id="aclassgismo_1_1gsBlockOp_html_aa60335cc14995e613ea9a8cc797f2fba"><div class="ttname"><a href="classgismo_1_1gsBlockOp.html#aa60335cc14995e613ea9a8cc797f2fba">gismo::gsBlockOp::addOperator</a></div><div class="ttdeci">void addOperator(index_t row, index_t col, const BasePtr &amp;op)</div><div class="ttdoc">Add a preconditioner  to the block structure.</div><div class="ttdef"><b>Definition</b> gsBlockOp.hpp:30</div></div>
<div class="ttc" id="aclassgismo_1_1gsBoundaryConditions_html"><div class="ttname"><a href="classgismo_1_1gsBoundaryConditions.html">gismo::gsBoundaryConditions</a></div><div class="ttdoc">Class containing a set of boundary conditions.</div><div class="ttdef"><b>Definition</b> gsBoundaryConditions.h:342</div></div>
<div class="ttc" id="aclassgismo_1_1gsBoundaryConditions_html_a1dd0c4f4cdae8082d37db999fc3932d2"><div class="ttname"><a href="classgismo_1_1gsBoundaryConditions.html#a1dd0c4f4cdae8082d37db999fc3932d2">gismo::gsBoundaryConditions::addCondition</a></div><div class="ttdeci">void addCondition(int p, boxSide s, condition_type::type t, gsFunctionSet&lt; T &gt; *f, short_t unknown=0, bool parametric=false, int comp=-1)</div><div class="ttdoc">Adds another boundary condition.</div><div class="ttdef"><b>Definition</b> gsBoundaryConditions.h:650</div></div>
<div class="ttc" id="aclassgismo_1_1gsCmdLine_html"><div class="ttname"><a href="classgismo_1_1gsCmdLine.html">gismo::gsCmdLine</a></div><div class="ttdoc">Class for command-line argument parsing.</div><div class="ttdef"><b>Definition</b> gsCmdLine.h:57</div></div>
<div class="ttc" id="aclassgismo_1_1gsConjugateGradient_html"><div class="ttname"><a href="classgismo_1_1gsConjugateGradient.html">gismo::gsConjugateGradient</a></div><div class="ttdoc">The conjugate gradient method.</div><div class="ttdef"><b>Definition</b> gsConjugateGradient.h:30</div></div>
<div class="ttc" id="aclassgismo_1_1gsConjugateGradient_html_a2f1378c42b1b46dbe9e58cb965b32f4e"><div class="ttname"><a href="classgismo_1_1gsConjugateGradient.html#a2f1378c42b1b46dbe9e58cb965b32f4e">gismo::gsConjugateGradient::setOptions</a></div><div class="ttdeci">gsConjugateGradient &amp; setOptions(const gsOptionList &amp;opt)</div><div class="ttdoc">Set the options based on a gsOptionList.</div><div class="ttdef"><b>Definition</b> gsConjugateGradient.h:68</div></div>
<div class="ttc" id="aclassgismo_1_1gsConstantFunction_html"><div class="ttname"><a href="classgismo_1_1gsConstantFunction.html">gismo::gsConstantFunction</a></div><div class="ttdoc">Class defining a globally constant function.</div><div class="ttdef"><b>Definition</b> gsConstantFunction.h:34</div></div>
<div class="ttc" id="aclassgismo_1_1gsDofMapper_html"><div class="ttname"><a href="classgismo_1_1gsDofMapper.html">gismo::gsDofMapper</a></div><div class="ttdoc">Maintains a mapping from patch-local dofs to global dof indices and allows the elimination of individ...</div><div class="ttdef"><b>Definition</b> gsDofMapper.h:69</div></div>
<div class="ttc" id="aclassgismo_1_1gsDofMapper_html_aae5019a3c2c3bb7d79ff5d05b090101f"><div class="ttname"><a href="classgismo_1_1gsDofMapper.html#aae5019a3c2c3bb7d79ff5d05b090101f">gismo::gsDofMapper::freeSize</a></div><div class="ttdeci">index_t freeSize() const</div><div class="ttdoc">Returns the number of free (not eliminated) dofs.</div><div class="ttdef"><b>Definition</b> gsDofMapper.h:436</div></div>
<div class="ttc" id="aclassgismo_1_1gsField_html"><div class="ttname"><a href="classgismo_1_1gsField.html">gismo::gsField</a></div><div class="ttdoc">A scalar of vector field defined on a m_parametric geometry.</div><div class="ttdef"><b>Definition</b> gsField.h:55</div></div>
<div class="ttc" id="aclassgismo_1_1gsFileData_html"><div class="ttname"><a href="classgismo_1_1gsFileData.html">gismo::gsFileData</a></div><div class="ttdoc">This class represents an XML data tree which can be read from or written to a (file) stream.</div><div class="ttdef"><b>Definition</b> gsFileData.h:34</div></div>
<div class="ttc" id="aclassgismo_1_1gsFileManager_html_a0f725eecb78d3bc1f482326cb9e85eee"><div class="ttname"><a href="classgismo_1_1gsFileManager.html#a0f725eecb78d3bc1f482326cb9e85eee">gismo::gsFileManager::open</a></div><div class="ttdeci">static void open(const std::string &amp;fn)</div><div class="ttdoc">Opens the file fn using the preferred application of the OS.</div><div class="ttdef"><b>Definition</b> gsFileManager.cpp:688</div></div>
<div class="ttc" id="aclassgismo_1_1gsFileManager_html_a76962c9181651d5335c0712a38f0e6a6"><div class="ttname"><a href="classgismo_1_1gsFileManager.html#a76962c9181651d5335c0712a38f0e6a6">gismo::gsFileManager::getSearchPaths</a></div><div class="ttdeci">static std::string getSearchPaths()</div><div class="ttdoc">Get the defined search paths.</div><div class="ttdef"><b>Definition</b> gsFileManager.cpp:271</div></div>
<div class="ttc" id="aclassgismo_1_1gsFileManager_html_a8da6832660ffb6bbf974846015f44a21"><div class="ttname"><a href="classgismo_1_1gsFileManager.html#a8da6832660ffb6bbf974846015f44a21">gismo::gsFileManager::fileExists</a></div><div class="ttdeci">static bool fileExists(const std::string &amp;name)</div><div class="ttdoc">Checks if the file exists.</div><div class="ttdef"><b>Definition</b> gsFileManager.cpp:62</div></div>
<div class="ttc" id="aclassgismo_1_1gsFunctionExpr_html"><div class="ttname"><a href="classgismo_1_1gsFunctionExpr.html">gismo::gsFunctionExpr</a></div><div class="ttdoc">Class defining a multivariate (real or vector) function given by a string mathematical expression.</div><div class="ttdef"><b>Definition</b> gsFunctionExpr.h:52</div></div>
<div class="ttc" id="aclassgismo_1_1gsGeometry_html"><div class="ttname"><a href="classgismo_1_1gsGeometry.html">gismo::gsGeometry</a></div><div class="ttdoc">Abstract base class representing a geometry map.</div><div class="ttdef"><b>Definition</b> gsGeometry.h:93</div></div>
<div class="ttc" id="aclassgismo_1_1gsGeometry_html_a43e34549f7cc019b808fc40fd6a7a05f"><div class="ttname"><a href="classgismo_1_1gsGeometry.html#a43e34549f7cc019b808fc40fd6a7a05f">gismo::gsGeometry::scale</a></div><div class="ttdeci">void scale(T s, int coord=-1)</div><div class="ttdoc">Apply Scaling by factor s.</div><div class="ttdef"><b>Definition</b> gsGeometry.h:413</div></div>
<div class="ttc" id="aclassgismo_1_1gsGradientMethod_html"><div class="ttname"><a href="classgismo_1_1gsGradientMethod.html">gismo::gsGradientMethod</a></div><div class="ttdoc">The gradient method.</div><div class="ttdef"><b>Definition</b> gsGradientMethod.h:30</div></div>
<div class="ttc" id="aclassgismo_1_1gsGradientMethod_html_a1d8dd3f4247a3fb238c0447f64e03110"><div class="ttname"><a href="classgismo_1_1gsGradientMethod.html#a1d8dd3f4247a3fb238c0447f64e03110">gismo::gsGradientMethod::setOptions</a></div><div class="ttdeci">gsGradientMethod &amp; setOptions(const gsOptionList &amp;opt)</div><div class="ttdoc">Set the options based on a gsOptionList.</div><div class="ttdef"><b>Definition</b> gsGradientMethod.h:110</div></div>
<div class="ttc" id="aclassgismo_1_1gsIterativeSolverOp_html"><div class="ttname"><a href="classgismo_1_1gsIterativeSolverOp.html">gismo::gsIterativeSolverOp</a></div><div class="ttdoc">This wrapper class allows gsIterativeSolver to be used as gsLinearOperator.</div><div class="ttdef"><b>Definition</b> gsIterativeSolver.h:270</div></div>
<div class="ttc" id="aclassgismo_1_1gsIterativeSolver_html_a6e04b51fc392c977e044b1c25f9d32c6"><div class="ttname"><a href="classgismo_1_1gsIterativeSolver.html#a6e04b51fc392c977e044b1c25f9d32c6">gismo::gsIterativeSolver::solveDetailed</a></div><div class="ttdeci">void solveDetailed(const VectorType &amp;rhs, VectorType &amp;x, VectorType &amp;error_history)</div><div class="ttdoc">Solves the linear system and stores the solution in x and records the error histroy.</div><div class="ttdef"><b>Definition</b> gsIterativeSolver.h:134</div></div>
<div class="ttc" id="aclassgismo_1_1gsLinearOperator_html_a163b1e148c033563e282a26371f7f59a"><div class="ttname"><a href="classgismo_1_1gsLinearOperator.html#a163b1e148c033563e282a26371f7f59a">gismo::gsLinearOperator::uPtr</a></div><div class="ttdeci">memory::unique_ptr&lt; gsLinearOperator &gt; uPtr</div><div class="ttdoc">Unique pointer for gsLinearOperator.</div><div class="ttdef"><b>Definition</b> gsLinearOperator.h:36</div></div>
<div class="ttc" id="aclassgismo_1_1gsLinearOperator_html_a7e083f6c92575f77236d6cb193997e84"><div class="ttname"><a href="classgismo_1_1gsLinearOperator.html#a7e083f6c92575f77236d6cb193997e84">gismo::gsLinearOperator::Ptr</a></div><div class="ttdeci">memory::shared_ptr&lt; gsLinearOperator &gt; Ptr</div><div class="ttdoc">Shared pointer for gsLinearOperator.</div><div class="ttdef"><b>Definition</b> gsLinearOperator.h:33</div></div>
<div class="ttc" id="aclassgismo_1_1gsMatrix_html"><div class="ttname"><a href="classgismo_1_1gsMatrix.html">gismo::gsMatrix</a></div><div class="ttdoc">A matrix with arbitrary coefficient type and fixed or dynamic size.</div><div class="ttdef"><b>Definition</b> gsMatrix.h:41</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiBasis_html"><div class="ttname"><a href="classgismo_1_1gsMultiBasis.html">gismo::gsMultiBasis</a></div><div class="ttdoc">Holds a set of patch-wise bases and their topology information.</div><div class="ttdef"><b>Definition</b> gsMultiBasis.h:37</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiGridOp_html_a20877367ee694da118b95a3d580653ab"><div class="ttname"><a href="classgismo_1_1gsMultiGridOp.html#a20877367ee694da118b95a3d580653ab">gismo::gsMultiGridOp::numLevels</a></div><div class="ttdeci">index_t numLevels() const</div><div class="ttdoc">Number of levels in the multigrid construction.</div><div class="ttdef"><b>Definition</b> gsMultiGrid.h:256</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiGridOp_html_a3683f06858b83266fa5ad2ac73752cbe"><div class="ttname"><a href="classgismo_1_1gsMultiGridOp.html#a3683f06858b83266fa5ad2ac73752cbe">gismo::gsMultiGridOp::setOptions</a></div><div class="ttdeci">void setOptions(const gsOptionList &amp;opt) override</div><div class="ttdoc">Set the options based on a gsOptionList.</div><div class="ttdef"><b>Definition</b> gsMultiGrid.hpp:313</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiGridOp_html_a575e42fb17150414509b0651bbaa7e8a"><div class="ttname"><a href="classgismo_1_1gsMultiGridOp.html#a575e42fb17150414509b0651bbaa7e8a">gismo::gsMultiGridOp::setSmoother</a></div><div class="ttdeci">void setSmoother(index_t lvl, const PrecondPtr &amp;sm)</div><div class="ttdef"><b>Definition</b> gsMultiGrid.hpp:284</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiGridOp_html_a5f32ea32f05cc079ba02f961a280ae44"><div class="ttname"><a href="classgismo_1_1gsMultiGridOp.html#a5f32ea32f05cc079ba02f961a280ae44">gismo::gsMultiGridOp::matrix</a></div><div class="ttdeci">const SpMatrix &amp; matrix(index_t lvl) const</div><div class="ttdoc">Stiffness matrix for given level.</div><div class="ttdef"><b>Definition</b> gsMultiGrid.hpp:291</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiGridOp_html_a68354ca89c65a5c40310b185082ca557"><div class="ttname"><a href="classgismo_1_1gsMultiGridOp.html#a68354ca89c65a5c40310b185082ca557">gismo::gsMultiGridOp::setCoarseSolver</a></div><div class="ttdeci">void setCoarseSolver(const OpPtr &amp;sol)</div><div class="ttdoc">Set the solver for the coarsest problem (level 0)</div><div class="ttdef"><b>Definition</b> gsMultiGrid.h:302</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiGridOp_html_ae5e4ee5cd7f1d28095d130c1ecb549e8"><div class="ttname"><a href="classgismo_1_1gsMultiGridOp.html#ae5e4ee5cd7f1d28095d130c1ecb549e8">gismo::gsMultiGridOp::underlyingOp</a></div><div class="ttdeci">OpPtr underlyingOp(index_t lvl) const</div><div class="ttdoc">Underlying operator (=stiffness matrix) for given level.</div><div class="ttdef"><b>Definition</b> gsMultiGrid.h:269</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiPatch_html"><div class="ttname"><a href="classgismo_1_1gsMultiPatch.html">gismo::gsMultiPatch</a></div><div class="ttdoc">Container class for a set of geometry patches and their topology, that is, the interface connections ...</div><div class="ttdef"><b>Definition</b> gsMultiPatch.h:100</div></div>
<div class="ttc" id="aclassgismo_1_1gsOptionList_html"><div class="ttname"><a href="classgismo_1_1gsOptionList.html">gismo::gsOptionList</a></div><div class="ttdoc">Class which holds a list of parameters/options, and provides easy access to them.</div><div class="ttdef"><b>Definition</b> gsOptionList.h:33</div></div>
<div class="ttc" id="aclassgismo_1_1gsOptionList_html_a7c40ddd4ee31ebbd48cc64fb0ba6a3c9"><div class="ttname"><a href="classgismo_1_1gsOptionList.html#a7c40ddd4ee31ebbd48cc64fb0ba6a3c9">gismo::gsOptionList::getReal</a></div><div class="ttdeci">Real getReal(const std::string &amp;label) const</div><div class="ttdoc">Reads value for option label from options.</div><div class="ttdef"><b>Definition</b> gsOptionList.cpp:44</div></div>
<div class="ttc" id="aclassgismo_1_1gsOptionList_html_a92e4bc71116fe3878d4f1a31956cb8f1"><div class="ttname"><a href="classgismo_1_1gsOptionList.html#a92e4bc71116fe3878d4f1a31956cb8f1">gismo::gsOptionList::askInt</a></div><div class="ttdeci">index_t askInt(const std::string &amp;label, const index_t &amp;value=0) const</div><div class="ttdoc">Reads value for option label from options.</div><div class="ttdef"><b>Definition</b> gsOptionList.cpp:117</div></div>
<div class="ttc" id="aclassgismo_1_1gsPatchPreconditionersCreator_html_a92f824618424603cb01fdb2cfc4f8009"><div class="ttname"><a href="classgismo_1_1gsPatchPreconditionersCreator.html#a92f824618424603cb01fdb2cfc4f8009">gismo::gsPatchPreconditionersCreator::subspaceCorrectedMassSmootherOp</a></div><div class="ttdeci">static OpUPtr subspaceCorrectedMassSmootherOp(const gsBasis&lt; T &gt; &amp;basis, const gsBoundaryConditions&lt; T &gt; &amp;bc=gsBoundaryConditions&lt; T &gt;(), const gsOptionList &amp;opt=gsAssembler&lt; T &gt;::defaultOptions(), T sigma=(T)(12)/(T)(100), T alpha=0, T beta=1)</div><div class="ttdef"><b>Definition</b> gsPatchPreconditionersCreator.hpp:576</div></div>
<div class="ttc" id="aclassgismo_1_1gsPoissonAssembler_html"><div class="ttname"><a href="classgismo_1_1gsPoissonAssembler.html">gismo::gsPoissonAssembler</a></div><div class="ttdoc">Implementation of an (multiple right-hand side) Poisson assembler.</div><div class="ttdef"><b>Definition</b> gsPoissonAssembler.h:37</div></div>
<div class="ttc" id="aclassgismo_1_1gsPreconditionerFromOp_html_a1af0a9f84f3b44c17c51b5483c11a7e3"><div class="ttname"><a href="classgismo_1_1gsPreconditionerFromOp.html#a1af0a9f84f3b44c17c51b5483c11a7e3">gismo::gsPreconditionerFromOp::setOptions</a></div><div class="ttdeci">void setOptions(const gsOptionList &amp;opt)</div><div class="ttdoc">Set options based on a gsOptionList object.</div><div class="ttdef"><b>Definition</b> gsPreconditioner.h:237</div></div>
<div class="ttc" id="aclassgismo_1_1gsPreconditionerFromOp_html_a1c577739b62bc922252245d13a670388"><div class="ttname"><a href="classgismo_1_1gsPreconditionerFromOp.html#a1c577739b62bc922252245d13a670388">gismo::gsPreconditionerFromOp::Ptr</a></div><div class="ttdeci">memory::shared_ptr&lt; gsPreconditionerFromOp &gt; Ptr</div><div class="ttdoc">Shared pointer for gsLinearOperator.</div><div class="ttdef"><b>Definition</b> gsPreconditioner.h:156</div></div>
<div class="ttc" id="aclassgismo_1_1gsPreconditionerFromOp_html_a7edb7738288ce2539d39d31fb111603f"><div class="ttname"><a href="classgismo_1_1gsPreconditionerFromOp.html#a7edb7738288ce2539d39d31fb111603f">gismo::gsPreconditionerFromOp::setDamping</a></div><div class="ttdeci">void setDamping(const T tau)</div><div class="ttdoc">Set damping parameter.</div><div class="ttdef"><b>Definition</b> gsPreconditioner.h:223</div></div>
<div class="ttc" id="aclassgismo_1_1gsPreconditionerFromOp_html_aa652d511af0f292dfe34fcad49afd896"><div class="ttname"><a href="classgismo_1_1gsPreconditionerFromOp.html#aa652d511af0f292dfe34fcad49afd896">gismo::gsPreconditionerFromOp::uPtr</a></div><div class="ttdeci">memory::unique_ptr&lt; gsPreconditionerFromOp &gt; uPtr</div><div class="ttdoc">Unique pointer for gsLinearOperator.</div><div class="ttdef"><b>Definition</b> gsPreconditioner.h:159</div></div>
<div class="ttc" id="aclassgismo_1_1gsPreconditionerFromOp_html_acb39d514900c1fc91c4e811867cb8dad"><div class="ttname"><a href="classgismo_1_1gsPreconditionerFromOp.html#acb39d514900c1fc91c4e811867cb8dad">gismo::gsPreconditionerFromOp::make</a></div><div class="ttdeci">static uPtr make(BasePtr underlying, BasePtr preconditioner, T tau=(T) 1)</div><div class="ttdoc">Make function returning a smart pointer.</div><div class="ttdef"><b>Definition</b> gsPreconditioner.h:188</div></div>
<div class="ttc" id="aclassgismo_1_1gsPreconditionerOp_html_a27fb1b22169ec08f0ac8766443ecafba"><div class="ttname"><a href="classgismo_1_1gsPreconditionerOp.html#a27fb1b22169ec08f0ac8766443ecafba">gismo::gsPreconditionerOp::setNumOfSweeps</a></div><div class="ttdeci">void setNumOfSweeps(index_t n)</div><div class="ttdoc">Set the number of sweeps to be applied in the member function apply.</div><div class="ttdef"><b>Definition</b> gsPreconditioner.h:90</div></div>
<div class="ttc" id="aclassgismo_1_1gsPreconditionerOp_html_a9d3f12c6b2267899ff36c5e8419fbc07"><div class="ttname"><a href="classgismo_1_1gsPreconditionerOp.html#a9d3f12c6b2267899ff36c5e8419fbc07">gismo::gsPreconditionerOp::estimateLargestEigenvalueOfPreconditionedSystem</a></div><div class="ttdeci">T estimateLargestEigenvalueOfPreconditionedSystem(index_t steps=10) const</div><div class="ttdoc">Estimates the largest eigenvalue of .</div><div class="ttdef"><b>Definition</b> gsPreconditioner.h:121</div></div>
<div class="ttc" id="aclassgismo_1_1gsPreconditionerOp_html_ac08d3df9c39d7a0e92c1a32438429157"><div class="ttname"><a href="classgismo_1_1gsPreconditionerOp.html#ac08d3df9c39d7a0e92c1a32438429157">gismo::gsPreconditionerOp::setOptions</a></div><div class="ttdeci">virtual void setOptions(const gsOptionList &amp;opt)</div><div class="ttdoc">Set options based on a gsOptionList object.</div><div class="ttdef"><b>Definition</b> gsPreconditioner.h:111</div></div>
<div class="ttc" id="aclassgismo_1_1gsReadFile_html"><div class="ttname"><a href="classgismo_1_1gsReadFile.html">gismo::gsReadFile</a></div><div class="ttdoc">Reads an object from a data file, if such the requested object exists in the file.</div><div class="ttdef"><b>Definition</b> gsReadFile.h:43</div></div>
<div class="ttc" id="aclassgismo_1_1gsSparseEntries_html"><div class="ttname"><a href="classgismo_1_1gsSparseEntries.html">gismo::gsSparseEntries</a></div><div class="ttdoc">Class that provides a container for triplets (i,j,value) to be filled in a sparse matrix.</div><div class="ttdef"><b>Definition</b> gsSparseMatrix.h:34</div></div>
<div class="ttc" id="aclassgismo_1_1gsSparseMatrix_html"><div class="ttname"><a href="classgismo_1_1gsSparseMatrix.html">gismo::gsSparseMatrix</a></div><div class="ttdoc">Sparse matrix class, based on gsEigen::SparseMatrix.</div><div class="ttdef"><b>Definition</b> gsSparseMatrix.h:139</div></div>
<div class="ttc" id="aclassgismo_1_1gsSparseMatrix_html_a24da616b328c15186de32aa2c9a51938"><div class="ttname"><a href="classgismo_1_1gsSparseMatrix.html#a24da616b328c15186de32aa2c9a51938">gismo::gsSparseMatrix::moveToPtr</a></div><div class="ttdeci">uPtr moveToPtr()</div><div class="ttdoc">This function returns a smart pointer to the matrix. After calling it, the matrix object becomes empt...</div><div class="ttdef"><b>Definition</b> gsSparseMatrix.h:247</div></div>
<div class="ttc" id="agismo_8h_html"><div class="ttname"><a href="gismo_8h.html">gismo.h</a></div><div class="ttdoc">Main header to be included by clients using the G+Smo library.</div></div>
<div class="ttc" id="agsConfig_8h_html_a368985810450e531ca9324d659d9e1e2"><div class="ttname"><a href="gsConfig_8h.html#a368985810450e531ca9324d659d9e1e2">short_t</a></div><div class="ttdeci">#define short_t</div><div class="ttdef"><b>Definition</b> gsConfig.h:35</div></div>
<div class="ttc" id="agsDebug_8h_html_afef28a292b09ce4b06f94e6ed3b8abb4"><div class="ttname"><a href="gsDebug_8h.html#afef28a292b09ce4b06f94e6ed3b8abb4">GISMO_ASSERT</a></div><div class="ttdeci">#define GISMO_ASSERT(cond, message)</div><div class="ttdef"><b>Definition</b> gsDebug.h:89</div></div>
<div class="ttc" id="anamespacegismo_html"><div class="ttname"><a href="namespacegismo.html">gismo</a></div><div class="ttdoc">The G+Smo namespace, containing all definitions for the library.</div></div>
<div class="ttc" id="astructgismo_1_1condition__type_html_a7aead736a07eaf25623ad7bfa1f0ee2da1b4f535d1f53363637f933002efc2b4b"><div class="ttname"><a href="structgismo_1_1condition__type.html#a7aead736a07eaf25623ad7bfa1f0ee2da1b4f535d1f53363637f933002efc2b4b">gismo::condition_type::dirichlet</a></div><div class="ttdeci">@ dirichlet</div><div class="ttdoc">Dirichlet type.</div><div class="ttdef"><b>Definition</b> gsBoundaryConditions.h:31</div></div>
<div class="ttc" id="astructgismo_1_1condition__type_html_a7aead736a07eaf25623ad7bfa1f0ee2da8e855db37d5c0fbd8eda96b2f51b8b20"><div class="ttname"><a href="structgismo_1_1condition__type.html#a7aead736a07eaf25623ad7bfa1f0ee2da8e855db37d5c0fbd8eda96b2f51b8b20">gismo::condition_type::neumann</a></div><div class="ttdeci">@ neumann</div><div class="ttdoc">Neumann type.</div><div class="ttdef"><b>Definition</b> gsBoundaryConditions.h:33</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Jan 20 2025 09:35:27 for G+Smo by Doxygen v1.9.8 </li>
  </ul>
</div>
<!-- Piwik --> 
<!--
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? "https://stats.sylphide-consulting.com/piwik/" : "http://stats.sylphide-consulting.com/piwik/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 20);
piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
</script><noscript><p><img src="http://stats.sylphide-consulting.com/piwik/piwik.php?idsite=20" style="border:0" alt="" /></p></noscript>
-->
<!-- End Piwik Tracking Code -->
</body>
</html>

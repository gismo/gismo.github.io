<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<title>G+Smo: stokes_ieti_example.cpp</title>
<link href="gismodoxy_tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://people.ricam.oeaw.ac.at/gismo/mj/MathJax.js"></script>
<link href="doxygen.css"   rel="stylesheet" type="text/css" />
<link href="gismodoxy.css" rel="stylesheet" type="text/css">
<!--  -->
<!-- <script type="text/javascript"> -->
<!-- </script> -->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- <a name="top"></a> -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="gslogo-doxy.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname"><a href="index.html"><font style="font-variant:small-caps;">G+S</font><font style="font-variant:small-caps;"
															    color="#000000">mo</font></a>
   &#160;<span id="projectnumber">25.01.0</span>
   </div>
   <div id="projectbrief">Geometry + Simulation Modules</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('stokes_ieti_example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">stokes_ieti_example.cpp</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>We consider a Stokes boundary value problem with both Dirichlet (inflow / no-slip) and Neumann boundary conditions. The computational domain is \(\Omega\subset \mathbb R^d\). The variational problem characterizing velocity \(u\) and pressure \(p\) is as follows: Find \( (u,p) \in V \times Q = [H^1_{0,D}(\Omega)]^d \times L^2(\Omega)\) such that  </p><p class="formulaDsp">
\[\begin{eqnarray}
    \int_\Omega \nabla u : \nabla v d x &amp; + &amp; \int_\Omega p \nabla \cdot v d x &amp; = &amp; \int_{\Gamma_N} g \cdot v dx \\
    &amp; &amp; \int_\Omega q \nabla \cdot u d x &amp; = &amp; 0
\end{eqnarray}\]
</p>
<p> for all \( (v,q) \in V \times Q \). The domain \( \Omega \) is composed of non-overlapping patches \( \Omega_k \).</p>
<p>The theoretical framework follows the paper J. Sogn and S. Takacs. Stable discretizations and IETI-DP solvers for the Stokes system in multi-patch Isogeometric Analysis. ESAIM: Mathematical Modelling and Numerical Analysis, vol. 57 (2), p. 921 â€“ 925, 2023.</p>
<p>We discretize using the Galerkin principle, i.e., by choosing \( V_h \times Q_h \subset V \times Q \). Since the Stokes equations are a saddle point problem, we have to choose a pair of spaces that is inf-sup stable.</p>
<p>For the individual patches \( \Omega_k \), we choose the Taylor-Hood spaces, i.e., \( V_h \) is composed of splines of degree \( p+1 \) and smoothnes \( C^{p-1} \), and \( Q_h \) is composed of splines of degree \( p \) and smoothnes \( C^{p-1} \). Both spaces use the same grid (breakpoints).</p>
<p>The global space is constructed as follows. Since the velocity space is in \( H^1 \), we need continuity for the velocity. On each patch, we have a isogeometric function space \( V_k \). We assume that the function spaces are <em>fully matching</em>. The global function space is  </p><p class="formulaDsp">
\[
        V_h = \{ v\in [H^1_{0,D}(\Omega)]^d \;:\;  v|_{\Omega_k} \in V_k \}.
\]
</p>
<p> For the pressure, we only need \( L^2 \), so we choose a discontinuous space  </p><p class="formulaDsp">
\[
        Q_h = \{ q\in L^2(\Omega) \;:\;  v|_{\Omega_k} \in Q_k \}.
\]
</p>
<p>The solution with the IETI-Solver is analogous to the file <code>ieti_example.cpp</code>. Here, we only discuss the changes that have to be made to solve the Stokes equations, as opposed to the Poisson equation (as in <code>itei_example.cpp</code>).</p>
<p>We first start by setting up one <em><a class="el" href="classgismo_1_1gsMultiBasis.html" title="Holds a set of patch-wise bases and their topology information.">gsMultiBasis</a></em> object for each velocity component and one for the pressure; these are collected in a vector.</p>
<div class="fragment"><div class="line">    std::vector&lt;gsMultiBasis&lt;&gt;&gt; mb;</div>
<div class="line">    <span class="keywordflow">for</span> (std::size_t r=0; r&lt;dim+1; ++r)</div>
<div class="line">        mb.emplace_back(mp,<span class="keyword">true</span>);</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> nPatches = mp.nPatches();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Setup bases and adjust degree (Taylor-Hood)... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (std::size_t r=0; r&lt;dim; ++r)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> k=0; k&lt;nPatches; ++k)</div>
<div class="line">            mb[r][k].setDegreePreservingMultiplicity(degree+1);</div>
<div class="line">        <span class="keywordflow">for</span> ( <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i=0; i&lt;refinements; ++i )</div>
<div class="line">            mb[r].uniformRefine();</div>
<div class="line">        <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> k=0; k&lt;nPatches; ++k)</div>
<div class="line">            mb[r][k].reduceContinuity(1);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> k=0; k&lt;nPatches; ++k)</div>
<div class="line">        mb[dim][k].setDegreePreservingMultiplicity(degree);</div>
<div class="line">    <span class="keywordflow">for</span> ( <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i=0; i&lt;refinements; ++i )</div>
<div class="line">        mb[dim].uniformRefine();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done.\n&quot;</span>;</div>
<div class="ttc" id="agsConfig_8h_html_ad722078677c063a09661059674fb996c"><div class="ttname"><a href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a></div><div class="ttdeci">#define index_t</div><div class="ttdef"><b>Definition</b> gsConfig.h:32</div></div>
<div class="ttc" id="agsDebug_8h_html_af6177e1e282640c3cb9175565f84a432"><div class="ttname"><a href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a></div><div class="ttdeci">#define gsInfo</div><div class="ttdef"><b>Definition</b> gsDebug.h:43</div></div>
</div><!-- fragment --><p>Analogously, we set up one <em><a class="el" href="classgismo_1_1gsIetiMapper.html" title="Ieti Mapper.">gsIetiMapper</a></em> object for each velocity component and one for the pressure. For the setup of the corresponding <em><a class="el" href="classgismo_1_1gsDofMapper.html" title="Maintains a mapping from patch-local dofs to global dof indices and allows the elimination of individ...">gsDofMapper</a></em> objects, we use instances of an appropriate assembler. Here, we choose that the pressure is discontinuous:</p>
<div class="fragment"><div class="line">    std::vector&lt;gsIetiMapper&lt;&gt;&gt; ietiMapper;</div>
<div class="line">    ietiMapper.resize(dim+1);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// We start by setting up a global assembler for each component to</span></div>
<div class="line">    <span class="comment">// obtain a dof mapper and the Dirichlet data</span></div>
<div class="line">    <span class="keywordflow">for</span> (std::size_t r=0; r&lt;dim+1; ++r)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Velocity is C^0 continuous, but pressure discontinuous.</span></div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> continuity = r&lt;dim ? 0 : -1;</div>
<div class="line">        gsExprAssembler&lt;&gt; assembler;</div>
<div class="line">        <a class="code hl_typedef" href="classgismo_1_1gsExprAssembler.html#ae06340b104d0849a61073ea57edbf46c">gsExprAssembler&lt;&gt;::space</a> u = assembler.getSpace(mb[r]);</div>
<div class="line">        u.setup(bc[r], dirichlet::interpolation, continuity);</div>
<div class="line">        ietiMapper[r].init(mb[r], u.mapper(), u.fixedPart());</div>
<div class="line">    }</div>
<div class="ttc" id="aclassgismo_1_1gsExprAssembler_html_ae06340b104d0849a61073ea57edbf46c"><div class="ttname"><a href="classgismo_1_1gsExprAssembler.html#ae06340b104d0849a61073ea57edbf46c">gismo::gsExprAssembler::space</a></div><div class="ttdeci">gsExprHelper&lt; T &gt;::space space</div><div class="ttdoc">Space type.</div><div class="ttdef"><b>Definition</b> gsExprAssembler.h:67</div></div>
</div><!-- fragment --><p>As primal degrees of freedom, we choose the corner values and edge averages of the velocity components. Additionally, we use the averages of the pressure (on each of the patches as primals), see paper for a corresponding motivation.</p>
<div class="fragment"><div class="line">    <span class="keywordflow">for</span> (std::size_t r=0; r&lt;dim; ++r)</div>
<div class="line">    {</div>
<div class="line">        ietiMapper[r].cornersAsPrimals();</div>
<div class="line">        ietiMapper[r].interfaceAveragesAsPrimals(mp,dim-1);</div>
<div class="line">    }</div>
<div class="line">    ietiMapper[dim].interfaceAveragesAsPrimals(mp,dim);</div>
</div><!-- fragment --><p>As opposed to the <em><a class="el" href="classgismo_1_1gsIetiMapper.html" title="Ieti Mapper.">gsIetiMapper</a></em> objects, we only have one <em><a class="el" href="classgismo_1_1gsIetiSystem.html" title="This class represents a IETI system.">gsIetiSystem</a></em>, only one <em><a class="el" href="classgismo_1_1gsScaledDirichletPrec.html" title="This class represents the scaled Dirichlet preconditioner for a IETI problem.">gsScaledDirichletPrec</a></em> and only one <em><a class="el" href="classgismo_1_1gsPrimalSystem.html" title="This class represents the primal system for a IETI-DP algorithm.">gsPrimalSystem</a></em>.</p>
<div class="fragment"><div class="line">    <span class="comment">// The ieti system does not have a special treatment for the</span></div>
<div class="line">    <span class="comment">// primal dofs. They are just one more subdomain</span></div>
<div class="line">    gsIetiSystem&lt;&gt; ieti;</div>
<div class="line">    ieti.reserve(nPatches+1);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// The scaled Dirichlet preconditioner is independent of the</span></div>
<div class="line">    <span class="comment">// primal dofs.</span></div>
<div class="line">    gsScaledDirichletPrec&lt;&gt; prec;</div>
<div class="line">    prec.reserve(nPatches);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Setup the primal system, which needs to know the number of primal dofs.</span></div>
</div><!-- fragment --> <div class="fragment"><div class="line">    gsPrimalSystem&lt;&gt; primal(nPrimals);</div>
</div><!-- fragment --><p>For each patch, the local Stokes system is assembled with the <em>gsExpressionAssembler:</em> </p>
<div class="fragment"><div class="line">        <span class="keywordflow">for</span> (std::size_t r=0; r&lt;dim; ++r)</div>
<div class="line">        {</div>
<div class="line">            assembler.assemble( igrad(v[r], G)   * igrad(v[r], G).tr()   * meas(G) ,</div>
<div class="line">                                igrad(v[r],G)[r] * p.tr()                * meas(G) ,</div>
<div class="line">                                p                * igrad(v[r],G)[r].tr() * meas(G) );</div>
<div class="line">        }</div>
</div><!-- fragment --><p>This assembler yields a matrix, representing (for \(d=2\)) the linear system  </p><p class="formulaDsp">
\[
        A_k :=
        \begin{pmatrix}
            K_k   &amp;         &amp;  D_{x,k}^\top \\
                  &amp;   K_k   &amp;  D_{y,k}^\top \\
          D_{x,k} &amp; D_{y,k} &amp;
        \end{pmatrix},
\]
</p>
<p> where \( K_k \) is a standard grad-grad-stiffness matrix (as for the Poisson problem) and \( D_{x,k} \) and \( D_{y,k} \) represent \( \int \partial_x u p dx \) and \( \int \partial_y u p dx \) respectively. If we would not have primal dofs, this matrix could be directly handed over to the <em><a class="el" href="classgismo_1_1gsIetiSystem.html" title="This class represents a IETI system.">gsIetiSystem</a></em>.</p>
<p>The matrices that are provided by the <em><a class="el" href="classgismo_1_1gsIetiMapper.html" title="Ieti Mapper.">gsIetiMapper</a></em> objects refer to scaler problems. Therefore, they have to be combined accordingly: the jump matrices for the Stokes system are block-diagonal combinations of the jump matrices for the individual variables. Analogously, the vectors and indices for the primal degrees of freedom have to be handled. This is done by the called functions. </p><div class="fragment"><div class="line">        gsSparseMatrix&lt;real_t,RowMajor&gt;  jumpMatrix    = combinedJumpMatrix(ietiMapper, k);</div>
</div><!-- fragment --> <div class="fragment"><div class="line">        std::vector&lt;index_t&gt; primalDofIndices                 = combinedPrimalDofIndices(ietiMapper,k);</div>
<div class="line">        std::vector&lt;gsSparseVector&lt;real_t&gt;&gt; primalConstraints = combinedPrimalConstraints(ietiMapper,k);</div>
</div><!-- fragment --><p>In the example <code>ieti_example.cpp</code>, we have chosen the corresponding Dirichlet problem for the scaled Dirichlet preconditioner. While this is also possible for the Stokes equations (altough in this case, one has to deal with the fact that the pressure has to be restricted to \( L^2_0(\Omega_k) \)), an alternative has been proven it self to be more efficient. Here, we make use of the fact that the scaled Dirichlet preconditioner should represent \( H^{1/2} \) on the skeleton, both for the Poision and the Stokes equations. This can be achived by just considering a (vector-valued) Poisson problem (which is much cheaper to solve than the Stokes equations, see the paper more details. We do not need to assemble matrix for the Poission problem, we just take the upper-left part of \( A_k \) that consists of \( diag( K_k, K_k ) \).</p>
<div class="fragment"><div class="line">            <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> sz = 0;</div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t r=0; r&lt;dim; ++r)</div>
<div class="line">                sz += ietiMapper[r].jumpMatrix(k).cols();</div>
<div class="line">            gsSparseMatrix&lt;&gt; velocityJumpMatrix = jumpMatrix.block(0,0,jumpMatrix.rows(),sz);</div>
<div class="line">            gsSparseMatrix&lt;&gt; poissonMatrix = localMatrix.block(0,0,sz,sz);</div>
<div class="line"> </div>
<div class="line">            std::vector&lt;index_t&gt; skeletonDofs      = combinedSkeletonDofs(ietiMapper,k);</div>
<div class="line">            gsScaledDirichletPrec&lt;&gt;::Blocks blocks = <a class="code hl_function" href="classgismo_1_1gsScaledDirichletPrec.html#adfac85e147606b452a85b2881ebb3a6b">gsScaledDirichletPrec&lt;&gt;::matrixBlocks</a>( poissonMatrix, skeletonDofs );</div>
<div class="line"> </div>
<div class="line">            prec.addSubdomain(</div>
<div class="line">                <a class="code hl_function" href="classgismo_1_1gsScaledDirichletPrec.html#a9219afc9dd280538e2ec3fcb4dea4e40">gsScaledDirichletPrec&lt;&gt;::restrictJumpMatrix</a>( velocityJumpMatrix, skeletonDofs ).moveToPtr(),</div>
<div class="line">                <a class="code hl_function" href="classgismo_1_1gsScaledDirichletPrec.html#abe6231074e7f1ca4c2c60caa9003eafb">gsScaledDirichletPrec&lt;&gt;::schurComplement</a>( blocks, makeSparseCholeskySolver(blocks.A11) )</div>
<div class="line">            );</div>
<div class="ttc" id="aclassgismo_1_1gsScaledDirichletPrec_html_a9219afc9dd280538e2ec3fcb4dea4e40"><div class="ttname"><a href="classgismo_1_1gsScaledDirichletPrec.html#a9219afc9dd280538e2ec3fcb4dea4e40">gismo::gsScaledDirichletPrec::restrictJumpMatrix</a></div><div class="ttdeci">static JumpMatrix restrictJumpMatrix(const JumpMatrix &amp;jumpMatrix, const std::vector&lt; index_t &gt; &amp;dofs)</div><div class="ttdoc">Restricts the jump matrix to the given dofs.</div><div class="ttdef"><b>Definition</b> gsScaledDirichletPrec.hpp:36</div></div>
<div class="ttc" id="aclassgismo_1_1gsScaledDirichletPrec_html_abe6231074e7f1ca4c2c60caa9003eafb"><div class="ttname"><a href="classgismo_1_1gsScaledDirichletPrec.html#abe6231074e7f1ca4c2c60caa9003eafb">gismo::gsScaledDirichletPrec::schurComplement</a></div><div class="ttdeci">static OpPtr schurComplement(Blocks matrixBlocks, OpPtr solver)</div><div class="ttdoc">Computes the Schur complement with respect to the block A11 of matrixBlocks.</div><div class="ttdef"><b>Definition</b> gsScaledDirichletPrec.hpp:135</div></div>
<div class="ttc" id="aclassgismo_1_1gsScaledDirichletPrec_html_adfac85e147606b452a85b2881ebb3a6b"><div class="ttname"><a href="classgismo_1_1gsScaledDirichletPrec.html#adfac85e147606b452a85b2881ebb3a6b">gismo::gsScaledDirichletPrec::matrixBlocks</a></div><div class="ttdeci">static Blocks matrixBlocks(const SparseMatrix &amp;localMatrix, const std::vector&lt; index_t &gt; &amp;dofs)</div><div class="ttdoc">Computes the matrix blocks with respect to the given dofs.</div><div class="ttdef"><b>Definition</b> gsScaledDirichletPrec.hpp:64</div></div>
</div><!-- fragment --><p>Now, the data can be provided to the <em><a class="el" href="classgismo_1_1gsIetiSystem.html" title="This class represents a IETI system.">gsIetiSystem</a></em> and the <em><a class="el" href="classgismo_1_1gsPrimalSystem.html" title="This class represents the primal system for a IETI-DP algorithm.">gsPrimalSystem</a></em> as for the Poisson problem.</p>
<div class="fragment"><div class="line">        <span class="comment">// This function writes back to jumpMatrix, localMatrix, and localRhs,</span></div>
<div class="line">        <span class="comment">// so it must be called after prec.addSubdomain().</span></div>
<div class="line">        primal.handleConstraints(primalConstraints, primalDofIndices, jumpMatrix, localMatrix, localRhs);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Register local problem to ieti system</span></div>
<div class="line">        ieti.addSubdomain(jumpMatrix.moveToPtr(),</div>
<div class="line">                          makeMatrixOp(localMatrix),</div>
<div class="line">                          <a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(localRhs),</div>
<div class="line">                          makeSparseLUSolver(localMatrix)</div>
<div class="line">                         );</div>
<div class="ttc" id="anamespacegismo_html_ab72442c3b5aeef49b3c60f6e9df77110"><div class="ttname"><a href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">gismo::give</a></div><div class="ttdeci">S give(S &amp;x)</div><div class="ttdef"><b>Definition</b> gsMemory.h:266</div></div>
</div><!-- fragment --><p>Also the setup of the primal system is done as for the Poisson problem. More work would be necessary here if the problem only had Dirichlet conditions: In that case, we would have \( Q = L^2_0(\Omega) \), so we would need to specify that the average pressure vanishes, i.e., \( \int_\Omega p dx = 0 \). This can be formulated as a constraint in the primal system.</p>
<div class="fragment"><div class="line">        <a class="code hl_typedef" href="classgismo_1_1gsLinearOperator.html#a7e083f6c92575f77236d6cb193997e84">gsLinearOperator&lt;&gt;::Ptr</a> localSolver = makeSparseLUSolver(primal.localMatrix());</div>
<div class="line"> </div>
<div class="line">        ieti.addSubdomain(</div>
<div class="line">            primal.jumpMatrix().moveToPtr(),</div>
<div class="line">            makeMatrixOp(primal.localMatrix().moveToPtr()),</div>
<div class="line">            <a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(primal.localRhs()),</div>
<div class="line">            localSolver</div>
<div class="line">        );</div>
<div class="ttc" id="aclassgismo_1_1gsLinearOperator_html_a7e083f6c92575f77236d6cb193997e84"><div class="ttname"><a href="classgismo_1_1gsLinearOperator.html#a7e083f6c92575f77236d6cb193997e84">gismo::gsLinearOperator::Ptr</a></div><div class="ttdeci">memory::shared_ptr&lt; gsLinearOperator &gt; Ptr</div><div class="ttdoc">Shared pointer for gsLinearOperator.</div><div class="ttdef"><b>Definition</b> gsLinearOperator.h:33</div></div>
</div><!-- fragment --><p>Since the Schur complement formulation is symmetric and positive definite, we can apply a preconditioned conjugate gradient solver.</p>
<div class="fragment"><div class="line">    gsConjugateGradient&lt;&gt; PCG( ieti.schurComplement(), prec.preconditioner() );</div>
<div class="line">    PCG.setCalcEigenvalues(<span class="keyword">true</span>);</div>
<div class="line">    PCG.setOptions(cmd.getGroup(<span class="stringliteral">&quot;Solver&quot;</span>));</div>
<div class="line">    PCG.solveDetailed( ieti.rhsForSchurComplement(), lambda, errorHistory);</div>
</div><!-- fragment --><h1><a class="anchor" id="stokes_ieti_exampleAnnotated"></a>
Annotated source file</h1>
<p>Here is the full file <code>examples/stokes_ieti_example.cpp</code>. Clicking on a function or class name will lead you to its reference documentation.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="gismo_8h.html">gismo.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacegismo.html">gismo</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> Container&gt;</div>
<div class="line"><a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;real_t, RowMajor&gt;</a> combinedJumpMatrix(<span class="keyword">const</span> Container&amp; ietiMapper, <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> k);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> Container&gt;</div>
<div class="line">std::vector&lt;index_t&gt; combinedPrimalDofIndices(<span class="keyword">const</span> Container&amp; ietiMapper, <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> k);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> Container&gt;</div>
<div class="line">std::vector&lt;gsSparseVector&lt;real_t&gt;&gt; combinedPrimalConstraints(<span class="keyword">const</span> Container&amp; ietiMapper, <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> k);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> Container&gt;</div>
<div class="line">std::vector&lt;index_t&gt; combinedSkeletonDofs(<span class="keyword">const</span> Container&amp; ietiMapper, <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> k);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> Container&gt;</div>
<div class="line">std::vector&lt;std::vector&lt;gsMatrix&lt;&gt;&gt;&gt; decomposeSolution(<span class="keyword">const</span> Container&amp; ietiMapper, <span class="keyword">const</span> std::vector&lt;<a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a>&gt;&amp; solution);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</div>
<div class="line"><span class="keyword">typename</span> <a class="code hl_typedef" href="classgismo_1_1gsMultiPatch.html#ad7190c68d8ead80bd1b6fd7256779894">gsMultiPatch&lt;T&gt;::uPtr</a> lift3D( <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch&lt;T&gt;</a>&amp; mp, T z );</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line"><span class="comment">    /************** Define command line options *************/</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span> liftGeo = <span class="keyword">false</span>;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> splitPatches = 0;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> refinements = 1;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> degree = 2;</div>
<div class="line">    real_t tolerance = 1.e-6;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> maxIterations = 300;</div>
<div class="line">    std::string fn;</div>
<div class="line">    <span class="keywordtype">bool</span> plot = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsCmdLine.html">gsCmdLine</a> cmd(<span class="stringliteral">&quot;Solves the Stokes system with an isogeometric discretization using an isogeometric tearing and interconnecting (IETI) solver.&quot;</span>);</div>
<div class="line">    cmd.addSwitch(<span class="stringliteral">&quot;&quot;</span>,  <span class="stringliteral">&quot;3D&quot;</span>,                    <span class="stringliteral">&quot;Lift geometry to 3D.&quot;</span>, liftGeo);</div>
<div class="line">    cmd.addInt   (<span class="stringliteral">&quot;&quot;</span>,  <span class="stringliteral">&quot;SplitPatches&quot;</span>,          <span class="stringliteral">&quot;Split every patch that many times in 2^d patches&quot;</span>, splitPatches);</div>
<div class="line">    cmd.addInt   (<span class="stringliteral">&quot;r&quot;</span>, <span class="stringliteral">&quot;Refinements&quot;</span>,           <span class="stringliteral">&quot;Number of uniform h-refinement steps to perform before solving&quot;</span>, refinements);</div>
<div class="line">    cmd.addInt   (<span class="stringliteral">&quot;p&quot;</span>, <span class="stringliteral">&quot;Degree&quot;</span>,                <span class="stringliteral">&quot;Degree of the B-spline discretization space (for pressure)&quot;</span>, degree);</div>
<div class="line">    cmd.addReal  (<span class="stringliteral">&quot;t&quot;</span>, <span class="stringliteral">&quot;Solver.Tolerance&quot;</span>,      <span class="stringliteral">&quot;Stopping criterion for linear solver&quot;</span>, tolerance);</div>
<div class="line">    cmd.addInt   (<span class="stringliteral">&quot;&quot;</span>,  <span class="stringliteral">&quot;Solver.MaxIterations&quot;</span>,  <span class="stringliteral">&quot;Stopping criterion for linear solver&quot;</span>, maxIterations);</div>
<div class="line">    cmd.addString(<span class="stringliteral">&quot;&quot;</span> , <span class="stringliteral">&quot;fn&quot;</span>,                    <span class="stringliteral">&quot;Write solution and used options to file&quot;</span>, fn);</div>
<div class="line">    cmd.addSwitch(     <span class="stringliteral">&quot;plot&quot;</span>,                  <span class="stringliteral">&quot;Plot the result with Paraview&quot;</span>, plot);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">try</span> { cmd.getValues(argc,argv); } <span class="keywordflow">catch</span> (<span class="keywordtype">int</span> rv) { <span class="keywordflow">return</span> rv; }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Use Geometry</span></div>
<div class="line">    std::string geometry(<span class="stringliteral">&quot;planar/rectangle_with_disk_hole.xml&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Use geometry file planar/rectangle_with_disk_hole.xml.\n&quot;</span>;</div>
<div class="line">    <span class="keywordflow">if</span> ( ! <a class="code hl_function" href="classgismo_1_1gsFileManager.html#a8da6832660ffb6bbf974846015f44a21">gsFileManager::fileExists</a>(geometry) )</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Geometry file could not be found.\n&quot;</span>;</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;I was searching in the current directory and in: &quot;</span> &lt;&lt; <a class="code hl_function" href="classgismo_1_1gsFileManager.html#a76962c9181651d5335c0712a38f0e6a6">gsFileManager::getSearchPaths</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Run ieti_stokes_example with options:\n&quot;</span> &lt;&lt; cmd &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line"><span class="comment">    /******************* Define geometry ********************/</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Define geometry... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_typedef" href="classgismo_1_1gsMultiPatch.html#ad7190c68d8ead80bd1b6fd7256779894">gsMultiPatch&lt;&gt;::uPtr</a> mpPtr = <a class="code hl_class" href="classgismo_1_1gsReadFile.html">gsReadFile&lt;&gt;</a>(geometry);</div>
<div class="line">    <span class="keywordflow">if</span> (!mpPtr)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;No geometry found in file &quot;</span> &lt;&lt; geometry &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (liftGeo)</div>
<div class="line">        mpPtr = lift3D(*mpPtr,(real_t)(10));</div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch&lt;&gt;</a>&amp; mp = *mpPtr;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> std::size_t dim = mp.geoDim();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i=0; i&lt;splitPatches; ++i)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;split patches uniformly... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line">        mp = mp.uniformSplit();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done.\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">    /************** Define boundary conditions **************/</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Define boundary conditions... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// The following boundary conditions are set up to make sense for the</span></div>
<div class="line">    <span class="comment">// &quot;rectangle with disk hole&quot;-domain.</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Functions used to describe boundary data</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsConstantFunction.html">gsConstantFunction&lt;&gt;</a> zero( 0.0, dim );</div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a> inflow( dim&lt;3 ? <span class="stringliteral">&quot;sin(pi*(2+y)/4)&quot;</span> : <span class="stringliteral">&quot;sin(pi*(2+y)/4)*z*(10-z)&quot;</span>, dim );</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Boundary conditions</span></div>
<div class="line">    std::vector&lt;gsBoundaryConditions&lt;&gt;&gt; bc;</div>
<div class="line">    bc.resize(dim+1);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> inlets = 0, outlets = 0, bccount = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (gsMultiPatch&lt;&gt;::const_biterator it = mp.bBegin(); it &lt; mp.bEnd(); ++it)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (it-&gt;patch / math::exp2(mp.geoDim()*splitPatches) == 3 &amp;&amp; it-&gt;side() == 4) <span class="comment">// Inlet</span></div>
<div class="line">        {</div>
<div class="line">            bc[0].addCondition( *it, <a class="code hl_enumvalue" href="structgismo_1_1condition__type.html#a7aead736a07eaf25623ad7bfa1f0ee2da1b4f535d1f53363637f933002efc2b4b">condition_type::dirichlet</a>, &amp;inflow );</div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t r=1; r&lt;dim; ++r)</div>
<div class="line">                bc[r].addCondition( *it, <a class="code hl_enumvalue" href="structgismo_1_1condition__type.html#a7aead736a07eaf25623ad7bfa1f0ee2da1b4f535d1f53363637f933002efc2b4b">condition_type::dirichlet</a>, &amp;zero );</div>
<div class="line">            ++inlets;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (it-&gt;patch / math::exp2(mp.geoDim()*splitPatches) == 10 &amp;&amp; it-&gt;side() == 2) <span class="comment">// Outlet</span></div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t r=0; r&lt;dim; ++r)</div>
<div class="line">                bc[r].addCondition( *it, <a class="code hl_enumvalue" href="structgismo_1_1condition__type.html#a7aead736a07eaf25623ad7bfa1f0ee2da8e855db37d5c0fbd8eda96b2f51b8b20">condition_type::neumann</a>, &amp;zero );</div>
<div class="line">            ++outlets;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t r=0; r&lt;dim; ++r)</div>
<div class="line">                bc[r].addCondition( *it, <a class="code hl_enumvalue" href="structgismo_1_1condition__type.html#a7aead736a07eaf25623ad7bfa1f0ee2da1b4f535d1f53363637f933002efc2b4b">condition_type::dirichlet</a>, &amp;zero );</div>
<div class="line">        }</div>
<div class="line">        ++bccount;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (std::size_t r=0; r&lt;dim+1; ++r)</div>
<div class="line">        bc[r].setGeoMap(mp);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done: &quot;</span>&lt;&lt;bccount&lt;&lt;<span class="stringliteral">&quot; conditions, including &quot;</span></div>
<div class="line">           &lt;&lt;inlets&lt;&lt;<span class="stringliteral">&quot; inlet and &quot;</span>&lt;&lt;outlets&lt;&lt;<span class="stringliteral">&quot; outlet, set.\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">    /************ Setup bases and adjust degree *************/</span></div>
<div class="line">    std::vector&lt;gsMultiBasis&lt;&gt;&gt; mb;</div>
<div class="line">    <span class="keywordflow">for</span> (std::size_t r=0; r&lt;dim+1; ++r)</div>
<div class="line">        mb.emplace_back(mp,<span class="keyword">true</span>);</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> nPatches = mp.nPatches();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Setup bases and adjust degree (Taylor-Hood)... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (std::size_t r=0; r&lt;dim; ++r)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> k=0; k&lt;nPatches; ++k)</div>
<div class="line">            mb[r][k].setDegreePreservingMultiplicity(degree+1);</div>
<div class="line">        <span class="keywordflow">for</span> ( <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i=0; i&lt;refinements; ++i )</div>
<div class="line">            mb[r].uniformRefine();</div>
<div class="line">        <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> k=0; k&lt;nPatches; ++k)</div>
<div class="line">            mb[r][k].reduceContinuity(1);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> k=0; k&lt;nPatches; ++k)</div>
<div class="line">        mb[dim][k].setDegreePreservingMultiplicity(degree);</div>
<div class="line">    <span class="keywordflow">for</span> ( <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i=0; i&lt;refinements; ++i )</div>
<div class="line">        mb[dim].uniformRefine();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done.\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">    /********* Setup assembler and assemble matrix **********/</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Setup assembler and assemble matrix for patch... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;gsIetiMapper&lt;&gt;&gt; ietiMapper;</div>
<div class="line">    ietiMapper.resize(dim+1);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// We start by setting up a global assembler for each component to</span></div>
<div class="line">    <span class="comment">// obtain a dof mapper and the Dirichlet data</span></div>
<div class="line">    <span class="keywordflow">for</span> (std::size_t r=0; r&lt;dim+1; ++r)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Velocity is C^0 continuous, but pressure discontinuous.</span></div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> continuity = r&lt;dim ? 0 : -1;</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsExprAssembler.html">gsExprAssembler&lt;&gt;</a> assembler;</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1expr_1_1gsFeSpace.html">gsExprAssembler&lt;&gt;::space</a> u = assembler.getSpace(mb[r]);</div>
<div class="line">        u.setup(bc[r], dirichlet::interpolation, continuity);</div>
<div class="line">        ietiMapper[r].init(mb[r], u.mapper(), u.fixedPart());</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Compute the jump matrices (Fully redundant, exclude corners)</span></div>
<div class="line">    <span class="keywordflow">for</span> (std::size_t r=0; r&lt;dim+1; ++r)</div>
<div class="line">        ietiMapper[r].computeJumpMatrices(<span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// We tell the ieti mapper which primal constraints we want; calling</span></div>
<div class="line">    <span class="comment">// more than one such function is possible.</span></div>
<div class="line">    <span class="keywordflow">for</span> (std::size_t r=0; r&lt;dim; ++r)</div>
<div class="line">    {</div>
<div class="line">        ietiMapper[r].cornersAsPrimals();</div>
<div class="line">        ietiMapper[r].interfaceAveragesAsPrimals(mp,dim-1);</div>
<div class="line">    }</div>
<div class="line">    ietiMapper[dim].interfaceAveragesAsPrimals(mp,dim);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// The ieti system does not have a special treatment for the</span></div>
<div class="line">    <span class="comment">// primal dofs. They are just one more subdomain</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsIetiSystem.html">gsIetiSystem&lt;&gt;</a> ieti;</div>
<div class="line">    ieti.<a class="code hl_function" href="classgismo_1_1gsIetiSystem.html#a7ebf485c8ffc385c75b2a9369edabd49">reserve</a>(nPatches+1);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// The scaled Dirichlet preconditioner is independent of the</span></div>
<div class="line">    <span class="comment">// primal dofs.</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsScaledDirichletPrec.html">gsScaledDirichletPrec&lt;&gt;</a> prec;</div>
<div class="line">    prec.<a class="code hl_function" href="classgismo_1_1gsScaledDirichletPrec.html#a7ebf485c8ffc385c75b2a9369edabd49">reserve</a>(nPatches);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Setup the primal system, which needs to know the number of primal dofs.</span></div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> nPrimals = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (std::size_t r=0; r&lt;dim+1; ++r)</div>
<div class="line">        nPrimals += ietiMapper[r].nPrimalDofs();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsPrimalSystem.html">gsPrimalSystem&lt;&gt;</a> primal(nPrimals);</div>
<div class="line">    primal.setEliminatePointwiseConstraints(<span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> k=0; k&lt;nPatches; ++k)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;[&quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;] &quot;</span> &lt;&lt; std::flush;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// We use the local variants of everything</span></div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch&lt;&gt;</a>                      mp_local = mp[k];</div>
<div class="line">        std::vector&lt;gsMultiBasis&lt;&gt;&gt;         mb_local;</div>
<div class="line">        std::vector&lt;gsBoundaryConditions&lt;&gt;&gt; bc_local(dim+1);</div>
<div class="line">        mb_local.reserve(dim+1);</div>
<div class="line">        <span class="keywordflow">for</span> (std::size_t r=0; r&lt;dim+1; ++r)</div>
<div class="line">        {</div>
<div class="line">            mb_local.push_back(mb[r][k]);</div>
<div class="line">            bc[r].getConditionsForPatch(k,bc_local[r]);</div>
<div class="line">            bc_local[r].setGeoMap(mp_local);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// We assemble the stiffness matrix with the expression assembler</span></div>
<div class="line">        <span class="keyword">typedef</span> <a class="code hl_typedef" href="classgismo_1_1gsExprAssembler.html#a16c60fa6666b6a61c747b016c385a4e2">gsExprAssembler&lt;&gt;::geometryMap</a> geometryMap;</div>
<div class="line">        <span class="keyword">typedef</span> <a class="code hl_class" href="classgismo_1_1expr_1_1gsFeVariable.html">gsExprAssembler&lt;&gt;::variable</a>    variable;</div>
<div class="line">        <span class="keyword">typedef</span> <a class="code hl_class" href="classgismo_1_1expr_1_1gsFeSpace.html">gsExprAssembler&lt;&gt;::space</a>       space;</div>
<div class="line">        <span class="keyword">typedef</span> <a class="code hl_typedef" href="classgismo_1_1gsExprAssembler.html#aa2c9456b2c52d7b912894815a3c593da">gsExprAssembler&lt;&gt;::solution</a>    solution;</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsExprAssembler.html">gsExprAssembler&lt;&gt;</a> assembler(dim+1,dim+1);</div>
<div class="line">        assembler.setIntegrationElements(mb_local[0]);</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsExprEvaluator.html">gsExprEvaluator&lt;&gt;</a> ev(assembler);</div>
<div class="line">        geometryMap G = assembler.getMap(mp_local);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Velocity space</span></div>
<div class="line">        std::vector&lt;std::remove_cv&lt;space&gt;::type&gt; v;</div>
<div class="line">        <span class="keywordflow">for</span> (std::size_t r=0; r&lt;dim; ++r)</div>
<div class="line">        {</div>
<div class="line">            v.push_back(assembler.getSpace(mb_local[r],1,r));</div>
<div class="line">            v[r].setup(bc_local[r], dirichlet::interpolation, 0);</div>
<div class="line">            ietiMapper[r].initFeSpace(v[r],k);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Presure space</span></div>
<div class="line">        space p = assembler.getSpace(mb_local[dim],1,dim);</div>
<div class="line">        p.setup(bc_local[dim], dirichlet::interpolation, 0);</div>
<div class="line">        ietiMapper[dim].initFeSpace(p,k);</div>
<div class="line"> </div>
<div class="line">        assembler.initSystem();</div>
<div class="line">        <span class="keywordflow">for</span> (std::size_t r=0; r&lt;dim; ++r)</div>
<div class="line">        {</div>
<div class="line">            assembler.assemble( igrad(v[r], G)   * igrad(v[r], G).tr()   * <a class="code hl_function" href="namespacegismo_1_1expr.html#a37e91c8b6c3efac383e28a3cb2b5f092">meas</a>(G) ,</div>
<div class="line">                                igrad(v[r],G)[r] * p.tr()                * <a class="code hl_function" href="namespacegismo_1_1expr.html#a37e91c8b6c3efac383e28a3cb2b5f092">meas</a>(G) ,</div>
<div class="line">                                p                * igrad(v[r],G)[r].tr() * <a class="code hl_function" href="namespacegismo_1_1expr.html#a37e91c8b6c3efac383e28a3cb2b5f092">meas</a>(G) );</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Fetch data</span></div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;&gt;</a>                 localMatrix  = assembler.matrix();</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a>                       localRhs      = assembler.rhs();</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;real_t,RowMajor&gt;</a>  jumpMatrix    = combinedJumpMatrix(ietiMapper, k);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// For preconditioning, we only use the Poisson part</span></div>
<div class="line">        {</div>
<div class="line">            <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> sz = 0;</div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t r=0; r&lt;dim; ++r)</div>
<div class="line">                sz += ietiMapper[r].jumpMatrix(k).cols();</div>
<div class="line">            <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;&gt;</a> velocityJumpMatrix = jumpMatrix.block(0,0,jumpMatrix.rows(),sz);</div>
<div class="line">            <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;&gt;</a> poissonMatrix = localMatrix.block(0,0,sz,sz);</div>
<div class="line"> </div>
<div class="line">            std::vector&lt;index_t&gt; skeletonDofs      = combinedSkeletonDofs(ietiMapper,k);</div>
<div class="line">            <a class="code hl_struct" href="structgismo_1_1gsScaledDirichletPrec_1_1Blocks.html">gsScaledDirichletPrec&lt;&gt;::Blocks</a> blocks = <a class="code hl_function" href="classgismo_1_1gsScaledDirichletPrec.html#adfac85e147606b452a85b2881ebb3a6b">gsScaledDirichletPrec&lt;&gt;::matrixBlocks</a>( poissonMatrix, skeletonDofs );</div>
<div class="line"> </div>
<div class="line">            prec.<a class="code hl_function" href="classgismo_1_1gsScaledDirichletPrec.html#a6576e33b303fa0efb7b7ef8e3a6bc3f9">addSubdomain</a>(</div>
<div class="line">                <a class="code hl_class" href="classgismo_1_1gsScaledDirichletPrec.html">gsScaledDirichletPrec&lt;&gt;::restrictJumpMatrix</a>( velocityJumpMatrix, skeletonDofs ).moveToPtr(),</div>
<div class="line">                <a class="code hl_class" href="classgismo_1_1gsScaledDirichletPrec.html">gsScaledDirichletPrec&lt;&gt;::schurComplement</a>( blocks, makeSparseCholeskySolver(blocks.A11) )</div>
<div class="line">            );</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Collecting the primal DoFs</span></div>
<div class="line">        std::vector&lt;index_t&gt; primalDofIndices                 = combinedPrimalDofIndices(ietiMapper,k);</div>
<div class="line">        std::vector&lt;gsSparseVector&lt;real_t&gt;&gt; primalConstraints = combinedPrimalConstraints(ietiMapper,k);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// This function writes back to jumpMatrix, localMatrix, and localRhs,</span></div>
<div class="line">        <span class="comment">// so it must be called after prec.addSubdomain().</span></div>
<div class="line">        primal.handleConstraints(primalConstraints, primalDofIndices, jumpMatrix, localMatrix, localRhs);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Register local problem to ieti system</span></div>
<div class="line">        ieti.<a class="code hl_function" href="classgismo_1_1gsIetiSystem.html#a61e3b879da178aeaf79e2db044df337e">addSubdomain</a>(jumpMatrix.<a class="code hl_function" href="classgismo_1_1gsSparseMatrix.html#a24da616b328c15186de32aa2c9a51938">moveToPtr</a>(),</div>
<div class="line">                          makeMatrixOp(localMatrix),</div>
<div class="line">                          <a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(localRhs),</div>
<div class="line">                          makeSparseLUSolver(localMatrix)</div>
<div class="line">                         );</div>
<div class="line"> </div>
<div class="line">    } <span class="comment">// End of local assemblers</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Add the primal problem</span></div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_typedef" href="classgismo_1_1gsLinearOperator.html#a7e083f6c92575f77236d6cb193997e84">gsLinearOperator&lt;&gt;::Ptr</a> localSolver = makeSparseLUSolver(primal.localMatrix());</div>
<div class="line"> </div>
<div class="line">        ieti.<a class="code hl_function" href="classgismo_1_1gsIetiSystem.html#a61e3b879da178aeaf79e2db044df337e">addSubdomain</a>(</div>
<div class="line">            primal.jumpMatrix().moveToPtr(),</div>
<div class="line">            makeMatrixOp(primal.localMatrix().moveToPtr()),</div>
<div class="line">            <a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(primal.localRhs()),</div>
<div class="line">            localSolver</div>
<div class="line">        );</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done.\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">    /**************** Setup solver and solve ****************/</span></div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Setup solver and solve... \n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;    Setup multiplicity scaling... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Tell the preconditioner to set up the scaling</span></div>
<div class="line">    prec.<a class="code hl_function" href="classgismo_1_1gsScaledDirichletPrec.html#acaa221022cd4b0107af70d2e4d354699">setupMultiplicityScaling</a>();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done.\n    Setup CG solver and solve... \n&quot;</span> &lt;&lt; std::flush;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Solve for Lagrange multipliers</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a> lambda;</div>
<div class="line">    lambda.setRandom( ieti.<a class="code hl_function" href="classgismo_1_1gsIetiSystem.html#afb71515dac55fb71df1f54e2c11e17d3">nLagrangeMultipliers</a>(), 1 );</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a> errorHistory;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsConjugateGradient.html">gsConjugateGradient&lt;&gt;</a> PCG( ieti.<a class="code hl_function" href="classgismo_1_1gsIetiSystem.html#a0a5d5a8299ab6a12765afffe40bdc8a8">schurComplement</a>(), prec.<a class="code hl_function" href="classgismo_1_1gsScaledDirichletPrec.html#a2b5388ceb650e63fe7f570f2e3ce3326">preconditioner</a>() );</div>
<div class="line">    PCG.setCalcEigenvalues(<span class="keyword">true</span>);</div>
<div class="line">    PCG.setOptions(cmd.getGroup(<span class="stringliteral">&quot;Solver&quot;</span>));</div>
<div class="line">    PCG.solveDetailed( ieti.<a class="code hl_function" href="classgismo_1_1gsIetiSystem.html#ae5a999a00f2c2b6388e35bd0cb3327fb">rhsForSchurComplement</a>(), lambda, errorHistory);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Report on behavior of solver</span></div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> iter = errorHistory.rows()-1;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">bool</span> success = errorHistory(iter,0) &lt; PCG.tolerance();</div>
<div class="line">    <span class="keywordflow">if</span> (success)</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;        Reached desired tolerance after &quot;</span> &lt;&lt; iter &lt;&lt; <span class="stringliteral">&quot; iterations:\n        &quot;</span>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;        Did not reach desired tolerance after &quot;</span> &lt;&lt; iter &lt;&lt; <span class="stringliteral">&quot; iterations:\n        &quot;</span>;</div>
<div class="line">    <span class="keywordflow">if</span> (errorHistory.rows() &lt; 20)</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; errorHistory.transpose() &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; errorHistory.topRows(5).transpose() &lt;&lt; <span class="stringliteral">&quot; ... &quot;</span> &lt;&lt; errorHistory.bottomRows(5).transpose()  &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;        Calculated condition number is &quot;</span> &lt;&lt; PCG.getConditionNumber() &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;\n    Reconstruct solution from Lagrange multipliers... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Now, we want to reconstruct the solution</span></div>
<div class="line">    std::vector&lt;std::vector&lt;gsMatrix&lt;&gt;&gt;&gt; solutionPatches = decomposeSolution(ietiMapper,</div>
<div class="line">                                                               primal.distributePrimalSolution(</div>
<div class="line">                                                                   ieti.<a class="code hl_function" href="classgismo_1_1gsIetiSystem.html#af6fe2b719cb8a981b88c6f89863030a3">constructSolutionFromLagrangeMultipliers</a>(lambda)</div>
<div class="line">                                                               )</div>
<div class="line">                                                           );</div>
<div class="line">    std::vector&lt;gsMatrix&lt;&gt;&gt; solutions;</div>
<div class="line">    <span class="keywordflow">for</span> (std::size_t r=0; r&lt;ietiMapper.size(); ++r)</div>
<div class="line">        solutions.push_back( ietiMapper[r].constructGlobalSolutionFromLocalSolutions(solutionPatches[r]));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done.\nDone.\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">    /******************** Print end Exit ********************/</span></div>
<div class="line">    <span class="keywordflow">if</span> (!fn.empty())</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsFileData.html">gsFileData&lt;&gt;</a> fd;</div>
<div class="line">        std::time_t time = std::time(NULL);</div>
<div class="line">        fd.add(cmd);</div>
<div class="line">        <span class="keywordflow">for</span> (std::size_t r=0; r&lt;ietiMapper.size(); ++r)</div>
<div class="line">            fd.add(solutions[r]);</div>
<div class="line">        fd.addComment(std::string(<span class="stringliteral">&quot;stokes_ieti_example   Timestamp:&quot;</span>)+std::ctime(&amp;time));</div>
<div class="line">        fd.save(fn);</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Write solution to file &quot;</span> &lt;&lt; fn &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (plot)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">for</span> (std::size_t r=0; r&lt;ietiMapper.size(); ++r)</div>
<div class="line">        {</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">char</span>* filenames[] = { <span class="stringliteral">&quot;ieti_velocity_x&quot;</span>, <span class="stringliteral">&quot;ieti_velocity_y&quot;</span>, <span class="stringliteral">&quot;ieti_velocity_z&quot;</span>, <span class="stringliteral">&quot;ieti_pressure&quot;</span> };</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">char</span>* filename = filenames[(r&lt;dim&amp;&amp;r&lt;3)?r:3];</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Write Paraview data to file \&quot;&quot;</span> &lt;&lt; filename &lt;&lt; <span class="stringliteral">&quot;.pvd\&quot;.\n&quot;</span>;</div>
<div class="line">            <a class="code hl_class" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch&lt;&gt;</a> mpsol;</div>
<div class="line">            <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> k=0; k&lt;nPatches; ++k)</div>
<div class="line">                mpsol.<a class="code hl_function" href="classgismo_1_1gsMultiPatch.html#a9fbe98882789c00c743d121b7f59df52">addPatch</a>( mb[r][k].makeGeometry( ietiMapper[r].incorporateFixedPart(k, solutionPatches[r][k]) ) );</div>
<div class="line">            gsWriteParaview&lt;&gt;( <a class="code hl_class" href="classgismo_1_1gsField.html">gsField&lt;&gt;</a>( mp, mpsol ), filename, dim &lt; 3 ? 1000 : 10000);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!plot&amp;&amp;fn.empty())</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;No output created, re-run with --plot to get a ParaView &quot;</span></div>
<div class="line">                  <span class="stringliteral">&quot;file containing the solution or --fn to write solution to xml file.\n&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> success ? EXIT_SUCCESS : EXIT_FAILURE;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Helper functions</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Iterator&gt;</div>
<div class="line"><span class="keyword">typename</span> std::iterator_traits&lt;Iterator&gt;::value_type blockDiagonal( Iterator begin, Iterator end )</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">typedef</span> <span class="keyword">typename</span> std::iterator_traits&lt;Iterator&gt;::value_type sparseMatrix;</div>
<div class="line">    <span class="keyword">typedef</span> <span class="keyword">typename</span> sparseMatrix::Scalar T;</div>
<div class="line">    <span class="keyword">typedef</span> <span class="keyword">typename</span> sparseMatrix::Index Index;</div>
<div class="line">    Index nz = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (Iterator sm_it=begin; sm_it!=end; ++sm_it)</div>
<div class="line">        nz += sm_it-&gt;nonZeros();</div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsSparseEntries.html">gsSparseEntries&lt;T&gt;</a> se;</div>
<div class="line">    se.reserve(nz);</div>
<div class="line">    Index rows = 0, cols = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (Iterator sm_it=begin; sm_it!=end; ++sm_it)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> sparseMatrix&amp; sm = *sm_it;</div>
<div class="line">        <span class="keywordflow">for</span>(Index j=0; j&lt;sm.outerSize(); ++j)</div>
<div class="line">            <span class="keywordflow">for</span>(<span class="keyword">typename</span> sparseMatrix::InnerIterator it(sm,j); it; ++it)</div>
<div class="line">                se.add(rows+it.row(), cols+it.col(), it.value());</div>
<div class="line">        rows += sm.rows();</div>
<div class="line">        cols += sm.cols();</div>
<div class="line">    }</div>
<div class="line">    sparseMatrix result(rows, cols);</div>
<div class="line">    result.setFrom(se);</div>
<div class="line">    <span class="keywordflow">return</span> result;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> Container&gt;</div>
<div class="line"><a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;real_t, RowMajor&gt;</a> combinedJumpMatrix(<span class="keyword">const</span> Container&amp; ietiMapper, <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> k)</div>
<div class="line">{</div>
<div class="line">    std::vector&lt;gsSparseMatrix&lt;real_t, RowMajor&gt;&gt; jumpMatrices;</div>
<div class="line">    <span class="keywordflow">for</span> (std::size_t r=0; r&lt;ietiMapper.size(); ++r)</div>
<div class="line">        jumpMatrices.push_back(ietiMapper[r].jumpMatrix(k));</div>
<div class="line">    <span class="keywordflow">return</span> blockDiagonal(jumpMatrices.begin(), jumpMatrices.end());</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> Container&gt;</div>
<div class="line">std::vector&lt;index_t&gt; combinedPrimalDofIndices(<span class="keyword">const</span> Container&amp; ietiMapper, <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> k)</div>
<div class="line">{</div>
<div class="line">    std::vector&lt;index_t&gt; primalDofIndices;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> offset = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (std::size_t i=0; i&lt;ietiMapper.size(); ++i)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;index_t&gt;&amp; ind = ietiMapper[i].primalDofIndices(k);</div>
<div class="line">        <span class="keywordflow">for</span> (std::size_t j=0; j&lt;ind.size(); ++j)</div>
<div class="line">            primalDofIndices.push_back(ind[j]+offset);</div>
<div class="line">        offset += ietiMapper[i].nPrimalDofs();</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> primalDofIndices;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> Container&gt;</div>
<div class="line">std::vector&lt;gsSparseVector&lt;real_t&gt;&gt; combinedPrimalConstraints(<span class="keyword">const</span> Container&amp; ietiMapper, <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> k)</div>
<div class="line">{</div>
<div class="line">    std::vector&lt;gsSparseVector&lt;real_t&gt;&gt; primalConstraints;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> pre = 0, rows = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (std::size_t i=0; i&lt;ietiMapper.size(); ++i)</div>
<div class="line">        rows += ietiMapper[i].jumpMatrix(k).cols();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (std::size_t i=0; i&lt;ietiMapper.size(); ++i)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;gsSparseVector&lt;real_t&gt;&gt;&amp; cond = ietiMapper[i].primalConstraints(k);</div>
<div class="line">        <span class="keywordflow">for</span> (std::size_t j=0; j&lt;cond.size(); ++j)</div>
<div class="line">        {</div>
<div class="line">            <a class="code hl_class" href="classgismo_1_1gsSparseVector.html">gsSparseVector&lt;real_t&gt;</a> tmp(rows);</div>
<div class="line">            <span class="keywordflow">for</span> (<a class="code hl_class" href="classgismo_1_1gsSparseVector.html">gsSparseVector&lt;real_t&gt;::InnerIterator</a> it(cond[j]); it; ++it)</div>
<div class="line">                tmp[pre + it.row()] = it.value();</div>
<div class="line">            primalConstraints.push_back(<a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(tmp));</div>
<div class="line">        }</div>
<div class="line">        pre += ietiMapper[i].jumpMatrix(k).cols();</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> primalConstraints;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> Container&gt;</div>
<div class="line">std::vector&lt;index_t&gt; combinedSkeletonDofs(<span class="keyword">const</span> Container&amp; ietiMapper, <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> k)</div>
<div class="line">{</div>
<div class="line">    std::vector&lt;index_t&gt; skeletonDofs;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> offset = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (std::size_t i=0; i&lt;ietiMapper.size(); ++i)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;index_t&gt;&amp; sd = ietiMapper[i].skeletonDofs(k);</div>
<div class="line">        <span class="keywordflow">for</span> (std::size_t j = 0; j&lt;sd.size(); ++j)</div>
<div class="line">            skeletonDofs.push_back(sd[j]+offset);</div>
<div class="line">        offset += ietiMapper[i].jumpMatrix(k).cols();</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> skeletonDofs;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> Container&gt;</div>
<div class="line">std::vector&lt;std::vector&lt;gsMatrix&lt;&gt;&gt;&gt; decomposeSolution(<span class="keyword">const</span> Container&amp; ietiMapper, <span class="keyword">const</span> std::vector&lt;<a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a>&gt;&amp; solution)</div>
<div class="line">{</div>
<div class="line">    std::vector&lt;std::vector&lt;gsMatrix&lt;&gt;&gt;&gt; result(ietiMapper.size());</div>
<div class="line">    <span class="keywordflow">for</span> (std::size_t r=0; r&lt;ietiMapper.size(); ++r)</div>
<div class="line">        result[r].reserve(solution.size());</div>
<div class="line">    <span class="keywordflow">for</span> (std::size_t k=0; k&lt;solution.size(); ++k)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> offset = 0;</div>
<div class="line">        <span class="keywordflow">for</span> (std::size_t r=0; r&lt;ietiMapper.size(); ++r)</div>
<div class="line">        {</div>
<div class="line">            <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> sz = ietiMapper[r].jumpMatrix(k).cols();</div>
<div class="line">            result[r].push_back(solution[k].block(offset,0,sz,1));</div>
<div class="line">            offset += ietiMapper[r].jumpMatrix(k).cols();</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> result;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</div>
<div class="line"><span class="keyword">typename</span> <a class="code hl_typedef" href="classgismo_1_1gsMultiPatch.html#ad7190c68d8ead80bd1b6fd7256779894">gsMultiPatch&lt;T&gt;::uPtr</a> lift3D( <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch&lt;T&gt;</a>&amp; mp, T z )</div>
<div class="line">{</div>
<div class="line">    std::vector&lt;gsGeometry&lt;T&gt;*&gt; geos;</div>
<div class="line">    geos.reserve(mp.nPatches());</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">typename</span> std::vector&lt;<a class="code hl_class" href="classgismo_1_1gsGeometry.html">gsGeometry&lt;T&gt;</a>*&gt;::const_iterator it = mp.begin();</div>
<div class="line">        it != mp.end(); ++it)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsTensorBSpline.html">gsTensorBSpline&lt;2,T&gt;</a>* tb = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code hl_class" href="classgismo_1_1gsTensorBSpline.html">gsTensorBSpline&lt;2,T&gt;</a>*<span class="keyword">&gt;</span>(*it);</div>
<div class="line">        <span class="keywordflow">if</span> (tb)</div>
<div class="line">        {</div>
<div class="line">            geos.push_back(<a class="code hl_struct" href="structgismo_1_1gsNurbsCreator.html">gsNurbsCreator&lt;T&gt;::lift3D</a>(*tb, z).release());</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsTensorNurbs.html">gsTensorNurbs&lt;2,T&gt;</a>* tn = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code hl_class" href="classgismo_1_1gsTensorNurbs.html">gsTensorNurbs&lt;2,T&gt;</a>*<span class="keyword">&gt;</span>(*it);</div>
<div class="line">        <span class="keywordflow">if</span> (tn)</div>
<div class="line">        {</div>
<div class="line">            geos.push_back(<a class="code hl_struct" href="structgismo_1_1gsNurbsCreator.html">gsNurbsCreator&lt;T&gt;::lift3D</a>(*tn, z).release());</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#ad244d2129e4089c7772855461057e0fb">GISMO_ENSURE</a>(<span class="keyword">false</span>, <span class="stringliteral">&quot;lift3D only available for gsTensorBSpline&lt;2,T&gt; and gsTensorNurbs&lt;2,T&gt;.&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keyword">typename</span> <a class="code hl_typedef" href="classgismo_1_1gsMultiPatch.html#ad7190c68d8ead80bd1b6fd7256779894">gsMultiPatch&lt;T&gt;::uPtr</a> result = <a class="code hl_function" href="namespacegismo_1_1memory.html#acd7657f8f967050ad973c6f72ef2b588">memory::make_unique</a>(<span class="keyword">new</span> <a class="code hl_class" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch&lt;T&gt;</a>(geos));</div>
<div class="line">    result-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiPatch.html#a64586846e869ce2e515ff4255b528832">computeTopology</a>();</div>
<div class="line">    <span class="keywordflow">return</span> result;</div>
<div class="line">}</div>
<div class="ttc" id="aclassgismo_1_1expr_1_1gsFeSpace_html"><div class="ttname"><a href="classgismo_1_1expr_1_1gsFeSpace.html">gismo::expr::gsFeSpace</a></div><div class="ttdef"><b>Definition</b> gsExpressions.h:973</div></div>
<div class="ttc" id="aclassgismo_1_1expr_1_1gsFeVariable_html"><div class="ttname"><a href="classgismo_1_1expr_1_1gsFeVariable.html">gismo::expr::gsFeVariable</a></div><div class="ttdef"><b>Definition</b> gsExpressions.h:928</div></div>
<div class="ttc" id="aclassgismo_1_1gsCmdLine_html"><div class="ttname"><a href="classgismo_1_1gsCmdLine.html">gismo::gsCmdLine</a></div><div class="ttdoc">Class for command-line argument parsing.</div><div class="ttdef"><b>Definition</b> gsCmdLine.h:57</div></div>
<div class="ttc" id="aclassgismo_1_1gsConjugateGradient_html"><div class="ttname"><a href="classgismo_1_1gsConjugateGradient.html">gismo::gsConjugateGradient</a></div><div class="ttdoc">The conjugate gradient method.</div><div class="ttdef"><b>Definition</b> gsConjugateGradient.h:30</div></div>
<div class="ttc" id="aclassgismo_1_1gsConstantFunction_html"><div class="ttname"><a href="classgismo_1_1gsConstantFunction.html">gismo::gsConstantFunction</a></div><div class="ttdoc">Class defining a globally constant function.</div><div class="ttdef"><b>Definition</b> gsConstantFunction.h:34</div></div>
<div class="ttc" id="aclassgismo_1_1gsExprAssembler_html"><div class="ttname"><a href="classgismo_1_1gsExprAssembler.html">gismo::gsExprAssembler</a></div><div class="ttdef"><b>Definition</b> gsExprAssembler.h:33</div></div>
<div class="ttc" id="aclassgismo_1_1gsExprAssembler_html_a16c60fa6666b6a61c747b016c385a4e2"><div class="ttname"><a href="classgismo_1_1gsExprAssembler.html#a16c60fa6666b6a61c747b016c385a4e2">gismo::gsExprAssembler::geometryMap</a></div><div class="ttdeci">gsExprHelper&lt; T &gt;::geometryMap geometryMap</div><div class="ttdoc">Geometry map type.</div><div class="ttdef"><b>Definition</b> gsExprAssembler.h:65</div></div>
<div class="ttc" id="aclassgismo_1_1gsExprAssembler_html_aa2c9456b2c52d7b912894815a3c593da"><div class="ttname"><a href="classgismo_1_1gsExprAssembler.html#aa2c9456b2c52d7b912894815a3c593da">gismo::gsExprAssembler::solution</a></div><div class="ttdeci">expr::gsFeSolution&lt; T &gt; solution</div><div class="ttdoc">Solution type.</div><div class="ttdef"><b>Definition</b> gsExprAssembler.h:68</div></div>
<div class="ttc" id="aclassgismo_1_1gsExprEvaluator_html"><div class="ttname"><a href="classgismo_1_1gsExprEvaluator.html">gismo::gsExprEvaluator</a></div><div class="ttdoc">Generic evaluator of isogeometric expressions.</div><div class="ttdef"><b>Definition</b> gsExprEvaluator.h:39</div></div>
<div class="ttc" id="aclassgismo_1_1gsField_html"><div class="ttname"><a href="classgismo_1_1gsField.html">gismo::gsField</a></div><div class="ttdoc">A scalar of vector field defined on a m_parametric geometry.</div><div class="ttdef"><b>Definition</b> gsField.h:55</div></div>
<div class="ttc" id="aclassgismo_1_1gsFileData_html"><div class="ttname"><a href="classgismo_1_1gsFileData.html">gismo::gsFileData</a></div><div class="ttdoc">This class represents an XML data tree which can be read from or written to a (file) stream.</div><div class="ttdef"><b>Definition</b> gsFileData.h:34</div></div>
<div class="ttc" id="aclassgismo_1_1gsFileManager_html_a76962c9181651d5335c0712a38f0e6a6"><div class="ttname"><a href="classgismo_1_1gsFileManager.html#a76962c9181651d5335c0712a38f0e6a6">gismo::gsFileManager::getSearchPaths</a></div><div class="ttdeci">static std::string getSearchPaths()</div><div class="ttdoc">Get the defined search paths.</div><div class="ttdef"><b>Definition</b> gsFileManager.cpp:271</div></div>
<div class="ttc" id="aclassgismo_1_1gsFileManager_html_a8da6832660ffb6bbf974846015f44a21"><div class="ttname"><a href="classgismo_1_1gsFileManager.html#a8da6832660ffb6bbf974846015f44a21">gismo::gsFileManager::fileExists</a></div><div class="ttdeci">static bool fileExists(const std::string &amp;name)</div><div class="ttdoc">Checks if the file exists.</div><div class="ttdef"><b>Definition</b> gsFileManager.cpp:62</div></div>
<div class="ttc" id="aclassgismo_1_1gsFunctionExpr_html"><div class="ttname"><a href="classgismo_1_1gsFunctionExpr.html">gismo::gsFunctionExpr</a></div><div class="ttdoc">Class defining a multivariate (real or vector) function given by a string mathematical expression.</div><div class="ttdef"><b>Definition</b> gsFunctionExpr.h:52</div></div>
<div class="ttc" id="aclassgismo_1_1gsGeometry_html"><div class="ttname"><a href="classgismo_1_1gsGeometry.html">gismo::gsGeometry</a></div><div class="ttdoc">Abstract base class representing a geometry map.</div><div class="ttdef"><b>Definition</b> gsGeometry.h:93</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiSystem_html"><div class="ttname"><a href="classgismo_1_1gsIetiSystem.html">gismo::gsIetiSystem</a></div><div class="ttdoc">This class represents a IETI system.</div><div class="ttdef"><b>Definition</b> gsIetiSystem.h:70</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiSystem_html_a0a5d5a8299ab6a12765afffe40bdc8a8"><div class="ttname"><a href="classgismo_1_1gsIetiSystem.html#a0a5d5a8299ab6a12765afffe40bdc8a8">gismo::gsIetiSystem::schurComplement</a></div><div class="ttdeci">OpPtr schurComplement() const</div><div class="ttdoc">Returns gsLinearOperator that represents the Schur complement for the IETI problem.</div><div class="ttdef"><b>Definition</b> gsIetiSystem.hpp:83</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiSystem_html_a61e3b879da178aeaf79e2db044df337e"><div class="ttname"><a href="classgismo_1_1gsIetiSystem.html#a61e3b879da178aeaf79e2db044df337e">gismo::gsIetiSystem::addSubdomain</a></div><div class="ttdeci">void addSubdomain(JumpMatrixPtr jumpMatrix, OpPtr localMatrixOp, Matrix localRhs, OpPtr localSolverOp=OpPtr())</div><div class="ttdef"><b>Definition</b> gsIetiSystem.hpp:32</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiSystem_html_a7ebf485c8ffc385c75b2a9369edabd49"><div class="ttname"><a href="classgismo_1_1gsIetiSystem.html#a7ebf485c8ffc385c75b2a9369edabd49">gismo::gsIetiSystem::reserve</a></div><div class="ttdeci">void reserve(index_t n)</div><div class="ttdoc">Reserves the memory required to store the number of subdomains.</div><div class="ttdef"><b>Definition</b> gsIetiSystem.hpp:23</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiSystem_html_ae5a999a00f2c2b6388e35bd0cb3327fb"><div class="ttname"><a href="classgismo_1_1gsIetiSystem.html#ae5a999a00f2c2b6388e35bd0cb3327fb">gismo::gsIetiSystem::rhsForSchurComplement</a></div><div class="ttdeci">Matrix rhsForSchurComplement() const</div><div class="ttdoc">Returns the right-hand-side that is required for the Schur complement formulation of the IETI problem...</div><div class="ttdef"><b>Definition</b> gsIetiSystem.hpp:91</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiSystem_html_af6fe2b719cb8a981b88c6f89863030a3"><div class="ttname"><a href="classgismo_1_1gsIetiSystem.html#af6fe2b719cb8a981b88c6f89863030a3">gismo::gsIetiSystem::constructSolutionFromLagrangeMultipliers</a></div><div class="ttdeci">std::vector&lt; Matrix &gt; constructSolutionFromLagrangeMultipliers(const Matrix &amp;multipliers) const</div><div class="ttdoc">Returns the local solutions for the individual subdomains.</div><div class="ttdef"><b>Definition</b> gsIetiSystem.hpp:107</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiSystem_html_afb71515dac55fb71df1f54e2c11e17d3"><div class="ttname"><a href="classgismo_1_1gsIetiSystem.html#afb71515dac55fb71df1f54e2c11e17d3">gismo::gsIetiSystem::nLagrangeMultipliers</a></div><div class="ttdeci">index_t nLagrangeMultipliers() const</div><div class="ttdoc">Returns the number of Lagrange multipliers.</div><div class="ttdef"><b>Definition</b> gsIetiSystem.h:116</div></div>
<div class="ttc" id="aclassgismo_1_1gsMatrix_html"><div class="ttname"><a href="classgismo_1_1gsMatrix.html">gismo::gsMatrix</a></div><div class="ttdoc">A matrix with arbitrary coefficient type and fixed or dynamic size.</div><div class="ttdef"><b>Definition</b> gsMatrix.h:41</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiPatch_html"><div class="ttname"><a href="classgismo_1_1gsMultiPatch.html">gismo::gsMultiPatch</a></div><div class="ttdoc">Container class for a set of geometry patches and their topology, that is, the interface connections ...</div><div class="ttdef"><b>Definition</b> gsMultiPatch.h:100</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiPatch_html_a64586846e869ce2e515ff4255b528832"><div class="ttname"><a href="classgismo_1_1gsMultiPatch.html#a64586846e869ce2e515ff4255b528832">gismo::gsMultiPatch::computeTopology</a></div><div class="ttdeci">bool computeTopology(T tol=1e-4, bool cornersOnly=false, bool tjunctions=false)</div><div class="ttdoc">Attempt to compute interfaces and boundaries automatically.</div><div class="ttdef"><b>Definition</b> gsMultiPatch.hpp:377</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiPatch_html_a9fbe98882789c00c743d121b7f59df52"><div class="ttname"><a href="classgismo_1_1gsMultiPatch.html#a9fbe98882789c00c743d121b7f59df52">gismo::gsMultiPatch::addPatch</a></div><div class="ttdeci">index_t addPatch(typename gsGeometry&lt; T &gt;::uPtr g)</div><div class="ttdoc">Add a patch from a gsGeometry&lt;T&gt;::uPtr.</div><div class="ttdef"><b>Definition</b> gsMultiPatch.hpp:211</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiPatch_html_ad7190c68d8ead80bd1b6fd7256779894"><div class="ttname"><a href="classgismo_1_1gsMultiPatch.html#ad7190c68d8ead80bd1b6fd7256779894">gismo::gsMultiPatch::uPtr</a></div><div class="ttdeci">memory::unique_ptr&lt; gsMultiPatch &gt; uPtr</div><div class="ttdoc">Unique pointer for gsMultiPatch.</div><div class="ttdef"><b>Definition</b> gsMultiPatch.h:109</div></div>
<div class="ttc" id="aclassgismo_1_1gsPrimalSystem_html"><div class="ttname"><a href="classgismo_1_1gsPrimalSystem.html">gismo::gsPrimalSystem</a></div><div class="ttdoc">This class represents the primal system for a IETI-DP algorithm.</div><div class="ttdef"><b>Definition</b> gsPrimalSystem.h:87</div></div>
<div class="ttc" id="aclassgismo_1_1gsReadFile_html"><div class="ttname"><a href="classgismo_1_1gsReadFile.html">gismo::gsReadFile</a></div><div class="ttdoc">Reads an object from a data file, if such the requested object exists in the file.</div><div class="ttdef"><b>Definition</b> gsReadFile.h:43</div></div>
<div class="ttc" id="aclassgismo_1_1gsScaledDirichletPrec_html"><div class="ttname"><a href="classgismo_1_1gsScaledDirichletPrec.html">gismo::gsScaledDirichletPrec</a></div><div class="ttdoc">This class represents the scaled Dirichlet preconditioner for a IETI problem.</div><div class="ttdef"><b>Definition</b> gsScaledDirichletPrec.h:79</div></div>
<div class="ttc" id="aclassgismo_1_1gsScaledDirichletPrec_html_a2b5388ceb650e63fe7f570f2e3ce3326"><div class="ttname"><a href="classgismo_1_1gsScaledDirichletPrec.html#a2b5388ceb650e63fe7f570f2e3ce3326">gismo::gsScaledDirichletPrec::preconditioner</a></div><div class="ttdeci">OpPtr preconditioner() const</div><div class="ttdoc">This returns the preconditioner as gsLinearOperator.</div><div class="ttdef"><b>Definition</b> gsScaledDirichletPrec.hpp:176</div></div>
<div class="ttc" id="aclassgismo_1_1gsScaledDirichletPrec_html_a6576e33b303fa0efb7b7ef8e3a6bc3f9"><div class="ttname"><a href="classgismo_1_1gsScaledDirichletPrec.html#a6576e33b303fa0efb7b7ef8e3a6bc3f9">gismo::gsScaledDirichletPrec::addSubdomain</a></div><div class="ttdeci">void addSubdomain(JumpMatrixPtr jumpMatrix, OpPtr localSchurOp)</div><div class="ttdef"><b>Definition</b> gsScaledDirichletPrec.h:107</div></div>
<div class="ttc" id="aclassgismo_1_1gsScaledDirichletPrec_html_a7ebf485c8ffc385c75b2a9369edabd49"><div class="ttname"><a href="classgismo_1_1gsScaledDirichletPrec.html#a7ebf485c8ffc385c75b2a9369edabd49">gismo::gsScaledDirichletPrec::reserve</a></div><div class="ttdeci">void reserve(index_t n)</div><div class="ttdoc">Reserves the memory required to store the given number of subdomain.</div><div class="ttdef"><b>Definition</b> gsScaledDirichletPrec.h:90</div></div>
<div class="ttc" id="aclassgismo_1_1gsScaledDirichletPrec_html_acaa221022cd4b0107af70d2e4d354699"><div class="ttname"><a href="classgismo_1_1gsScaledDirichletPrec.html#acaa221022cd4b0107af70d2e4d354699">gismo::gsScaledDirichletPrec::setupMultiplicityScaling</a></div><div class="ttdeci">void setupMultiplicityScaling()</div><div class="ttdoc">This sets up the member vector localScaling based on multiplicity scaling.</div><div class="ttdef"><b>Definition</b> gsScaledDirichletPrec.hpp:149</div></div>
<div class="ttc" id="aclassgismo_1_1gsSparseEntries_html"><div class="ttname"><a href="classgismo_1_1gsSparseEntries.html">gismo::gsSparseEntries</a></div><div class="ttdoc">Class that provides a container for triplets (i,j,value) to be filled in a sparse matrix.</div><div class="ttdef"><b>Definition</b> gsSparseMatrix.h:34</div></div>
<div class="ttc" id="aclassgismo_1_1gsSparseMatrix_html"><div class="ttname"><a href="classgismo_1_1gsSparseMatrix.html">gismo::gsSparseMatrix</a></div><div class="ttdoc">Sparse matrix class, based on gsEigen::SparseMatrix.</div><div class="ttdef"><b>Definition</b> gsSparseMatrix.h:139</div></div>
<div class="ttc" id="aclassgismo_1_1gsSparseMatrix_html_a24da616b328c15186de32aa2c9a51938"><div class="ttname"><a href="classgismo_1_1gsSparseMatrix.html#a24da616b328c15186de32aa2c9a51938">gismo::gsSparseMatrix::moveToPtr</a></div><div class="ttdeci">uPtr moveToPtr()</div><div class="ttdoc">This function returns a smart pointer to the matrix. After calling it, the matrix object becomes empt...</div><div class="ttdef"><b>Definition</b> gsSparseMatrix.h:247</div></div>
<div class="ttc" id="aclassgismo_1_1gsSparseVector_html"><div class="ttname"><a href="classgismo_1_1gsSparseVector.html">gismo::gsSparseVector</a></div><div class="ttdoc">Sparse vector class, based on gsEigen::SparseVector.</div><div class="ttdef"><b>Definition</b> gsSparseVector.h:35</div></div>
<div class="ttc" id="aclassgismo_1_1gsTensorBSpline_html"><div class="ttname"><a href="classgismo_1_1gsTensorBSpline.html">gismo::gsTensorBSpline</a></div><div class="ttdoc">A tensor product of d B-spline functions, with arbitrary target dimension.</div><div class="ttdef"><b>Definition</b> gsTensorBSpline.h:45</div></div>
<div class="ttc" id="aclassgismo_1_1gsTensorNurbs_html"><div class="ttname"><a href="classgismo_1_1gsTensorNurbs.html">gismo::gsTensorNurbs</a></div><div class="ttdoc">A tensor product Non-Uniform Rational B-spline function (NURBS) of parametric dimension d,...</div><div class="ttdef"><b>Definition</b> gsTensorNurbs.h:41</div></div>
<div class="ttc" id="agismo_8h_html"><div class="ttname"><a href="gismo_8h.html">gismo.h</a></div><div class="ttdoc">Main header to be included by clients using the G+Smo library.</div></div>
<div class="ttc" id="agsDebug_8h_html_ad244d2129e4089c7772855461057e0fb"><div class="ttname"><a href="gsDebug_8h.html#ad244d2129e4089c7772855461057e0fb">GISMO_ENSURE</a></div><div class="ttdeci">#define GISMO_ENSURE(cond, message)</div><div class="ttdef"><b>Definition</b> gsDebug.h:102</div></div>
<div class="ttc" id="anamespacegismo_1_1expr_html_a37e91c8b6c3efac383e28a3cb2b5f092"><div class="ttname"><a href="namespacegismo_1_1expr.html#a37e91c8b6c3efac383e28a3cb2b5f092">gismo::expr::meas</a></div><div class="ttdeci">EIGEN_STRONG_INLINE meas_expr&lt; T &gt; meas(const gsGeometryMap&lt; T &gt; &amp;G)</div><div class="ttdoc">The measure of a geometry map.</div><div class="ttdef"><b>Definition</b> gsExpressions.h:4555</div></div>
<div class="ttc" id="anamespacegismo_1_1memory_html_acd7657f8f967050ad973c6f72ef2b588"><div class="ttname"><a href="namespacegismo_1_1memory.html#acd7657f8f967050ad973c6f72ef2b588">gismo::memory::make_unique</a></div><div class="ttdeci">unique_ptr&lt; T &gt; make_unique(T *x)</div><div class="ttdef"><b>Definition</b> gsMemory.h:198</div></div>
<div class="ttc" id="anamespacegismo_html"><div class="ttname"><a href="namespacegismo.html">gismo</a></div><div class="ttdoc">The G+Smo namespace, containing all definitions for the library.</div></div>
<div class="ttc" id="astructgismo_1_1condition__type_html_a7aead736a07eaf25623ad7bfa1f0ee2da1b4f535d1f53363637f933002efc2b4b"><div class="ttname"><a href="structgismo_1_1condition__type.html#a7aead736a07eaf25623ad7bfa1f0ee2da1b4f535d1f53363637f933002efc2b4b">gismo::condition_type::dirichlet</a></div><div class="ttdeci">@ dirichlet</div><div class="ttdoc">Dirichlet type.</div><div class="ttdef"><b>Definition</b> gsBoundaryConditions.h:31</div></div>
<div class="ttc" id="astructgismo_1_1condition__type_html_a7aead736a07eaf25623ad7bfa1f0ee2da8e855db37d5c0fbd8eda96b2f51b8b20"><div class="ttname"><a href="structgismo_1_1condition__type.html#a7aead736a07eaf25623ad7bfa1f0ee2da8e855db37d5c0fbd8eda96b2f51b8b20">gismo::condition_type::neumann</a></div><div class="ttdeci">@ neumann</div><div class="ttdoc">Neumann type.</div><div class="ttdef"><b>Definition</b> gsBoundaryConditions.h:33</div></div>
<div class="ttc" id="astructgismo_1_1gsNurbsCreator_html"><div class="ttname"><a href="structgismo_1_1gsNurbsCreator.html">gismo::gsNurbsCreator</a></div><div class="ttdoc">Class gsNurbsCreator provides some simple examples of Nurbs Geometries.</div><div class="ttdef"><b>Definition</b> gsNurbsCreator.h:37</div></div>
<div class="ttc" id="astructgismo_1_1gsScaledDirichletPrec_1_1Blocks_html"><div class="ttname"><a href="structgismo_1_1gsScaledDirichletPrec_1_1Blocks.html">gismo::gsScaledDirichletPrec::Blocks</a></div><div class="ttdef"><b>Definition</b> gsScaledDirichletPrec.h:148</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Jan 20 2025 09:35:27 for G+Smo by Doxygen v1.9.8 </li>
  </ul>
</div>
<!-- Piwik --> 
<!--
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? "https://stats.sylphide-consulting.com/piwik/" : "http://stats.sylphide-consulting.com/piwik/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 20);
piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
</script><noscript><p><img src="http://stats.sylphide-consulting.com/piwik/piwik.php?idsite=20" style="border:0" alt="" /></p></noscript>
-->
<!-- End Piwik Tracking Code -->
</body>
</html>

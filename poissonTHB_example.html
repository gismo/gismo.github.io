<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<title>G+Smo: poissonTHB_example.cpp</title>
<link href="gismodoxy_tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://people.ricam.oeaw.ac.at/gismo/mj/MathJax.js"></script>
<link href="doxygen.css"   rel="stylesheet" type="text/css" />
<link href="gismodoxy.css" rel="stylesheet" type="text/css">
<!--  -->
<!-- <script type="text/javascript"> -->
<!-- </script> -->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- <a name="top"></a> -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="gslogo-doxy.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname"><a href="index.html"><font style="font-variant:small-caps;">G+S</font><font style="font-variant:small-caps;"
															    color="#000000">mo</font></a>
   &#160;<span id="projectnumber">25.01.0</span>
   </div>
   <div id="projectbrief">Geometry + Simulation Modules</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('poissonTHB_example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">poissonTHB_example.cpp</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>More details on the hierarchical splines can be found in <a class="el" href="thbSplineBasis_example.html">thbSplineBasis_example.cpp</a>, <a class="el" href="adaptRefinementThb_example.html">adaptRefinementThb_example.cpp</a> as well as in the <a class="el" href="group__HSplines.html">Hierarchical splines module</a> description.</p>
<h1><a class="anchor" id="poisson_exampleThbAnnotated"></a>
Annotated source file</h1>
<p>Here is the full file <code>examples/poissonTHB_example.cpp</code>. Clicking on a function or class name will lead you to its reference documentation.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="gismo_8h.html">gismo.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="gsAdaptiveRefUtils_8h.html">gsAssembler/gsAdaptiveRefUtils.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacegismo.html">gismo</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">//S.Kleiss</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//This is a test example for a illustrating the adaptive</span></div>
<div class="line"><span class="comment">//refinement procedure implemented in the gsPoissonAssembler</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//Flags, parameters, geometry and prescribed exact solution</span></div>
<div class="line"><span class="comment">//are specified within the main() function</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Number of initial uniform mesh refinements</span></div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> initUnifRef;</div>
<div class="line">    <span class="comment">// Number of adaptive refinement loops</span></div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> RefineLoopMax;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Flag for refinemet criterion</span></div>
<div class="line">    <span class="comment">// (see doxygen documentation of the free function</span></div>
<div class="line">    <span class="comment">// gsMarkElementsForRef explanation)</span></div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> refCriterion;   <span class="comment">// MarkingStrategy</span></div>
<div class="line">    <span class="comment">// Parameter for computing adaptive refinement threshold</span></div>
<div class="line">    <span class="comment">// (see doxygen documentation of the free function</span></div>
<div class="line">    <span class="comment">// gsMarkElementsForRef explanation)</span></div>
<div class="line">    real_t refParameter;  <span class="comment">// ...specified below with the examples</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Degree to use for discretization</span></div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> degree;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Flag whether final mesh should be plotted in ParaView</span></div>
<div class="line">    <span class="keywordtype">bool</span> plot = <span class="keyword">false</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> manual = <span class="keyword">false</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> HB = <span class="keyword">false</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> dump;</div>
<div class="line"> </div>
<div class="line">    RefineLoopMax = 2;</div>
<div class="line">    initUnifRef = 2;</div>
<div class="line">    degree = 2;</div>
<div class="line">    refCriterion = PUCA;</div>
<div class="line">    refParameter = 0.85;</div>
<div class="line">    dump = <span class="keyword">false</span>;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> refExt = 0;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsCmdLine.html">gsCmdLine</a> cmd(<span class="stringliteral">&quot;Solving a PDE with adaptive refinement using THB-splines.&quot;</span>);</div>
<div class="line">    cmd.addSwitch(<span class="stringliteral">&quot;plot&quot;</span>, <span class="stringliteral">&quot;Plot resulting mesh in ParaView&quot;</span>, plot);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;r&quot;</span>, <span class="stringliteral">&quot;refine&quot;</span>, <span class="stringliteral">&quot;Maximum number of adaptive refinement steps to perform&quot;</span>,</div>
<div class="line">            RefineLoopMax);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;i&quot;</span>, <span class="stringliteral">&quot;initial-ref&quot;</span>, <span class="stringliteral">&quot;Initial number of uniform refinement steps to perform&quot;</span>,</div>
<div class="line">            initUnifRef);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;degree&quot;</span>, <span class="stringliteral">&quot;Spline degree of the THB basis&quot;</span>, degree);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;criterion&quot;</span>,  <span class="stringliteral">&quot;Criterion to be used for adaptive refinement (1-3, see documentation)&quot;</span>,</div>
<div class="line">            refCriterion);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;E&quot;</span>, <span class="stringliteral">&quot;extension&quot;</span>,  <span class="stringliteral">&quot;Criterion to be used for adaptive refinement (1-3, see documentation)&quot;</span>,</div>
<div class="line">            refExt);</div>
<div class="line">    cmd.addReal(<span class="stringliteral">&quot;p&quot;</span>, <span class="stringliteral">&quot;parameter&quot;</span>, <span class="stringliteral">&quot;Parameter for adaptive refinement&quot;</span>, refParameter);</div>
<div class="line">    cmd.addSwitch(<span class="stringliteral">&quot;dump&quot;</span>, <span class="stringliteral">&quot;Write geometry and sequence of bases into XML files&quot;</span>,</div>
<div class="line">                dump);</div>
<div class="line">    cmd.addSwitch(<span class="stringliteral">&quot;manual&quot;</span>, <span class="stringliteral">&quot;Uses the &#39;addLevel&#39; feature of the THB basis, where levels can be specified manually&quot;</span>, manual);</div>
<div class="line">    cmd.addSwitch(<span class="stringliteral">&quot;HB&quot;</span>, <span class="stringliteral">&quot;Uses a Hierarchical basis instead of a Truncated Hierarchical basis&quot;</span>, HB);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">try</span> { cmd.getValues(argc,argv); } <span class="keywordflow">catch</span> (<span class="keywordtype">int</span> rv) { <span class="keywordflow">return</span> rv; }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// ****** Prepared test examples ******</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// f       ... source term</span></div>
<div class="line">    <span class="comment">// g       ... exact solution</span></div>
<div class="line">    <span class="comment">// patches ... the computational domain given as object of gsMultiPatch</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="comment">// ------ Example 1 ------</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// --- Unit square, with a spike of the source function at (0.25, 0.6)</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>  f(<span class="stringliteral">&quot;if( (x-0.25)^2 + (y-0.6)^2 &lt; 0.2^2, 1, 0 )&quot;</span>,2);</div>
<div class="line">    <span class="comment">//gsFunctionExpr&lt;&gt;  f(&quot;if( (x-0.25)^2 + (y-1.6)^2 &lt; 0.2^2, 1, 0 )&quot;,2);</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>  g(<span class="stringliteral">&quot;0&quot;</span>,2);</div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch&lt;&gt;</a> patches( *<a class="code hl_struct" href="structgismo_1_1gsNurbsCreator.html">gsNurbsCreator&lt;&gt;::BSplineRectangle</a>(0.0,0.0,2.0,1.0) );</div>
<div class="line">    <span class="comment">//gsMultiPatch&lt;&gt; patches( *gsNurbsCreator&lt;&gt;::BSplineFatQuarterAnnulus(1.0, 2.0) );</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">//RefineLoopMax = 6;</span></div>
<div class="line">    <span class="comment">//refParameter = 0.6;</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// ^^^^^^ Example 1 ^^^^^^</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">    // ------ Example 2 ------</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    // The classical example associated with the L-Shaped domain.</span></div>
<div class="line"><span class="comment">    // The exact solution has a singularity at the re-entrant corner at the origin.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    gsFunctionExpr&lt;&gt;  f(&quot;0&quot;,2);</span></div>
<div class="line"><span class="comment">    gsFunctionExpr&lt;&gt;  g(&quot;if( y&gt;0, ( (x^2+y^2)^(1.0/3.0) )*sin( (2*atan2(y,x) - pi)/3.0 ), ( (x^2+y^2)^(1.0/3.0) )*sin( (2*atan2(y,x) +3*pi)/3.0 ) )&quot;,2);</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    //gsMultiPatch&lt;&gt; patches (*gsNurbsCreator&lt;&gt;::BSplineLShape_p2C0());</span></div>
<div class="line"><span class="comment">    gsMultiPatch&lt;&gt; patches (*gsNurbsCreator&lt;&gt;::BSplineLShape_p1());</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    //RefineLoopMax = 8;</span></div>
<div class="line"><span class="comment">    //refParameter = 0.85;</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    // ^^^^^^ Example 2 ^^^^^^</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;Source function &quot;</span>&lt;&lt; f &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;Exact solution &quot;</span>&lt;&lt; g &lt;&lt;<span class="stringliteral">&quot;.\n&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Define Boundary conditions</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsBoundaryConditions.html">gsBoundaryConditions&lt;&gt;</a> bcInfo;</div>
<div class="line">    <span class="comment">// Dirichlet BCs</span></div>
<div class="line">    bcInfo.<a class="code hl_function" href="classgismo_1_1gsBoundaryConditions.html#a1dd0c4f4cdae8082d37db999fc3932d2">addCondition</a>( boundary::west,  <a class="code hl_enumvalue" href="structgismo_1_1condition__type.html#a7aead736a07eaf25623ad7bfa1f0ee2da1b4f535d1f53363637f933002efc2b4b">condition_type::dirichlet</a>, &amp;g );</div>
<div class="line">    bcInfo.<a class="code hl_function" href="classgismo_1_1gsBoundaryConditions.html#a1dd0c4f4cdae8082d37db999fc3932d2">addCondition</a>( boundary::east,  <a class="code hl_enumvalue" href="structgismo_1_1condition__type.html#a7aead736a07eaf25623ad7bfa1f0ee2da1b4f535d1f53363637f933002efc2b4b">condition_type::dirichlet</a>, &amp;g );</div>
<div class="line">    bcInfo.<a class="code hl_function" href="classgismo_1_1gsBoundaryConditions.html#a1dd0c4f4cdae8082d37db999fc3932d2">addCondition</a>( boundary::north, <a class="code hl_enumvalue" href="structgismo_1_1condition__type.html#a7aead736a07eaf25623ad7bfa1f0ee2da1b4f535d1f53363637f933002efc2b4b">condition_type::dirichlet</a>, &amp;g );</div>
<div class="line">    bcInfo.<a class="code hl_function" href="classgismo_1_1gsBoundaryConditions.html#a1dd0c4f4cdae8082d37db999fc3932d2">addCondition</a>( boundary::south, <a class="code hl_enumvalue" href="structgismo_1_1condition__type.html#a7aead736a07eaf25623ad7bfa1f0ee2da1b4f535d1f53363637f933002efc2b4b">condition_type::dirichlet</a>, &amp;g );</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsTensorBSpline.html">gsTensorBSpline&lt;2,real_t&gt;</a> * geo = <span class="keyword">dynamic_cast&lt;</span> <a class="code hl_class" href="classgismo_1_1gsTensorBSpline.html">gsTensorBSpline&lt;2,real_t&gt;</a> * <span class="keyword">&gt;</span>( &amp; patches.patch(0) );</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot; --- Geometry:\n&quot;</span> &lt;&lt; *geo &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Number of patches: &quot;</span> &lt;&lt; patches.nPatches() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (dump)</div>
<div class="line">        <a class="code hl_function" href="namespacegismo.html#a709bf9361d5a1834a96d598b9661b165">gsWrite</a>(*geo, <span class="stringliteral">&quot;adapt_geo.xml&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsTensorBSplineBasis.html">gsTensorBSplineBasis&lt;2,real_t&gt;</a> tbb = geo-&gt;<a class="code hl_function" href="classgismo_1_1gsGeometry.html#aa85850cca87511716534e0058c8afe30">basis</a>();</div>
<div class="line">    tbb.<a class="code hl_function" href="classgismo_1_1gsBasis.html#a96f2f01f12017527563250a7c5ae77a6">setDegree</a>(degree);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;\nCoarse discretization basis:\n&quot;</span> &lt;&lt; tbb &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// With this gsTensorBSplineBasis, it&#39;s possible to call the THB-Spline constructor</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsHTensorBasis.html">gsHTensorBasis&lt;2,real_t&gt;</a> * HTB;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; initUnifRef; ++i)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (manual)</div>
<div class="line">            tbb.uniformRefine(1,1);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            tbb.uniformRefine();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (manual)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Manual creation of levels in THB hierarchy</span></div>
<div class="line">        <span class="comment">// We create a hierarchy where in the first degree levels, the basis is refined and the continuity is reduced</span></div>
<div class="line">        <span class="comment">// Then diadic refinements are created</span></div>
<div class="line">        <span class="comment">// lvl 0: {0, 0, 0, 0, 0.25, 0.5, 0.75, 1, 1, 1, 1}</span></div>
<div class="line">        <span class="comment">// lvl 1: {0, 0, 0, 0, 0.125, 0.125, 0.25, 0.25, 0.375, 0.375, 0.5, 0.5, 0.625, 0.625, 0.75, 0.75, 0.825, 0.825, 1, 1, 1, 1}</span></div>
<div class="line">        <span class="comment">// lvl 2: {0, 0, 0, 0, 0.0625, 0.0625, 0.0625, 0.125, 0.125, 0.125, ...}</span></div>
<div class="line">        <span class="comment">// lvl 3: {0, 0, 0, 0, 0.0625, 0.0625, 0.0625, 0.125, 0.125, 0.125, ...}</span></div>
<div class="line">        <span class="comment">// etc</span></div>
<div class="line">        <span class="keywordflow">if</span> (HB)</div>
<div class="line">            HTB = <span class="keyword">new</span> <a class="code hl_class" href="classgismo_1_1gsHBSplineBasis.html">gsHBSplineBasis&lt;2,real_t&gt;</a>(tbb,<span class="keyword">true</span>);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            HTB = <span class="keyword">new</span> <a class="code hl_class" href="classgismo_1_1gsTHBSplineBasis.html">gsTHBSplineBasis&lt;2,real_t&gt;</a>(tbb,<span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> k=0; k!=degree-2; k++)</div>
<div class="line">        {</div>
<div class="line">            tbb.uniformRefine(1,k+1);</div>
<div class="line">            tbb.reduceContinuity(1);</div>
<div class="line">            tbb.removeKnot(0.5,0,1);</div>
<div class="line">            HTB-&gt;<a class="code hl_function" href="classgismo_1_1gsHTensorBasis.html#a7694eb375fb286f73341ea37d0b4d3d7">addLevel</a>(tbb);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> k=0; k!=5; k++)</div>
<div class="line">        {</div>
<div class="line">            tbb.uniformRefine(1,degree-1);</div>
<div class="line">            HTB-&gt;<a class="code hl_function" href="classgismo_1_1gsHTensorBasis.html#a7694eb375fb286f73341ea37d0b4d3d7">addLevel</a>(tbb);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// This works    </span></div>
<div class="line">        <span class="comment">//{</span></div>
<div class="line">        <span class="comment">// for (index_t k=0; k!=3; k++)</span></div>
<div class="line">        <span class="comment">// {</span></div>
<div class="line">        <span class="comment">//     tbb.uniformRefine(1,2);</span></div>
<div class="line">        <span class="comment">//     gsDebugVar(gsAsConstVector&lt;index_t&gt;(tbb.knots(0).multiplicities()));</span></div>
<div class="line">        <span class="comment">//     gsDebugVar(tbb.knots(0).asMatrix());</span></div>
<div class="line">        <span class="comment">//     HTB-&gt;addLevel(tbb);</span></div>
<div class="line">        <span class="comment">// }</span></div>
<div class="line">        <span class="comment">//}</span></div>
<div class="line"> </div>
<div class="line">        HTB-&gt;<a class="code hl_function" href="classgismo_1_1gsHTensorBasis.html#a6985d152b8030c3b2476e1ed3b546320">printBases</a>();</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (HB)</div>
<div class="line">            HTB = <span class="keyword">new</span> <a class="code hl_class" href="classgismo_1_1gsHBSplineBasis.html">gsHBSplineBasis&lt;2,real_t&gt;</a>(tbb,<span class="keyword">false</span>);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            HTB = <span class="keyword">new</span> <a class="code hl_class" href="classgismo_1_1gsTHBSplineBasis.html">gsTHBSplineBasis&lt;2,real_t&gt;</a>(tbb,<span class="keyword">false</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a> boxes(2,2);</div>
<div class="line">    boxes.row(0)&lt;&lt;0.25,0.75;</div>
<div class="line">    boxes.row(1)&lt;&lt;0.00,1.00;</div>
<div class="line">    HTB-&gt;<a class="code hl_function" href="classgismo_1_1gsHTensorBasis.html#a3d23d10ae01570be0a326d9478868228">refine</a>(boxes);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Finally, create a vector (of length one) of this gsTHBSplineBasis</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsMultiBasis.html">gsMultiBasis&lt;real_t&gt;</a> bases(*HTB);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch&lt;&gt;</a> mpsol; <span class="comment">// holds computed solution</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsPoissonAssembler.html">gsPoissonAssembler&lt;real_t&gt;</a> pa(patches,bases,bcInfo,f);<span class="comment">// constructs matrix and rhs</span></div>
<div class="line">    pa.options().setInt(<span class="stringliteral">&quot;DirichletValues&quot;</span>, dirichlet::l2Projection);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (dump)</div>
<div class="line">        <a class="code hl_function" href="namespacegismo.html#a709bf9361d5a1834a96d598b9661b165">gsWrite</a>(bases[0], <span class="stringliteral">&quot;adapt_basis_0.xml&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// So, ready to start the adaptive refinement loop:</span></div>
<div class="line">    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> RefineLoop = 1; RefineLoop &lt;= RefineLoopMax ; RefineLoop++ )</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;\n============================== Loop &quot;</span> &lt;&lt; RefineLoop &lt;&lt; <span class="stringliteral">&quot; of &quot;</span> &lt;&lt; RefineLoopMax &lt;&lt; <span class="stringliteral">&quot; ==============================&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsHTensorBasis.html">gsHTensorBasis&lt;2,real_t&gt;</a> * HTB_tmp = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="classgismo_1_1gsHTensorBasis.html">gsHTensorBasis&lt;2,real_t&gt;</a> * <span class="keyword">&gt;</span>(&amp;pa.multiBasis().basis(0));</div>
<div class="line">        <span class="keywordtype">bool</span> unity = HTB_tmp-&gt;<a class="code hl_function" href="classgismo_1_1gsHTensorBasis.html#a7c2cf86deef84437066644ab87b411b8">testPartitionOfUnity</a>();</div>
<div class="line">        std::string unity_string = unity ? <span class="stringliteral">&quot;has &quot;</span> : <span class="stringliteral">&quot;does not have &quot;</span>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot; * Number of elements:  &quot;</span>&lt;&lt;HTB_tmp-&gt;<a class="code hl_function" href="classgismo_1_1gsHTensorBasis.html#ad4320b6cc58371c74186c737d6607447">numElements</a>()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot; * Maximum level:       &quot;</span>&lt;&lt;HTB_tmp-&gt;<a class="code hl_function" href="classgismo_1_1gsHTensorBasis.html#a7f64dee695cac546f8ae64cc2cbe48bf">maxLevel</a>()+1&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot; * Tree size:           &quot;</span>&lt;&lt;HTB_tmp-&gt;<a class="code hl_function" href="classgismo_1_1gsHTensorBasis.html#a16123c99fabc0ab06a809a5bebb17860">treeSize</a>()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot; * Number of functions: &quot;</span>&lt;&lt;HTB_tmp-&gt;<a class="code hl_function" href="classgismo_1_1gsHTensorBasis.html#a7b678238a21dd0a25a3d8a67c11abb45">size</a>()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot; * Size per level:      &quot;</span>;</div>
<div class="line">        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i&lt;= HTB_tmp-&gt;<a class="code hl_function" href="classgismo_1_1gsHTensorBasis.html#a7f64dee695cac546f8ae64cc2cbe48bf">maxLevel</a>(); i++)</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; HTB_tmp-&gt;getXmatrix()[i].size()&lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot; * Partition of unity:  The basis &quot;</span>&lt;&lt;unity_string&lt;&lt;<span class="stringliteral">&quot;the partition of unity property\n&quot;</span>;</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;=========================================================================\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Assemble matrix and rhs</span></div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Assembling... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line">        pa.assemble();</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done.&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Solve system</span></div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Solving... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a> solVector = gsSparseSolver&lt;&gt;::CGDiagonal(pa.matrix() ).solve( pa.rhs() );</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done.&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Construct the solution for plotting the mesh later</span></div>
<div class="line">        pa.constructSolution(solVector, mpsol);</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsField.html">gsField&lt;&gt;</a> sol(pa.patches(), mpsol);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Set up and compute the L2-error to the known exact solution...</span></div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsExprEvaluator.html">gsExprEvaluator&lt;&gt;</a> ev;</div>
<div class="line">        ev.<a class="code hl_function" href="classgismo_1_1gsExprEvaluator.html#a0ec66d534b5822bf6f68607c69af9c33">setIntegrationElements</a>(pa.multiBasis());</div>
<div class="line">        gsExprEvaluator&lt;&gt;::geometryMap Gm = ev.<a class="code hl_function" href="classgismo_1_1gsExprEvaluator.html#acd8fe15286df0845bdce1e8689908304">getMap</a>(patches);</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1expr_1_1gsFeVariable.html">gsExprEvaluator&lt;&gt;::variable</a> f1 = ev.<a class="code hl_function" href="classgismo_1_1gsExprEvaluator.html#ac146357502c87ba4fe61a7fddf63c86d">getVariable</a>(mpsol);</div>
<div class="line">        <span class="keyword">auto</span> ff = ev.<a class="code hl_function" href="classgismo_1_1gsExprEvaluator.html#ac146357502c87ba4fe61a7fddf63c86d">getVariable</a>(f, Gm);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// The vector with element-wise local error estimates.</span></div>
<div class="line">        ev.<a class="code hl_function" href="classgismo_1_1gsExprEvaluator.html#a465bfc4ca998bdb2717d09465a3bfb4e">integralElWise</a>( (ilapl(f1,Gm) + ff).sqNorm() * <a class="code hl_function" href="namespacegismo_1_1expr.html#a37e91c8b6c3efac383e28a3cb2b5f092">meas</a>(Gm) );</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;real_t&gt; &amp; elErrEst = ev.<a class="code hl_function" href="classgismo_1_1gsExprEvaluator.html#a33f9c828d5c44f05ecffe0f3eaea31da">elementwise</a>();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Get the vector with element-wise local (known in this case) errors...</span></div>
<div class="line">        <span class="comment">//gsExprEvaluator&lt;&gt;::variable gg = ev.getVariable(g, Gm);</span></div>
<div class="line">        <span class="comment">//ev.integralElWise( (f1 - gg).sqNorm() * meas(Gm) );</span></div>
<div class="line">        <span class="comment">//const std::vector&lt;real_t&gt; &amp; elErrEst = ev.elementwise();</span></div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Mark elements for refinement, based on the computed local errors and</span></div>
<div class="line">        <span class="comment">// refCriterion and refParameter.</span></div>
<div class="line">        std::vector&lt;bool&gt; elMarked( elErrEst.size() );</div>
<div class="line">        <a class="code hl_function" href="group__Assembler.html#ga01b4eb9039518258e67fa541adbc5fd1">gsMarkElementsForRef</a>( elErrEst, refCriterion, refParameter, elMarked);</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt;<span class="stringliteral">&quot;Marked &quot;</span>&lt;&lt; std::count(elMarked.begin(), elMarked.end(), <span class="keyword">true</span>)&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Refine the elements of the mesh, based on elMarked.</span></div>
<div class="line">        <a class="code hl_function" href="group__Assembler.html#ga33738199285ae0ea097c96b9c572d786">gsRefineMarkedElements</a>( pa.multiBasis(), elMarked, refExt);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Refresh the assembler, since basis is now changed</span></div>
<div class="line">        pa.refresh();</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (dump)</div>
<div class="line">        {</div>
<div class="line">            std::stringstream ss;</div>
<div class="line">            ss &lt;&lt; <span class="stringliteral">&quot;adapt_basis_&quot;</span> &lt;&lt; RefineLoop &lt;&lt; <span class="stringliteral">&quot;.xml&quot;</span>;</div>
<div class="line">            <a class="code hl_function" href="namespacegismo.html#a709bf9361d5a1834a96d598b9661b165">gsWrite</a>(pa.multiBasis()[0], ss.str());</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ( (RefineLoop == RefineLoopMax) &amp;&amp; plot)</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// Write approximate solution to paraview files</span></div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;Plotting in Paraview...\n&quot;</span>;</div>
<div class="line">            gsWriteParaview&lt;&gt;(sol, <span class="stringliteral">&quot;p2d_adaRef_sol&quot;</span>, 5001, <span class="keyword">true</span>);</div>
<div class="line">            gsWriteParaview&lt;&gt;(pa.multiBasis()[0], <span class="stringliteral">&quot;basis&quot;</span>, 500, <span class="keyword">true</span>);</div>
<div class="line">            <span class="comment">// Run paraview and plot the last mesh</span></div>
<div class="line">            <a class="code hl_function" href="classgismo_1_1gsFileManager.html#a0f725eecb78d3bc1f482326cb9e85eee">gsFileManager::open</a>(<span class="stringliteral">&quot;p2d_adaRef_sol.pvd&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;\nFinal basis: &quot;</span> &lt;&lt; pa.multiBasis()[0] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">delete</span> HTB;</div>
<div class="line">    <span class="keywordflow">return</span> EXIT_SUCCESS;</div>
<div class="line">}</div>
<div class="ttc" id="aclassgismo_1_1expr_1_1gsFeVariable_html"><div class="ttname"><a href="classgismo_1_1expr_1_1gsFeVariable.html">gismo::expr::gsFeVariable</a></div><div class="ttdef"><b>Definition</b> gsExpressions.h:928</div></div>
<div class="ttc" id="aclassgismo_1_1gsBasis_html_a96f2f01f12017527563250a7c5ae77a6"><div class="ttname"><a href="classgismo_1_1gsBasis.html#a96f2f01f12017527563250a7c5ae77a6">gismo::gsBasis::setDegree</a></div><div class="ttdeci">void setDegree(short_t const &amp;i)</div><div class="ttdoc">Set the degree of the basis (either elevate or reduce) in order to have degree equal to i wrt to each...</div><div class="ttdef"><b>Definition</b> gsBasis.hpp:645</div></div>
<div class="ttc" id="aclassgismo_1_1gsBoundaryConditions_html"><div class="ttname"><a href="classgismo_1_1gsBoundaryConditions.html">gismo::gsBoundaryConditions</a></div><div class="ttdoc">Class containing a set of boundary conditions.</div><div class="ttdef"><b>Definition</b> gsBoundaryConditions.h:342</div></div>
<div class="ttc" id="aclassgismo_1_1gsBoundaryConditions_html_a1dd0c4f4cdae8082d37db999fc3932d2"><div class="ttname"><a href="classgismo_1_1gsBoundaryConditions.html#a1dd0c4f4cdae8082d37db999fc3932d2">gismo::gsBoundaryConditions::addCondition</a></div><div class="ttdeci">void addCondition(int p, boxSide s, condition_type::type t, gsFunctionSet&lt; T &gt; *f, short_t unknown=0, bool parametric=false, int comp=-1)</div><div class="ttdoc">Adds another boundary condition.</div><div class="ttdef"><b>Definition</b> gsBoundaryConditions.h:650</div></div>
<div class="ttc" id="aclassgismo_1_1gsCmdLine_html"><div class="ttname"><a href="classgismo_1_1gsCmdLine.html">gismo::gsCmdLine</a></div><div class="ttdoc">Class for command-line argument parsing.</div><div class="ttdef"><b>Definition</b> gsCmdLine.h:57</div></div>
<div class="ttc" id="aclassgismo_1_1gsExprEvaluator_html"><div class="ttname"><a href="classgismo_1_1gsExprEvaluator.html">gismo::gsExprEvaluator</a></div><div class="ttdoc">Generic evaluator of isogeometric expressions.</div><div class="ttdef"><b>Definition</b> gsExprEvaluator.h:39</div></div>
<div class="ttc" id="aclassgismo_1_1gsExprEvaluator_html_a0ec66d534b5822bf6f68607c69af9c33"><div class="ttname"><a href="classgismo_1_1gsExprEvaluator.html#a0ec66d534b5822bf6f68607c69af9c33">gismo::gsExprEvaluator::setIntegrationElements</a></div><div class="ttdeci">void setIntegrationElements(const gsMultiBasis&lt; T &gt; &amp;mesh)</div><div class="ttdoc">Sets the domain of integration.</div><div class="ttdef"><b>Definition</b> gsExprEvaluator.h:110</div></div>
<div class="ttc" id="aclassgismo_1_1gsExprEvaluator_html_a33f9c828d5c44f05ecffe0f3eaea31da"><div class="ttname"><a href="classgismo_1_1gsExprEvaluator.html#a33f9c828d5c44f05ecffe0f3eaea31da">gismo::gsExprEvaluator::elementwise</a></div><div class="ttdeci">const std::vector&lt; T &gt; &amp; elementwise() const</div><div class="ttdoc">Returns an std::vector containing the last computed values per element.</div><div class="ttdef"><b>Definition</b> gsExprEvaluator.h:99</div></div>
<div class="ttc" id="aclassgismo_1_1gsExprEvaluator_html_a465bfc4ca998bdb2717d09465a3bfb4e"><div class="ttname"><a href="classgismo_1_1gsExprEvaluator.html#a465bfc4ca998bdb2717d09465a3bfb4e">gismo::gsExprEvaluator::integralElWise</a></div><div class="ttdeci">T integralElWise(const expr::_expr&lt; E &gt; &amp;expr)</div><div class="ttdoc">Calculates the integral of the expression expr on each element.</div><div class="ttdef"><b>Definition</b> gsExprEvaluator.h:159</div></div>
<div class="ttc" id="aclassgismo_1_1gsExprEvaluator_html_ac146357502c87ba4fe61a7fddf63c86d"><div class="ttname"><a href="classgismo_1_1gsExprEvaluator.html#ac146357502c87ba4fe61a7fddf63c86d">gismo::gsExprEvaluator::getVariable</a></div><div class="ttdeci">variable getVariable(const gsFunctionSet&lt; T &gt; &amp;func, index_t dim=1)</div><div class="ttdoc">Registers func as a variable and returns a handle to it.</div><div class="ttdef"><b>Definition</b> gsExprEvaluator.h:124</div></div>
<div class="ttc" id="aclassgismo_1_1gsExprEvaluator_html_acd8fe15286df0845bdce1e8689908304"><div class="ttname"><a href="classgismo_1_1gsExprEvaluator.html#acd8fe15286df0845bdce1e8689908304">gismo::gsExprEvaluator::getMap</a></div><div class="ttdeci">geometryMap getMap(const gsMultiPatch&lt; T &gt; &amp;mp)</div><div class="ttdoc">Registers mp as an isogeometric geometry map and return a handle to it.</div><div class="ttdef"><b>Definition</b> gsExprEvaluator.h:116</div></div>
<div class="ttc" id="aclassgismo_1_1gsField_html"><div class="ttname"><a href="classgismo_1_1gsField.html">gismo::gsField</a></div><div class="ttdoc">A scalar of vector field defined on a m_parametric geometry.</div><div class="ttdef"><b>Definition</b> gsField.h:55</div></div>
<div class="ttc" id="aclassgismo_1_1gsFileManager_html_a0f725eecb78d3bc1f482326cb9e85eee"><div class="ttname"><a href="classgismo_1_1gsFileManager.html#a0f725eecb78d3bc1f482326cb9e85eee">gismo::gsFileManager::open</a></div><div class="ttdeci">static void open(const std::string &amp;fn)</div><div class="ttdoc">Opens the file fn using the preferred application of the OS.</div><div class="ttdef"><b>Definition</b> gsFileManager.cpp:688</div></div>
<div class="ttc" id="aclassgismo_1_1gsFunctionExpr_html"><div class="ttname"><a href="classgismo_1_1gsFunctionExpr.html">gismo::gsFunctionExpr</a></div><div class="ttdoc">Class defining a multivariate (real or vector) function given by a string mathematical expression.</div><div class="ttdef"><b>Definition</b> gsFunctionExpr.h:52</div></div>
<div class="ttc" id="aclassgismo_1_1gsGeometry_html_aa85850cca87511716534e0058c8afe30"><div class="ttname"><a href="classgismo_1_1gsGeometry.html#aa85850cca87511716534e0058c8afe30">gismo::gsGeometry::basis</a></div><div class="ttdeci">virtual const gsBasis&lt; T &gt; &amp; basis() const =0</div><div class="ttdoc">Returns a const reference to the basis of the geometry.</div></div>
<div class="ttc" id="aclassgismo_1_1gsHBSplineBasis_html"><div class="ttname"><a href="classgismo_1_1gsHBSplineBasis.html">gismo::gsHBSplineBasis</a></div><div class="ttdoc">A hierarchical B-spline basis of parametric dimension d.</div><div class="ttdef"><b>Definition</b> gsHBSplineBasis.h:36</div></div>
<div class="ttc" id="aclassgismo_1_1gsHTensorBasis_html"><div class="ttname"><a href="classgismo_1_1gsHTensorBasis.html">gismo::gsHTensorBasis</a></div><div class="ttdoc">Class representing a (scalar) hierarchical tensor basis of functions .</div><div class="ttdef"><b>Definition</b> gsHTensorBasis.h:75</div></div>
<div class="ttc" id="aclassgismo_1_1gsHTensorBasis_html_a16123c99fabc0ab06a809a5bebb17860"><div class="ttname"><a href="classgismo_1_1gsHTensorBasis.html#a16123c99fabc0ab06a809a5bebb17860">gismo::gsHTensorBasis::treeSize</a></div><div class="ttdeci">int treeSize() const</div><div class="ttdoc">The number of nodes in the tree representation.</div><div class="ttdef"><b>Definition</b> gsHTensorBasis.h:647</div></div>
<div class="ttc" id="aclassgismo_1_1gsHTensorBasis_html_a3d23d10ae01570be0a326d9478868228"><div class="ttname"><a href="classgismo_1_1gsHTensorBasis.html#a3d23d10ae01570be0a326d9478868228">gismo::gsHTensorBasis::refine</a></div><div class="ttdeci">virtual void refine(gsMatrix&lt; T &gt; const &amp;boxes, int refExt)</div><div class="ttdoc">Refine the basis to levels and in the areas defined by boxes with an extension.</div><div class="ttdef"><b>Definition</b> gsHTensorBasis.hpp:445</div></div>
<div class="ttc" id="aclassgismo_1_1gsHTensorBasis_html_a6985d152b8030c3b2476e1ed3b546320"><div class="ttname"><a href="classgismo_1_1gsHTensorBasis.html#a6985d152b8030c3b2476e1ed3b546320">gismo::gsHTensorBasis::printBases</a></div><div class="ttdeci">void printBases(std::ostream &amp;os=gsInfo) const</div><div class="ttdoc">Prints the spline-space hierarchy.</div><div class="ttdef"><b>Definition</b> gsHTensorBasis.h:542</div></div>
<div class="ttc" id="aclassgismo_1_1gsHTensorBasis_html_a7694eb375fb286f73341ea37d0b4d3d7"><div class="ttname"><a href="classgismo_1_1gsHTensorBasis.html#a7694eb375fb286f73341ea37d0b4d3d7">gismo::gsHTensorBasis::addLevel</a></div><div class="ttdeci">void addLevel(const gsTensorBSplineBasis&lt; d, T &gt; &amp;next_basis)</div><div class="ttdoc">Adds a level, only if manual levels are activated.</div><div class="ttdef"><b>Definition</b> gsHTensorBasis.hpp:35</div></div>
<div class="ttc" id="aclassgismo_1_1gsHTensorBasis_html_a7b678238a21dd0a25a3d8a67c11abb45"><div class="ttname"><a href="classgismo_1_1gsHTensorBasis.html#a7b678238a21dd0a25a3d8a67c11abb45">gismo::gsHTensorBasis::size</a></div><div class="ttdeci">index_t size() const</div><div class="ttdoc">The number of basis functions in this basis.</div><div class="ttdef"><b>Definition</b> gsHTensorBasis.hpp:298</div></div>
<div class="ttc" id="aclassgismo_1_1gsHTensorBasis_html_a7c2cf86deef84437066644ab87b411b8"><div class="ttname"><a href="classgismo_1_1gsHTensorBasis.html#a7c2cf86deef84437066644ab87b411b8">gismo::gsHTensorBasis::testPartitionOfUnity</a></div><div class="ttdeci">bool testPartitionOfUnity(const index_t npts=100, const T tol=1e-12) const</div><div class="ttdoc">Test the partition of unity.</div><div class="ttdef"><b>Definition</b> gsHTensorBasis.hpp:1972</div></div>
<div class="ttc" id="aclassgismo_1_1gsHTensorBasis_html_a7f64dee695cac546f8ae64cc2cbe48bf"><div class="ttname"><a href="classgismo_1_1gsHTensorBasis.html#a7f64dee695cac546f8ae64cc2cbe48bf">gismo::gsHTensorBasis::maxLevel</a></div><div class="ttdeci">unsigned maxLevel() const</div><div class="ttdoc">Returns the level in which the indices are stored internally.</div><div class="ttdef"><b>Definition</b> gsHTensorBasis.h:811</div></div>
<div class="ttc" id="aclassgismo_1_1gsHTensorBasis_html_ad4320b6cc58371c74186c737d6607447"><div class="ttname"><a href="classgismo_1_1gsHTensorBasis.html#ad4320b6cc58371c74186c737d6607447">gismo::gsHTensorBasis::numElements</a></div><div class="ttdeci">size_t numElements(boxSide const &amp;s=0) const</div><div class="ttdoc">The number of elements on side s.</div><div class="ttdef"><b>Definition</b> gsHTensorBasis.h:972</div></div>
<div class="ttc" id="aclassgismo_1_1gsMatrix_html"><div class="ttname"><a href="classgismo_1_1gsMatrix.html">gismo::gsMatrix</a></div><div class="ttdoc">A matrix with arbitrary coefficient type and fixed or dynamic size.</div><div class="ttdef"><b>Definition</b> gsMatrix.h:41</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiBasis_html"><div class="ttname"><a href="classgismo_1_1gsMultiBasis.html">gismo::gsMultiBasis</a></div><div class="ttdoc">Holds a set of patch-wise bases and their topology information.</div><div class="ttdef"><b>Definition</b> gsMultiBasis.h:37</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiPatch_html"><div class="ttname"><a href="classgismo_1_1gsMultiPatch.html">gismo::gsMultiPatch</a></div><div class="ttdoc">Container class for a set of geometry patches and their topology, that is, the interface connections ...</div><div class="ttdef"><b>Definition</b> gsMultiPatch.h:100</div></div>
<div class="ttc" id="aclassgismo_1_1gsPoissonAssembler_html"><div class="ttname"><a href="classgismo_1_1gsPoissonAssembler.html">gismo::gsPoissonAssembler</a></div><div class="ttdoc">Implementation of an (multiple right-hand side) Poisson assembler.</div><div class="ttdef"><b>Definition</b> gsPoissonAssembler.h:37</div></div>
<div class="ttc" id="aclassgismo_1_1gsTHBSplineBasis_html"><div class="ttname"><a href="classgismo_1_1gsTHBSplineBasis.html">gismo::gsTHBSplineBasis</a></div><div class="ttdoc">Truncated hierarchical B-spline basis.</div><div class="ttdef"><b>Definition</b> gsTHBSplineBasis.h:36</div></div>
<div class="ttc" id="aclassgismo_1_1gsTensorBSplineBasis_html"><div class="ttname"><a href="classgismo_1_1gsTensorBSplineBasis.html">gismo::gsTensorBSplineBasis</a></div><div class="ttdoc">A tensor product B-spline basis.</div><div class="ttdef"><b>Definition</b> gsTensorBSplineBasis.h:37</div></div>
<div class="ttc" id="aclassgismo_1_1gsTensorBSpline_html"><div class="ttname"><a href="classgismo_1_1gsTensorBSpline.html">gismo::gsTensorBSpline</a></div><div class="ttdoc">A tensor product of d B-spline functions, with arbitrary target dimension.</div><div class="ttdef"><b>Definition</b> gsTensorBSpline.h:45</div></div>
<div class="ttc" id="agismo_8h_html"><div class="ttname"><a href="gismo_8h.html">gismo.h</a></div><div class="ttdoc">Main header to be included by clients using the G+Smo library.</div></div>
<div class="ttc" id="agroup__Assembler_html_ga01b4eb9039518258e67fa541adbc5fd1"><div class="ttname"><a href="group__Assembler.html#ga01b4eb9039518258e67fa541adbc5fd1">gismo::gsMarkElementsForRef</a></div><div class="ttdeci">void gsMarkElementsForRef(const std::vector&lt; T &gt; &amp;elError, int refCriterion, T refParameter, std::vector&lt; bool &gt; &amp;elMarked)</div><div class="ttdoc">Marks elements/cells for refinement.</div><div class="ttdef"><b>Definition</b> gsAdaptiveRefUtils.h:196</div></div>
<div class="ttc" id="agroup__Assembler_html_ga33738199285ae0ea097c96b9c572d786"><div class="ttname"><a href="group__Assembler.html#ga33738199285ae0ea097c96b9c572d786">gismo::gsRefineMarkedElements</a></div><div class="ttdeci">void gsRefineMarkedElements(gsMultiBasis&lt; T &gt; &amp;basis, const std::vector&lt; bool &gt; &amp;elMarked, index_t refExtension=0)</div><div class="ttdoc">Refine a gsMultiBasis, based on a vector of element-markings.</div><div class="ttdef"><b>Definition</b> gsAdaptiveRefUtils.h:294</div></div>
<div class="ttc" id="agsAdaptiveRefUtils_8h_html"><div class="ttname"><a href="gsAdaptiveRefUtils_8h.html">gsAdaptiveRefUtils.h</a></div><div class="ttdoc">Provides class for adaptive refinement.</div></div>
<div class="ttc" id="agsConfig_8h_html_ad722078677c063a09661059674fb996c"><div class="ttname"><a href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a></div><div class="ttdeci">#define index_t</div><div class="ttdef"><b>Definition</b> gsConfig.h:32</div></div>
<div class="ttc" id="agsDebug_8h_html_af6177e1e282640c3cb9175565f84a432"><div class="ttname"><a href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a></div><div class="ttdeci">#define gsInfo</div><div class="ttdef"><b>Definition</b> gsDebug.h:43</div></div>
<div class="ttc" id="anamespacegismo_1_1expr_html_a37e91c8b6c3efac383e28a3cb2b5f092"><div class="ttname"><a href="namespacegismo_1_1expr.html#a37e91c8b6c3efac383e28a3cb2b5f092">gismo::expr::meas</a></div><div class="ttdeci">EIGEN_STRONG_INLINE meas_expr&lt; T &gt; meas(const gsGeometryMap&lt; T &gt; &amp;G)</div><div class="ttdoc">The measure of a geometry map.</div><div class="ttdef"><b>Definition</b> gsExpressions.h:4555</div></div>
<div class="ttc" id="anamespacegismo_html"><div class="ttname"><a href="namespacegismo.html">gismo</a></div><div class="ttdoc">The G+Smo namespace, containing all definitions for the library.</div></div>
<div class="ttc" id="anamespacegismo_html_a709bf9361d5a1834a96d598b9661b165"><div class="ttname"><a href="namespacegismo.html#a709bf9361d5a1834a96d598b9661b165">gismo::gsWrite</a></div><div class="ttdeci">void gsWrite(const Object &amp;obj, const std::string &amp;fname)</div><div class="ttdoc">Write an arbitrary Gismo object to an XML file with the given filename.</div><div class="ttdef"><b>Definition</b> gsReadFile.h:288</div></div>
<div class="ttc" id="astructgismo_1_1condition__type_html_a7aead736a07eaf25623ad7bfa1f0ee2da1b4f535d1f53363637f933002efc2b4b"><div class="ttname"><a href="structgismo_1_1condition__type.html#a7aead736a07eaf25623ad7bfa1f0ee2da1b4f535d1f53363637f933002efc2b4b">gismo::condition_type::dirichlet</a></div><div class="ttdeci">@ dirichlet</div><div class="ttdoc">Dirichlet type.</div><div class="ttdef"><b>Definition</b> gsBoundaryConditions.h:31</div></div>
<div class="ttc" id="astructgismo_1_1gsNurbsCreator_html"><div class="ttname"><a href="structgismo_1_1gsNurbsCreator.html">gismo::gsNurbsCreator</a></div><div class="ttdoc">Class gsNurbsCreator provides some simple examples of Nurbs Geometries.</div><div class="ttdef"><b>Definition</b> gsNurbsCreator.h:37</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Jan 20 2025 09:35:27 for G+Smo by Doxygen v1.9.8 </li>
  </ul>
</div>
<!-- Piwik --> 
<!--
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? "https://stats.sylphide-consulting.com/piwik/" : "http://stats.sylphide-consulting.com/piwik/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 20);
piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
</script><noscript><p><img src="http://stats.sylphide-consulting.com/piwik/piwik.php?idsite=20" style="border:0" alt="" /></p></noscript>
-->
<!-- End Piwik Tracking Code -->
</body>
</html>

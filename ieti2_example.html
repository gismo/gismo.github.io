<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<title>G+Smo: ieti2_example.cpp</title>
<link href="gismodoxy_tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://people.ricam.oeaw.ac.at/gismo/mj/MathJax.js"></script>
<link href="doxygen.css"   rel="stylesheet" type="text/css" />
<link href="gismodoxy.css" rel="stylesheet" type="text/css">
<!--  -->
<!-- <script type="text/javascript"> -->
<!-- </script> -->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- <a name="top"></a> -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="gslogo-doxy.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname"><a href="index.html"><font style="font-variant:small-caps;">G+S</font><font style="font-variant:small-caps;"
															    color="#000000">mo</font></a>
   &#160;<span id="projectnumber">25.01.0</span>
   </div>
   <div id="projectbrief">Geometry + Simulation Modules</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('ieti2_example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">ieti2_example.cpp</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This example is a variation of the example file <em>ieti_example.cpp</em>, please see the documentation for that file.</p>
<p>There are two main differences:</p>
<ul>
<li>The file at hand used a <em><a class="el" href="classgismo_1_1gsAssembler.html" title="The assembler class provides generic routines for volume and boundary integrals that are used for for...">gsAssembler</a></em> based assembler, while the example file <em>ieti_example.cpp</em> uses the <em><a class="el" href="classgismo_1_1gsExprAssembler.html">gsExprAssembler</a></em>.</li>
<li>The file at hand uses a MINRES solver to solve the saddle point formulation of the IETI system, which is of particular interest for inexact variants of IETI. The example file <em>ieti_example.cpp</em> uses CG for solving the Schur complement formulation.</li>
</ul>
<h1><a class="anchor" id="ieti2_exampleAnnotated"></a>
Annotated source file</h1>
<p>Here is the full file <code>examples/ieti2_example.cpp</code>. Clicking on a function or class name will lead you to its reference documentation.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;ctime&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="gismo_8h.html">gismo.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacegismo.html">gismo</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line"><span class="comment">    /************** Define command line options *************/</span></div>
<div class="line"> </div>
<div class="line">    std::string geometry(<span class="stringliteral">&quot;domain2d/yeti_mp2.xml&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> splitPatches = 1;</div>
<div class="line">    real_t stretchGeometry = 1;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> refinements = 1;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> degree = 2;</div>
<div class="line">    std::string boundaryConditions(<span class="stringliteral">&quot;d&quot;</span>);</div>
<div class="line">    real_t tolerance = 1.e-8;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> maxIterations = 100;</div>
<div class="line">    std::string out;</div>
<div class="line">    <span class="keywordtype">bool</span> plot = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsCmdLine.html">gsCmdLine</a> cmd(<span class="stringliteral">&quot;Solves a PDE with an isogeometric discretization using an isogeometric tearing and interconnecting (IETI) solver.&quot;</span>);</div>
<div class="line">    cmd.addString(<span class="stringliteral">&quot;g&quot;</span>, <span class="stringliteral">&quot;Geometry&quot;</span>,              <span class="stringliteral">&quot;Geometry file&quot;</span>, geometry);</div>
<div class="line">    cmd.addInt   (<span class="stringliteral">&quot;&quot;</span>,  <span class="stringliteral">&quot;SplitPatches&quot;</span>,          <span class="stringliteral">&quot;Split every patch that many times in 2^d patches&quot;</span>, splitPatches);</div>
<div class="line">    cmd.addReal  (<span class="stringliteral">&quot;&quot;</span>,  <span class="stringliteral">&quot;StretchGeometry&quot;</span>,       <span class="stringliteral">&quot;Stretch geometry in x-direction by the given factor&quot;</span>, stretchGeometry);</div>
<div class="line">    cmd.addInt   (<span class="stringliteral">&quot;r&quot;</span>, <span class="stringliteral">&quot;Refinements&quot;</span>,           <span class="stringliteral">&quot;Number of uniform h-refinement steps to perform before solving&quot;</span>, refinements);</div>
<div class="line">    cmd.addInt   (<span class="stringliteral">&quot;p&quot;</span>, <span class="stringliteral">&quot;Degree&quot;</span>,                <span class="stringliteral">&quot;Degree of the B-spline discretization space&quot;</span>, degree);</div>
<div class="line">    cmd.addString(<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;BoundaryConditions&quot;</span>,    <span class="stringliteral">&quot;Boundary conditions&quot;</span>, boundaryConditions);</div>
<div class="line">    cmd.addReal  (<span class="stringliteral">&quot;t&quot;</span>, <span class="stringliteral">&quot;Solver.Tolerance&quot;</span>,      <span class="stringliteral">&quot;Stopping criterion for linear solver&quot;</span>, tolerance);</div>
<div class="line">    cmd.addInt   (<span class="stringliteral">&quot;&quot;</span>,  <span class="stringliteral">&quot;Solver.MaxIterations&quot;</span>,  <span class="stringliteral">&quot;Stopping criterion for linear solver&quot;</span>, maxIterations);</div>
<div class="line">    cmd.addString(<span class="stringliteral">&quot;&quot;</span>,  <span class="stringliteral">&quot;out&quot;</span>,                   <span class="stringliteral">&quot;Write solution and used options to file&quot;</span>, out);</div>
<div class="line">    cmd.addSwitch(     <span class="stringliteral">&quot;plot&quot;</span>,                  <span class="stringliteral">&quot;Plot the result with Paraview&quot;</span>, plot);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">try</span> { cmd.getValues(argc,argv); } <span class="keywordflow">catch</span> (<span class="keywordtype">int</span> rv) { <span class="keywordflow">return</span> rv; }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ( ! <a class="code hl_function" href="classgismo_1_1gsFileManager.html#a8da6832660ffb6bbf974846015f44a21">gsFileManager::fileExists</a>(geometry) )</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Geometry file could not be found.\n&quot;</span>;</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;I was searching in the current directory and in: &quot;</span> &lt;&lt; <a class="code hl_function" href="classgismo_1_1gsFileManager.html#a76962c9181651d5335c0712a38f0e6a6">gsFileManager::getSearchPaths</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Run ieti_example with options:\n&quot;</span> &lt;&lt; cmd &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line"><span class="comment">    /******************* Define geometry ********************/</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Define geometry... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_typedef" href="classgismo_1_1gsMultiPatch.html#ad7190c68d8ead80bd1b6fd7256779894">gsMultiPatch&lt;&gt;::uPtr</a> mpPtr = <a class="code hl_class" href="classgismo_1_1gsReadFile.html">gsReadFile&lt;&gt;</a>(geometry);</div>
<div class="line">    <span class="keywordflow">if</span> (!mpPtr)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;No geometry found in file &quot;</span> &lt;&lt; geometry &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch&lt;&gt;</a>&amp; mp = *mpPtr;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i=0; i&lt;splitPatches; ++i)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;split patches uniformly... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line">        mp = mp.uniformSplit();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (stretchGeometry!=1)</div>
<div class="line">    {</div>
<div class="line">       <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;and stretch it... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line">       <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0; i!=mp.nPatches(); ++i)</div>
<div class="line">           <span class="keyword">const_cast&lt;</span><a class="code hl_class" href="classgismo_1_1gsGeometry.html">gsGeometry&lt;&gt;</a>&amp;<span class="keyword">&gt;</span>(mp[i]).<a class="code hl_function" href="classgismo_1_1gsGeometry.html#a43e34549f7cc019b808fc40fd6a7a05f">scale</a>(stretchGeometry,0);</div>
<div class="line">       <span class="comment">// Const cast is allowed since the object itself is not const. Stretching the</span></div>
<div class="line">       <span class="comment">// overall domain keeps its topology.</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done.\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">    /************** Define boundary conditions **************/</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Define right-hand-side and boundary conditions... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Right-hand-side</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a> f( <span class="stringliteral">&quot;2*sin(x)*cos(y)&quot;</span>, mp.geoDim() );</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Dirichlet function</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a> gD( <span class="stringliteral">&quot;sin(x)*cos(y)&quot;</span>, mp.geoDim() );</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Neumann</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsConstantFunction.html">gsConstantFunction&lt;&gt;</a> gN( 1.0, mp.geoDim() );</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsBoundaryConditions.html">gsBoundaryConditions&lt;&gt;</a> bc;</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> len = boundaryConditions.length();</div>
<div class="line">        <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i = 0;</div>
<div class="line">        <span class="keywordflow">for</span> (gsMultiPatch&lt;&gt;::const_biterator it = mp.bBegin(); it &lt; mp.bEnd(); ++it)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">char</span> b_local;</div>
<div class="line">            <span class="keywordflow">if</span> ( len == 1 )</div>
<div class="line">                b_local = boundaryConditions[0];</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( i &lt; len )</div>
<div class="line">                b_local = boundaryConditions[i];</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;\nNot enough boundary conditions given.\n&quot;</span>;</div>
<div class="line">                <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> ( b_local == <span class="charliteral">&#39;d&#39;</span> )</div>
<div class="line">                bc.<a class="code hl_function" href="classgismo_1_1gsBoundaryConditions.html#a1dd0c4f4cdae8082d37db999fc3932d2">addCondition</a>( *it, <a class="code hl_enumvalue" href="structgismo_1_1condition__type.html#a7aead736a07eaf25623ad7bfa1f0ee2da1b4f535d1f53363637f933002efc2b4b">condition_type::dirichlet</a>, &amp;gD );</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( b_local == <span class="charliteral">&#39;n&#39;</span> )</div>
<div class="line">                bc.<a class="code hl_function" href="classgismo_1_1gsBoundaryConditions.html#a1dd0c4f4cdae8082d37db999fc3932d2">addCondition</a>( *it, <a class="code hl_enumvalue" href="structgismo_1_1condition__type.html#a7aead736a07eaf25623ad7bfa1f0ee2da8e855db37d5c0fbd8eda96b2f51b8b20">condition_type::neumann</a>, &amp;gN );</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;\nInvalid boundary condition given; only &#39;d&#39; (Dirichlet) and &#39;n&#39; (Neumann) are supported.\n&quot;</span>;</div>
<div class="line">                <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            ++i;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> ( len &gt; i )</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;\nToo many boundary conditions have been specified. Ignoring the remaining ones.\n&quot;</span>;</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done. &quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot; boundary conditions set.\n&quot;</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">    /************ Setup bases and adjust degree *************/</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsMultiBasis.html">gsMultiBasis&lt;&gt;</a> mb(mp);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Setup bases and adjust degree... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> i = 0; i &lt; mb.nBases(); ++ i )</div>
<div class="line">        mb[i].setDegreePreservingMultiplicity(degree);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> ( <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i = 0; i &lt; refinements; ++i )</div>
<div class="line">        mb.uniformRefine();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done.\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">    /********* Setup assembler and assemble matrix **********/</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Setup assembler and assemble matrix... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> nPatches = mp.nPatches();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsIetiMapper.html">gsIetiMapper&lt;&gt;</a> ietiMapper;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// We start by setting up a global FeSpace that allows us to</span></div>
<div class="line">    <span class="comment">// obtain a dof mapper and the Dirichlet data</span></div>
<div class="line">    {</div>
<div class="line">      <a class="code hl_class" href="classgismo_1_1gsPoissonAssembler.html">gsPoissonAssembler&lt;&gt;</a> assembler(</div>
<div class="line">            mp,</div>
<div class="line">            mb,</div>
<div class="line">            bc,</div>
<div class="line">            f,</div>
<div class="line">            dirichlet::elimination,</div>
<div class="line">            iFace::glue</div>
<div class="line">        );</div>
<div class="line">        assembler.computeDirichletDofs();</div>
<div class="line">        ietiMapper.<a class="code hl_function" href="classgismo_1_1gsIetiMapper.html#a47f5cdc8185504d5d16a5ccb1e085b63">init</a>( mb, assembler.system().rowMapper(0), assembler.fixedDofs() );</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Compute the jump matrices</span></div>
<div class="line">    <span class="keywordtype">bool</span> fullyRedundant = <span class="keyword">true</span>,</div>
<div class="line">         noLagrangeMultipliersForCorners = <span class="keyword">true</span>;</div>
<div class="line">    ietiMapper.<a class="code hl_function" href="classgismo_1_1gsIetiMapper.html#a23e4453503baee19fa458314bc6a317d">computeJumpMatrices</a>(fullyRedundant, noLagrangeMultipliersForCorners);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// We tell the ieti mapper which primal constraints we want; calling</span></div>
<div class="line">    <span class="comment">// more than one such function is possible.</span></div>
<div class="line">    ietiMapper.<a class="code hl_function" href="classgismo_1_1gsIetiMapper.html#a34c2d7066cb0c6bcee1cbd131c1603f9">cornersAsPrimals</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// The ieti system does not have a special treatment for the</span></div>
<div class="line">    <span class="comment">// primal dofs. They are just one more subdomain</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsIetiSystem.html">gsIetiSystem&lt;&gt;</a> ieti;</div>
<div class="line">    ieti.<a class="code hl_function" href="classgismo_1_1gsIetiSystem.html#a7ebf485c8ffc385c75b2a9369edabd49">reserve</a>(nPatches+1);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// The scaled Dirichlet preconditioner is independent of the</span></div>
<div class="line">    <span class="comment">// primal dofs.</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsScaledDirichletPrec.html">gsScaledDirichletPrec&lt;&gt;</a> prec;</div>
<div class="line">    prec.<a class="code hl_function" href="classgismo_1_1gsScaledDirichletPrec.html#a7ebf485c8ffc385c75b2a9369edabd49">reserve</a>(nPatches);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Setup the primal system, which needs to know the number of primal dofs.</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsPrimalSystem.html">gsPrimalSystem&lt;&gt;</a> primal(ietiMapper.<a class="code hl_function" href="classgismo_1_1gsIetiMapper.html#aa594441b8000ed8f7bc13fc646988bec">nPrimalDofs</a>());</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Setup of the block-diagonal preconditioner for the saddle point problem</span></div>
<div class="line">    <span class="comment">// First, we need to know its size</span></div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> bdPrecSz = nPatches + 1 + (ietiMapper.<a class="code hl_function" href="classgismo_1_1gsIetiMapper.html#aa594441b8000ed8f7bc13fc646988bec">nPrimalDofs</a>()&gt;0?1:0);</div>
<div class="line">    <a class="code hl_typedef" href="classgismo_1_1gsBlockOp.html#a862f72334199d063992d8d695228e286">gsBlockOp&lt;&gt;::Ptr</a> bdPrec = <a class="code hl_function" href="classgismo_1_1gsBlockOp.html#a22235d2eb083c4eeef229e854010cf2a">gsBlockOp&lt;&gt;::make</a>(bdPrecSz,bdPrecSz);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> k=0; k&lt;nPatches; ++k)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// We use the local variants of everything</span></div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsBoundaryConditions.html">gsBoundaryConditions&lt;&gt;</a> bc_local;</div>
<div class="line">        bc.<a class="code hl_function" href="classgismo_1_1gsBoundaryConditions.html#a119d313b7f45107db2c3786f9c1533e4">getConditionsForPatch</a>(k,bc_local);</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch&lt;&gt;</a> mp_local = mp[k];</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsMultiBasis.html">gsMultiBasis&lt;&gt;</a> mb_local = mb[k];</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Setup assembler</span></div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsPoissonAssembler.html">gsPoissonAssembler&lt;&gt;</a> assembler(</div>
<div class="line">            mp_local,</div>
<div class="line">            mb_local,</div>
<div class="line">            bc_local,</div>
<div class="line">            f,</div>
<div class="line">            dirichlet::elimination,</div>
<div class="line">            iFace::glue</div>
<div class="line">        );</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// This provides a new dof mapper and the Dirichlet data</span></div>
<div class="line">        <span class="comment">// This is necessary since it might happen that a 2d-patch touches the</span></div>
<div class="line">        <span class="comment">// Dirichlet boundary just with a corner or that a 3d-patch touches the</span></div>
<div class="line">        <span class="comment">// Dirichlet boundary with a corner or an edge. These cases are not</span></div>
<div class="line">        <span class="comment">// covered by bc.getConditionsForPatch</span></div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsDofMapper.html">gsDofMapper</a> tmp = ietiMapper.<a class="code hl_function" href="classgismo_1_1gsIetiMapper.html#a353418adc71bbcf5ea305cb867db387b">dofMapperLocal</a>(k);</div>
<div class="line">        assembler.system() = <a class="code hl_class" href="classgismo_1_1gsSparseSystem.html">gsSparseSystem&lt;&gt;</a>(tmp); <span class="comment">// gsSparseSystem takes per reference and steals contets</span></div>
<div class="line">        assembler.setFixedDofVector(ietiMapper.<a class="code hl_function" href="classgismo_1_1gsIetiMapper.html#a2a29ca874437ada30ea2a712f5ecd960">fixedPart</a>(k));</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Assemble</span></div>
<div class="line">        assembler.assemble();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Fetch data</span></div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;real_t, RowMajor&gt;</a> jumpMatrix  = ietiMapper.<a class="code hl_function" href="classgismo_1_1gsIetiMapper.html#aca458c464f2cfc1bc96902f216dd4c36">jumpMatrix</a>(k);</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;&gt;</a>                 localMatrix = assembler.matrix();</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a>                       localRhs    = assembler.rhs();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Add the patch to the scaled Dirichlet preconditioner</span></div>
<div class="line">        <span class="comment">//</span></div>
<div class="line">        <span class="comment">// This can be done using gsScaledDirichletPrec&lt;&gt;::restrictToSkeleton</span></div>
<div class="line">        <span class="comment">// as in ieti_example. Here, we call the underlying commands directly</span></div>
<div class="line">        <span class="comment">// to show how one can choose an alternative solver.</span></div>
<div class="line">        std::vector&lt;index_t&gt; skeletonDofs = ietiMapper.<a class="code hl_function" href="classgismo_1_1gsIetiMapper.html#ab3cab174cd281fbf6d987337e61fd826">skeletonDofs</a>(k);</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_struct" href="structgismo_1_1gsScaledDirichletPrec_1_1Blocks.html">gsScaledDirichletPrec&lt;&gt;::Blocks</a> blocks</div>
<div class="line">            = <a class="code hl_function" href="classgismo_1_1gsScaledDirichletPrec.html#adfac85e147606b452a85b2881ebb3a6b">gsScaledDirichletPrec&lt;&gt;::matrixBlocks</a>(localMatrix, skeletonDofs);</div>
<div class="line"> </div>
<div class="line">        prec.<a class="code hl_function" href="classgismo_1_1gsScaledDirichletPrec.html#a6576e33b303fa0efb7b7ef8e3a6bc3f9">addSubdomain</a>(</div>
<div class="line">            prec.<a class="code hl_function" href="classgismo_1_1gsScaledDirichletPrec.html#a9219afc9dd280538e2ec3fcb4dea4e40">restrictJumpMatrix</a>(jumpMatrix, skeletonDofs).<a class="code hl_function" href="classgismo_1_1gsSparseMatrix.html#a24da616b328c15186de32aa2c9a51938">moveToPtr</a>(),</div>
<div class="line">            <a class="code hl_class" href="classgismo_1_1gsScaledDirichletPrec.html">gsScaledDirichletPrec&lt;&gt;::schurComplement</a>( blocks, makeSparseCholeskySolver(blocks.A11) )</div>
<div class="line">        );</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Now, we handle the primal constraints.</span></div>
<div class="line">        <span class="comment">//</span></div>
<div class="line">        <span class="comment">// This can be done using primal.handleConstraints as in ieti_example.</span></div>
<div class="line">        <span class="comment">// Here, we call the underlying commands directly to show how one can</span></div>
<div class="line">        <span class="comment">// choose an alternative solver.</span></div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;&gt;</a>  modifiedLocalMatrix, localEmbedding, embeddingForBasis;</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a>        rhsForBasis;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">bool</span> eliminatePointwiseDofs = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_function" href="classgismo_1_1gsPrimalSystem.html#a482be3533fb0f8c77f73a9d13bd92085">gsPrimalSystem&lt;&gt;::incorporateConstraints</a>(</div>
<div class="line">            ietiMapper.<a class="code hl_function" href="classgismo_1_1gsIetiMapper.html#ad38d69af76a1fd5b9c945e895212b376">primalConstraints</a>(k),</div>
<div class="line">            eliminatePointwiseDofs,</div>
<div class="line">            localMatrix,</div>
<div class="line">            modifiedLocalMatrix,</div>
<div class="line">            localEmbedding,</div>
<div class="line">            embeddingForBasis,</div>
<div class="line">            rhsForBasis</div>
<div class="line">        );</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_typedef" href="classgismo_1_1gsLinearOperator.html#a7e083f6c92575f77236d6cb193997e84">gsLinearOperator&lt;&gt;::Ptr</a> localSolver = makeSparseLUSolver(modifiedLocalMatrix);</div>
<div class="line"> </div>
<div class="line">        primal.addContribution(</div>
<div class="line">            jumpMatrix, localMatrix, localRhs,</div>
<div class="line">            <a class="code hl_class" href="classgismo_1_1gsPrimalSystem.html">gsPrimalSystem&lt;&gt;::primalBasis</a>(</div>
<div class="line">                localSolver, embeddingForBasis, rhsForBasis, ietiMapper.<a class="code hl_function" href="classgismo_1_1gsIetiMapper.html#a5d81b2ed67bae02681088507d0e55928">primalDofIndices</a>(k), primal.nPrimalDofs()</div>
<div class="line">            )</div>
<div class="line">        );</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a>                       modifiedLocalRhs     = localEmbedding.transpose() * localRhs;</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;real_t, RowMajor&gt;</a> modifiedJumpMatrix   = jumpMatrix * localEmbedding;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Register the local solver to the block preconditioner. We use</span></div>
<div class="line">        <span class="comment">// a sparse LU solver since the local saddle point problem is not</span></div>
<div class="line">        <span class="comment">// positive definite.</span></div>
<div class="line">        bdPrec-&gt;addOperator(k,k,localSolver);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Add the patch to the Ieti system</span></div>
<div class="line">        ieti.<a class="code hl_function" href="classgismo_1_1gsIetiSystem.html#a61e3b879da178aeaf79e2db044df337e">addSubdomain</a>(</div>
<div class="line">            modifiedJumpMatrix.<a class="code hl_function" href="classgismo_1_1gsSparseMatrix.html#a24da616b328c15186de32aa2c9a51938">moveToPtr</a>(),</div>
<div class="line">            makeMatrixOp(modifiedLocalMatrix.<a class="code hl_function" href="classgismo_1_1gsSparseMatrix.html#a24da616b328c15186de32aa2c9a51938">moveToPtr</a>()),</div>
<div class="line">            <a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(modifiedLocalRhs)</div>
<div class="line">        );</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Add the primal problem if there are primal constraints</span></div>
<div class="line">    <span class="keywordflow">if</span> (ietiMapper.<a class="code hl_function" href="classgismo_1_1gsIetiMapper.html#aa594441b8000ed8f7bc13fc646988bec">nPrimalDofs</a>()&gt;0)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Register the local solver to the block preconditioner</span></div>
<div class="line">        bdPrec-&gt;addOperator(nPatches, nPatches, makeSparseCholeskySolver(primal.localMatrix()));</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Add to IETI system</span></div>
<div class="line">        ieti.<a class="code hl_function" href="classgismo_1_1gsIetiSystem.html#a61e3b879da178aeaf79e2db044df337e">addSubdomain</a>(</div>
<div class="line">            primal.jumpMatrix().moveToPtr(),</div>
<div class="line">            makeMatrixOp(primal.localMatrix().moveToPtr()),</div>
<div class="line">            <a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(primal.localRhs())</div>
<div class="line">        );</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done.\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">    /**************** Setup solver and solve ****************/</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Setup solver and solve... \n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;    Setup multiplicity scaling... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Tell the preconditioner to set up the scaling</span></div>
<div class="line">    prec.<a class="code hl_function" href="classgismo_1_1gsScaledDirichletPrec.html#acaa221022cd4b0107af70d2e4d354699">setupMultiplicityScaling</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// The scaled Dirichlet preconditioner is in the last block</span></div>
<div class="line">    <a class="code hl_typedef" href="classgismo_1_1gsLinearOperator.html#a7e083f6c92575f77236d6cb193997e84">gsLinearOperator&lt;&gt;::Ptr</a> sdPrec = prec.<a class="code hl_function" href="classgismo_1_1gsScaledDirichletPrec.html#a2b5388ceb650e63fe7f570f2e3ce3326">preconditioner</a>();</div>
<div class="line">    bdPrec-&gt;addOperator(bdPrecSz-1,bdPrecSz-1,sdPrec);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done.\n    Setup minres solver and solve... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line">    <span class="comment">// Initial guess</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a> x;</div>
<div class="line">    x.setRandom( bdPrec-&gt;rows(), 1 );</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// This is the main cg iteration</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a> errorHistory;</div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsMinimalResidual.html">gsMinimalResidual&lt;&gt;</a>( ieti.<a class="code hl_function" href="classgismo_1_1gsIetiSystem.html#a2c659ba1577c256572087a2c5dc17e0f">saddlePointProblem</a>(), bdPrec )</div>
<div class="line">        .<a class="code hl_function" href="classgismo_1_1gsMinimalResidual.html#ac980000b9a6e7563b5f637ffe76f5176">setOptions</a>( cmd.getGroup(<span class="stringliteral">&quot;Solver&quot;</span>) )</div>
<div class="line">        .<a class="code hl_function" href="classgismo_1_1gsIterativeSolver.html#a6e04b51fc392c977e044b1c25f9d32c6">solveDetailed</a>( ieti.<a class="code hl_function" href="classgismo_1_1gsIetiSystem.html#ae7d8a1beda1608ab24c059e0c2ee4aea">rhsForSaddlePoint</a>(), x, errorHistory );</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done.\n    Reconstruct solution from Lagrange multipliers... &quot;</span> &lt;&lt; std::flush;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Now, we want to have the global solution for u</span></div>
<div class="line">    std::vector&lt;gsMatrix&lt;&gt;&gt; uLocal = primal.distributePrimalSolution(</div>
<div class="line">        ieti.<a class="code hl_function" href="classgismo_1_1gsIetiSystem.html#a74802ed17847ec5d250011006c43590e">constructSolutionFromSaddlePoint</a>(x)</div>
<div class="line">    );</div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a> uGlobal = ietiMapper.<a class="code hl_function" href="classgismo_1_1gsIetiMapper.html#a544a4ee495de0bb8dddcb2c80e4dba38">constructGlobalSolutionFromLocalSolutions</a>(uLocal);</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;done.\n\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">    /******************** Print end Exit ********************/</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> iter = errorHistory.rows()-1;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">bool</span> success = errorHistory(iter,0) &lt; tolerance;</div>
<div class="line">    <span class="keywordflow">if</span> (success)</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Reached desired tolerance after &quot;</span> &lt;&lt; iter &lt;&lt; <span class="stringliteral">&quot; iterations:\n&quot;</span>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Did not reach desired tolerance after &quot;</span> &lt;&lt; iter &lt;&lt; <span class="stringliteral">&quot; iterations:\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (errorHistory.rows() &lt; 20)</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; errorHistory.transpose() &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; errorHistory.topRows(5).transpose() &lt;&lt; <span class="stringliteral">&quot; ... &quot;</span> &lt;&lt; errorHistory.bottomRows(5).transpose()  &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!out.empty())</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsFileData.html">gsFileData&lt;&gt;</a> fd;</div>
<div class="line">        std::time_t time = std::time(NULL);</div>
<div class="line">        fd.add(cmd);</div>
<div class="line">        fd.add(uGlobal);</div>
<div class="line">        fd.addComment(std::string(<span class="stringliteral">&quot;ieti2_example   Timestamp:&quot;</span>)+std::ctime(&amp;time));</div>
<div class="line">        fd.save(out);</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Write solution to file &quot;</span> &lt;&lt; out &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (plot)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Write Paraview data to file ieti_result.pvd\n&quot;</span>;</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch&lt;&gt;</a> mpsol;</div>
<div class="line">        <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> k=0; k&lt;nPatches; ++k)</div>
<div class="line">            mpsol.<a class="code hl_function" href="classgismo_1_1gsMultiPatch.html#a9fbe98882789c00c743d121b7f59df52">addPatch</a>( mb[k].makeGeometry( ietiMapper.<a class="code hl_function" href="classgismo_1_1gsIetiMapper.html#a02222f29fab11af9e87a72ec65d28d5d">incorporateFixedPart</a>(k, uLocal[k])  ) );</div>
<div class="line">        gsWriteParaview&lt;&gt;( <a class="code hl_class" href="classgismo_1_1gsField.html">gsField&lt;&gt;</a>( mp, mpsol ), <span class="stringliteral">&quot;ieti_result&quot;</span>, 1000);</div>
<div class="line">        <span class="comment">//gsFileManager::open(&quot;ieti_result.pvd&quot;);</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!plot&amp;&amp;out.empty())</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Done. No output created, re-run with --plot to get a ParaView &quot;</span></div>
<div class="line">                  <span class="stringliteral">&quot;file containing the solution or --out to write solution to xml file.\n&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> success ? EXIT_SUCCESS : EXIT_FAILURE;</div>
<div class="line">}</div>
<div class="ttc" id="aclassgismo_1_1gsBlockOp_html_a22235d2eb083c4eeef229e854010cf2a"><div class="ttname"><a href="classgismo_1_1gsBlockOp.html#a22235d2eb083c4eeef229e854010cf2a">gismo::gsBlockOp::make</a></div><div class="ttdeci">static uPtr make(index_t nRows, index_t nCols)</div><div class="ttdoc">Make function returning a smart pointer.</div><div class="ttdef"><b>Definition</b> gsBlockOp.h:60</div></div>
<div class="ttc" id="aclassgismo_1_1gsBlockOp_html_a862f72334199d063992d8d695228e286"><div class="ttname"><a href="classgismo_1_1gsBlockOp.html#a862f72334199d063992d8d695228e286">gismo::gsBlockOp::Ptr</a></div><div class="ttdeci">memory::shared_ptr&lt; gsBlockOp&lt; T &gt; &gt; Ptr</div><div class="ttdoc">Shared pointer for gsBlockOp.</div><div class="ttdef"><b>Definition</b> gsBlockOp.h:48</div></div>
<div class="ttc" id="aclassgismo_1_1gsBoundaryConditions_html"><div class="ttname"><a href="classgismo_1_1gsBoundaryConditions.html">gismo::gsBoundaryConditions</a></div><div class="ttdoc">Class containing a set of boundary conditions.</div><div class="ttdef"><b>Definition</b> gsBoundaryConditions.h:342</div></div>
<div class="ttc" id="aclassgismo_1_1gsBoundaryConditions_html_a119d313b7f45107db2c3786f9c1533e4"><div class="ttname"><a href="classgismo_1_1gsBoundaryConditions.html#a119d313b7f45107db2c3786f9c1533e4">gismo::gsBoundaryConditions::getConditionsForPatch</a></div><div class="ttdeci">void getConditionsForPatch(const index_t np, gsBoundaryConditions &amp;result) const</div><div class="ttdoc">returns the set of all boundary conditions which refer to patch np</div><div class="ttdef"><b>Definition</b> gsBoundaryConditions.h:848</div></div>
<div class="ttc" id="aclassgismo_1_1gsBoundaryConditions_html_a1dd0c4f4cdae8082d37db999fc3932d2"><div class="ttname"><a href="classgismo_1_1gsBoundaryConditions.html#a1dd0c4f4cdae8082d37db999fc3932d2">gismo::gsBoundaryConditions::addCondition</a></div><div class="ttdeci">void addCondition(int p, boxSide s, condition_type::type t, gsFunctionSet&lt; T &gt; *f, short_t unknown=0, bool parametric=false, int comp=-1)</div><div class="ttdoc">Adds another boundary condition.</div><div class="ttdef"><b>Definition</b> gsBoundaryConditions.h:650</div></div>
<div class="ttc" id="aclassgismo_1_1gsCmdLine_html"><div class="ttname"><a href="classgismo_1_1gsCmdLine.html">gismo::gsCmdLine</a></div><div class="ttdoc">Class for command-line argument parsing.</div><div class="ttdef"><b>Definition</b> gsCmdLine.h:57</div></div>
<div class="ttc" id="aclassgismo_1_1gsConstantFunction_html"><div class="ttname"><a href="classgismo_1_1gsConstantFunction.html">gismo::gsConstantFunction</a></div><div class="ttdoc">Class defining a globally constant function.</div><div class="ttdef"><b>Definition</b> gsConstantFunction.h:34</div></div>
<div class="ttc" id="aclassgismo_1_1gsDofMapper_html"><div class="ttname"><a href="classgismo_1_1gsDofMapper.html">gismo::gsDofMapper</a></div><div class="ttdoc">Maintains a mapping from patch-local dofs to global dof indices and allows the elimination of individ...</div><div class="ttdef"><b>Definition</b> gsDofMapper.h:69</div></div>
<div class="ttc" id="aclassgismo_1_1gsField_html"><div class="ttname"><a href="classgismo_1_1gsField.html">gismo::gsField</a></div><div class="ttdoc">A scalar of vector field defined on a m_parametric geometry.</div><div class="ttdef"><b>Definition</b> gsField.h:55</div></div>
<div class="ttc" id="aclassgismo_1_1gsFileData_html"><div class="ttname"><a href="classgismo_1_1gsFileData.html">gismo::gsFileData</a></div><div class="ttdoc">This class represents an XML data tree which can be read from or written to a (file) stream.</div><div class="ttdef"><b>Definition</b> gsFileData.h:34</div></div>
<div class="ttc" id="aclassgismo_1_1gsFileManager_html_a76962c9181651d5335c0712a38f0e6a6"><div class="ttname"><a href="classgismo_1_1gsFileManager.html#a76962c9181651d5335c0712a38f0e6a6">gismo::gsFileManager::getSearchPaths</a></div><div class="ttdeci">static std::string getSearchPaths()</div><div class="ttdoc">Get the defined search paths.</div><div class="ttdef"><b>Definition</b> gsFileManager.cpp:271</div></div>
<div class="ttc" id="aclassgismo_1_1gsFileManager_html_a8da6832660ffb6bbf974846015f44a21"><div class="ttname"><a href="classgismo_1_1gsFileManager.html#a8da6832660ffb6bbf974846015f44a21">gismo::gsFileManager::fileExists</a></div><div class="ttdeci">static bool fileExists(const std::string &amp;name)</div><div class="ttdoc">Checks if the file exists.</div><div class="ttdef"><b>Definition</b> gsFileManager.cpp:62</div></div>
<div class="ttc" id="aclassgismo_1_1gsFunctionExpr_html"><div class="ttname"><a href="classgismo_1_1gsFunctionExpr.html">gismo::gsFunctionExpr</a></div><div class="ttdoc">Class defining a multivariate (real or vector) function given by a string mathematical expression.</div><div class="ttdef"><b>Definition</b> gsFunctionExpr.h:52</div></div>
<div class="ttc" id="aclassgismo_1_1gsGeometry_html"><div class="ttname"><a href="classgismo_1_1gsGeometry.html">gismo::gsGeometry</a></div><div class="ttdoc">Abstract base class representing a geometry map.</div><div class="ttdef"><b>Definition</b> gsGeometry.h:93</div></div>
<div class="ttc" id="aclassgismo_1_1gsGeometry_html_a43e34549f7cc019b808fc40fd6a7a05f"><div class="ttname"><a href="classgismo_1_1gsGeometry.html#a43e34549f7cc019b808fc40fd6a7a05f">gismo::gsGeometry::scale</a></div><div class="ttdeci">void scale(T s, int coord=-1)</div><div class="ttdoc">Apply Scaling by factor s.</div><div class="ttdef"><b>Definition</b> gsGeometry.h:413</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiMapper_html"><div class="ttname"><a href="classgismo_1_1gsIetiMapper.html">gismo::gsIetiMapper</a></div><div class="ttdoc">Ieti Mapper.</div><div class="ttdef"><b>Definition</b> gsIetiMapper.h:50</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiMapper_html_a02222f29fab11af9e87a72ec65d28d5d"><div class="ttname"><a href="classgismo_1_1gsIetiMapper.html#a02222f29fab11af9e87a72ec65d28d5d">gismo::gsIetiMapper::incorporateFixedPart</a></div><div class="ttdeci">Matrix incorporateFixedPart(index_t k, const gsMatrix&lt; T &gt; &amp;localSolution) const</div><div class="ttdoc">Incorporates fixedPart (eg. from eliminated Dirichlet dofs) to given patch-local solution.</div><div class="ttdef"><b>Definition</b> gsIetiMapper.hpp:400</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiMapper_html_a23e4453503baee19fa458314bc6a317d"><div class="ttname"><a href="classgismo_1_1gsIetiMapper.html#a23e4453503baee19fa458314bc6a317d">gismo::gsIetiMapper::computeJumpMatrices</a></div><div class="ttdeci">void computeJumpMatrices(bool fullyRedundant, bool excludeCorners)</div><div class="ttdoc">This function computes the jump matrices.</div><div class="ttdef"><b>Definition</b> gsIetiMapper.hpp:297</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiMapper_html_a2a29ca874437ada30ea2a712f5ecd960"><div class="ttname"><a href="classgismo_1_1gsIetiMapper.html#a2a29ca874437ada30ea2a712f5ecd960">gismo::gsIetiMapper::fixedPart</a></div><div class="ttdeci">const Matrix &amp; fixedPart(index_t k) const</div><div class="ttdoc">The function values for the eliminated dofs on the given patch Only available after computeJumpMatric...</div><div class="ttdef"><b>Definition</b> gsIetiMapper.h:179</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiMapper_html_a34c2d7066cb0c6bcee1cbd131c1603f9"><div class="ttname"><a href="classgismo_1_1gsIetiMapper.html#a34c2d7066cb0c6bcee1cbd131c1603f9">gismo::gsIetiMapper::cornersAsPrimals</a></div><div class="ttdeci">void cornersAsPrimals()</div><div class="ttdoc">Set up the corners as primal dofs.</div><div class="ttdef"><b>Definition</b> gsIetiMapper.hpp:126</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiMapper_html_a353418adc71bbcf5ea305cb867db387b"><div class="ttname"><a href="classgismo_1_1gsIetiMapper.html#a353418adc71bbcf5ea305cb867db387b">gismo::gsIetiMapper::dofMapperLocal</a></div><div class="ttdeci">const gsDofMapper &amp; dofMapperLocal(index_t k) const</div><div class="ttdoc">The dof mapper for the given patch Only available after computeJumpMatrices has been called.</div><div class="ttdef"><b>Definition</b> gsIetiMapper.h:175</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiMapper_html_a47f5cdc8185504d5d16a5ccb1e085b63"><div class="ttname"><a href="classgismo_1_1gsIetiMapper.html#a47f5cdc8185504d5d16a5ccb1e085b63">gismo::gsIetiMapper::init</a></div><div class="ttdeci">void init(const gsMultiBasis&lt; T &gt; &amp;multiBasis, gsDofMapper dofMapperGlobal, const Matrix &amp;fixedPart)</div><div class="ttdoc">Init the ieti mapper after default construction.</div><div class="ttdef"><b>Definition</b> gsIetiMapper.hpp:30</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiMapper_html_a544a4ee495de0bb8dddcb2c80e4dba38"><div class="ttname"><a href="classgismo_1_1gsIetiMapper.html#a544a4ee495de0bb8dddcb2c80e4dba38">gismo::gsIetiMapper::constructGlobalSolutionFromLocalSolutions</a></div><div class="ttdeci">Matrix constructGlobalSolutionFromLocalSolutions(const std::vector&lt; Matrix &gt; &amp;localContribs)</div><div class="ttdoc">Construct the global solution from a vector of patch-local ones.</div><div class="ttdef"><b>Definition</b> gsIetiMapper.hpp:91</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiMapper_html_a5d81b2ed67bae02681088507d0e55928"><div class="ttname"><a href="classgismo_1_1gsIetiMapper.html#a5d81b2ed67bae02681088507d0e55928">gismo::gsIetiMapper::primalDofIndices</a></div><div class="ttdeci">const std::vector&lt; index_t &gt; &amp; primalDofIndices(index_t k) const</div><div class="ttdoc">Returns the indices of the primal dofs that are associated to the primal constraints for the given pa...</div><div class="ttdef"><b>Definition</b> gsIetiMapper.h:164</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiMapper_html_aa594441b8000ed8f7bc13fc646988bec"><div class="ttname"><a href="classgismo_1_1gsIetiMapper.html#aa594441b8000ed8f7bc13fc646988bec">gismo::gsIetiMapper::nPrimalDofs</a></div><div class="ttdeci">index_t nPrimalDofs() const</div><div class="ttdoc">Returns the size of the primal problem (number of primal dofs)</div><div class="ttdef"><b>Definition</b> gsIetiMapper.h:154</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiMapper_html_ab3cab174cd281fbf6d987337e61fd826"><div class="ttname"><a href="classgismo_1_1gsIetiMapper.html#ab3cab174cd281fbf6d987337e61fd826">gismo::gsIetiMapper::skeletonDofs</a></div><div class="ttdeci">std::vector&lt; index_t &gt; skeletonDofs(index_t patch) const</div><div class="ttdoc">Returns a list of dofs that are (on the coarse level) coupled.</div><div class="ttdef"><b>Definition</b> gsIetiMapper.hpp:282</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiMapper_html_aca458c464f2cfc1bc96902f216dd4c36"><div class="ttname"><a href="classgismo_1_1gsIetiMapper.html#aca458c464f2cfc1bc96902f216dd4c36">gismo::gsIetiMapper::jumpMatrix</a></div><div class="ttdeci">const JumpMatrix &amp; jumpMatrix(index_t k) const</div><div class="ttdoc">Returns the jump matrix  for the given patch Only available after computeJumpMatrices has been called...</div><div class="ttdef"><b>Definition</b> gsIetiMapper.h:168</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiMapper_html_ad38d69af76a1fd5b9c945e895212b376"><div class="ttname"><a href="classgismo_1_1gsIetiMapper.html#ad38d69af76a1fd5b9c945e895212b376">gismo::gsIetiMapper::primalConstraints</a></div><div class="ttdeci">const std::vector&lt; SparseVector &gt; &amp; primalConstraints(index_t k) const</div><div class="ttdoc">Returns the primalConstraints (as vectors) for the given patch.</div><div class="ttdef"><b>Definition</b> gsIetiMapper.h:160</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiSystem_html"><div class="ttname"><a href="classgismo_1_1gsIetiSystem.html">gismo::gsIetiSystem</a></div><div class="ttdoc">This class represents a IETI system.</div><div class="ttdef"><b>Definition</b> gsIetiSystem.h:70</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiSystem_html_a2c659ba1577c256572087a2c5dc17e0f"><div class="ttname"><a href="classgismo_1_1gsIetiSystem.html#a2c659ba1577c256572087a2c5dc17e0f">gismo::gsIetiSystem::saddlePointProblem</a></div><div class="ttdeci">OpPtr saddlePointProblem() const</div><div class="ttdoc">Returns gsLinearOperator that represents the IETI problem as saddle point problem.</div><div class="ttdef"><b>Definition</b> gsIetiSystem.hpp:68</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiSystem_html_a61e3b879da178aeaf79e2db044df337e"><div class="ttname"><a href="classgismo_1_1gsIetiSystem.html#a61e3b879da178aeaf79e2db044df337e">gismo::gsIetiSystem::addSubdomain</a></div><div class="ttdeci">void addSubdomain(JumpMatrixPtr jumpMatrix, OpPtr localMatrixOp, Matrix localRhs, OpPtr localSolverOp=OpPtr())</div><div class="ttdef"><b>Definition</b> gsIetiSystem.hpp:32</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiSystem_html_a74802ed17847ec5d250011006c43590e"><div class="ttname"><a href="classgismo_1_1gsIetiSystem.html#a74802ed17847ec5d250011006c43590e">gismo::gsIetiSystem::constructSolutionFromSaddlePoint</a></div><div class="ttdeci">std::vector&lt; Matrix &gt; constructSolutionFromSaddlePoint(const Matrix &amp;x) const</div><div class="ttdoc">Returns the local solutions for the individual subdomains.</div><div class="ttdef"><b>Definition</b> gsIetiSystem.hpp:141</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiSystem_html_a7ebf485c8ffc385c75b2a9369edabd49"><div class="ttname"><a href="classgismo_1_1gsIetiSystem.html#a7ebf485c8ffc385c75b2a9369edabd49">gismo::gsIetiSystem::reserve</a></div><div class="ttdeci">void reserve(index_t n)</div><div class="ttdoc">Reserves the memory required to store the number of subdomains.</div><div class="ttdef"><b>Definition</b> gsIetiSystem.hpp:23</div></div>
<div class="ttc" id="aclassgismo_1_1gsIetiSystem_html_ae7d8a1beda1608ab24c059e0c2ee4aea"><div class="ttname"><a href="classgismo_1_1gsIetiSystem.html#ae7d8a1beda1608ab24c059e0c2ee4aea">gismo::gsIetiSystem::rhsForSaddlePoint</a></div><div class="ttdeci">Matrix rhsForSaddlePoint() const</div><div class="ttdoc">Returns the right-hand-side that is required for the saddle point formulation of the IETI problem.</div><div class="ttdef"><b>Definition</b> gsIetiSystem.hpp:122</div></div>
<div class="ttc" id="aclassgismo_1_1gsIterativeSolver_html_a6e04b51fc392c977e044b1c25f9d32c6"><div class="ttname"><a href="classgismo_1_1gsIterativeSolver.html#a6e04b51fc392c977e044b1c25f9d32c6">gismo::gsIterativeSolver::solveDetailed</a></div><div class="ttdeci">void solveDetailed(const VectorType &amp;rhs, VectorType &amp;x, VectorType &amp;error_history)</div><div class="ttdoc">Solves the linear system and stores the solution in x and records the error histroy.</div><div class="ttdef"><b>Definition</b> gsIterativeSolver.h:134</div></div>
<div class="ttc" id="aclassgismo_1_1gsLinearOperator_html_a7e083f6c92575f77236d6cb193997e84"><div class="ttname"><a href="classgismo_1_1gsLinearOperator.html#a7e083f6c92575f77236d6cb193997e84">gismo::gsLinearOperator::Ptr</a></div><div class="ttdeci">memory::shared_ptr&lt; gsLinearOperator &gt; Ptr</div><div class="ttdoc">Shared pointer for gsLinearOperator.</div><div class="ttdef"><b>Definition</b> gsLinearOperator.h:33</div></div>
<div class="ttc" id="aclassgismo_1_1gsMatrix_html"><div class="ttname"><a href="classgismo_1_1gsMatrix.html">gismo::gsMatrix</a></div><div class="ttdoc">A matrix with arbitrary coefficient type and fixed or dynamic size.</div><div class="ttdef"><b>Definition</b> gsMatrix.h:41</div></div>
<div class="ttc" id="aclassgismo_1_1gsMinimalResidual_html"><div class="ttname"><a href="classgismo_1_1gsMinimalResidual.html">gismo::gsMinimalResidual</a></div><div class="ttdoc">The minimal residual (MinRes) method.</div><div class="ttdef"><b>Definition</b> gsMinimalResidual.h:26</div></div>
<div class="ttc" id="aclassgismo_1_1gsMinimalResidual_html_ac980000b9a6e7563b5f637ffe76f5176"><div class="ttname"><a href="classgismo_1_1gsMinimalResidual.html#ac980000b9a6e7563b5f637ffe76f5176">gismo::gsMinimalResidual::setOptions</a></div><div class="ttdeci">gsMinimalResidual &amp; setOptions(const gsOptionList &amp;opt)</div><div class="ttdoc">Set the options based on a gsOptionList.</div><div class="ttdef"><b>Definition</b> gsMinimalResidual.h:71</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiBasis_html"><div class="ttname"><a href="classgismo_1_1gsMultiBasis.html">gismo::gsMultiBasis</a></div><div class="ttdoc">Holds a set of patch-wise bases and their topology information.</div><div class="ttdef"><b>Definition</b> gsMultiBasis.h:37</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiPatch_html"><div class="ttname"><a href="classgismo_1_1gsMultiPatch.html">gismo::gsMultiPatch</a></div><div class="ttdoc">Container class for a set of geometry patches and their topology, that is, the interface connections ...</div><div class="ttdef"><b>Definition</b> gsMultiPatch.h:100</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiPatch_html_a9fbe98882789c00c743d121b7f59df52"><div class="ttname"><a href="classgismo_1_1gsMultiPatch.html#a9fbe98882789c00c743d121b7f59df52">gismo::gsMultiPatch::addPatch</a></div><div class="ttdeci">index_t addPatch(typename gsGeometry&lt; T &gt;::uPtr g)</div><div class="ttdoc">Add a patch from a gsGeometry&lt;T&gt;::uPtr.</div><div class="ttdef"><b>Definition</b> gsMultiPatch.hpp:211</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiPatch_html_ad7190c68d8ead80bd1b6fd7256779894"><div class="ttname"><a href="classgismo_1_1gsMultiPatch.html#ad7190c68d8ead80bd1b6fd7256779894">gismo::gsMultiPatch::uPtr</a></div><div class="ttdeci">memory::unique_ptr&lt; gsMultiPatch &gt; uPtr</div><div class="ttdoc">Unique pointer for gsMultiPatch.</div><div class="ttdef"><b>Definition</b> gsMultiPatch.h:109</div></div>
<div class="ttc" id="aclassgismo_1_1gsPoissonAssembler_html"><div class="ttname"><a href="classgismo_1_1gsPoissonAssembler.html">gismo::gsPoissonAssembler</a></div><div class="ttdoc">Implementation of an (multiple right-hand side) Poisson assembler.</div><div class="ttdef"><b>Definition</b> gsPoissonAssembler.h:37</div></div>
<div class="ttc" id="aclassgismo_1_1gsPrimalSystem_html"><div class="ttname"><a href="classgismo_1_1gsPrimalSystem.html">gismo::gsPrimalSystem</a></div><div class="ttdoc">This class represents the primal system for a IETI-DP algorithm.</div><div class="ttdef"><b>Definition</b> gsPrimalSystem.h:87</div></div>
<div class="ttc" id="aclassgismo_1_1gsPrimalSystem_html_a482be3533fb0f8c77f73a9d13bd92085"><div class="ttname"><a href="classgismo_1_1gsPrimalSystem.html#a482be3533fb0f8c77f73a9d13bd92085">gismo::gsPrimalSystem::incorporateConstraints</a></div><div class="ttdeci">static void incorporateConstraints(const std::vector&lt; SparseVector &gt; &amp;primalConstraints, bool eliminatePointwiseConstraints, const SparseMatrix &amp;localMatrix, SparseMatrix &amp;modifiedLocalMatrix, SparseMatrix &amp;localEmbedding, SparseMatrix &amp;embeddingForBasis, Matrix &amp;rhsForBasis)</div><div class="ttdoc">Incorporates the given constraints in the local system.</div><div class="ttdef"><b>Definition</b> gsPrimalSystem.hpp:27</div></div>
<div class="ttc" id="aclassgismo_1_1gsReadFile_html"><div class="ttname"><a href="classgismo_1_1gsReadFile.html">gismo::gsReadFile</a></div><div class="ttdoc">Reads an object from a data file, if such the requested object exists in the file.</div><div class="ttdef"><b>Definition</b> gsReadFile.h:43</div></div>
<div class="ttc" id="aclassgismo_1_1gsScaledDirichletPrec_html"><div class="ttname"><a href="classgismo_1_1gsScaledDirichletPrec.html">gismo::gsScaledDirichletPrec</a></div><div class="ttdoc">This class represents the scaled Dirichlet preconditioner for a IETI problem.</div><div class="ttdef"><b>Definition</b> gsScaledDirichletPrec.h:79</div></div>
<div class="ttc" id="aclassgismo_1_1gsScaledDirichletPrec_html_a2b5388ceb650e63fe7f570f2e3ce3326"><div class="ttname"><a href="classgismo_1_1gsScaledDirichletPrec.html#a2b5388ceb650e63fe7f570f2e3ce3326">gismo::gsScaledDirichletPrec::preconditioner</a></div><div class="ttdeci">OpPtr preconditioner() const</div><div class="ttdoc">This returns the preconditioner as gsLinearOperator.</div><div class="ttdef"><b>Definition</b> gsScaledDirichletPrec.hpp:176</div></div>
<div class="ttc" id="aclassgismo_1_1gsScaledDirichletPrec_html_a6576e33b303fa0efb7b7ef8e3a6bc3f9"><div class="ttname"><a href="classgismo_1_1gsScaledDirichletPrec.html#a6576e33b303fa0efb7b7ef8e3a6bc3f9">gismo::gsScaledDirichletPrec::addSubdomain</a></div><div class="ttdeci">void addSubdomain(JumpMatrixPtr jumpMatrix, OpPtr localSchurOp)</div><div class="ttdef"><b>Definition</b> gsScaledDirichletPrec.h:107</div></div>
<div class="ttc" id="aclassgismo_1_1gsScaledDirichletPrec_html_a7ebf485c8ffc385c75b2a9369edabd49"><div class="ttname"><a href="classgismo_1_1gsScaledDirichletPrec.html#a7ebf485c8ffc385c75b2a9369edabd49">gismo::gsScaledDirichletPrec::reserve</a></div><div class="ttdeci">void reserve(index_t n)</div><div class="ttdoc">Reserves the memory required to store the given number of subdomain.</div><div class="ttdef"><b>Definition</b> gsScaledDirichletPrec.h:90</div></div>
<div class="ttc" id="aclassgismo_1_1gsScaledDirichletPrec_html_a9219afc9dd280538e2ec3fcb4dea4e40"><div class="ttname"><a href="classgismo_1_1gsScaledDirichletPrec.html#a9219afc9dd280538e2ec3fcb4dea4e40">gismo::gsScaledDirichletPrec::restrictJumpMatrix</a></div><div class="ttdeci">static JumpMatrix restrictJumpMatrix(const JumpMatrix &amp;jumpMatrix, const std::vector&lt; index_t &gt; &amp;dofs)</div><div class="ttdoc">Restricts the jump matrix to the given dofs.</div><div class="ttdef"><b>Definition</b> gsScaledDirichletPrec.hpp:36</div></div>
<div class="ttc" id="aclassgismo_1_1gsScaledDirichletPrec_html_acaa221022cd4b0107af70d2e4d354699"><div class="ttname"><a href="classgismo_1_1gsScaledDirichletPrec.html#acaa221022cd4b0107af70d2e4d354699">gismo::gsScaledDirichletPrec::setupMultiplicityScaling</a></div><div class="ttdeci">void setupMultiplicityScaling()</div><div class="ttdoc">This sets up the member vector localScaling based on multiplicity scaling.</div><div class="ttdef"><b>Definition</b> gsScaledDirichletPrec.hpp:149</div></div>
<div class="ttc" id="aclassgismo_1_1gsScaledDirichletPrec_html_adfac85e147606b452a85b2881ebb3a6b"><div class="ttname"><a href="classgismo_1_1gsScaledDirichletPrec.html#adfac85e147606b452a85b2881ebb3a6b">gismo::gsScaledDirichletPrec::matrixBlocks</a></div><div class="ttdeci">static Blocks matrixBlocks(const SparseMatrix &amp;localMatrix, const std::vector&lt; index_t &gt; &amp;dofs)</div><div class="ttdoc">Computes the matrix blocks with respect to the given dofs.</div><div class="ttdef"><b>Definition</b> gsScaledDirichletPrec.hpp:64</div></div>
<div class="ttc" id="aclassgismo_1_1gsSparseMatrix_html"><div class="ttname"><a href="classgismo_1_1gsSparseMatrix.html">gismo::gsSparseMatrix</a></div><div class="ttdoc">Sparse matrix class, based on gsEigen::SparseMatrix.</div><div class="ttdef"><b>Definition</b> gsSparseMatrix.h:139</div></div>
<div class="ttc" id="aclassgismo_1_1gsSparseMatrix_html_a24da616b328c15186de32aa2c9a51938"><div class="ttname"><a href="classgismo_1_1gsSparseMatrix.html#a24da616b328c15186de32aa2c9a51938">gismo::gsSparseMatrix::moveToPtr</a></div><div class="ttdeci">uPtr moveToPtr()</div><div class="ttdoc">This function returns a smart pointer to the matrix. After calling it, the matrix object becomes empt...</div><div class="ttdef"><b>Definition</b> gsSparseMatrix.h:247</div></div>
<div class="ttc" id="aclassgismo_1_1gsSparseSystem_html"><div class="ttname"><a href="classgismo_1_1gsSparseSystem.html">gismo::gsSparseSystem</a></div><div class="ttdoc">A sparse linear system indexed by sets of degrees of freedom.</div><div class="ttdef"><b>Definition</b> gsSparseSystem.h:30</div></div>
<div class="ttc" id="agismo_8h_html"><div class="ttname"><a href="gismo_8h.html">gismo.h</a></div><div class="ttdoc">Main header to be included by clients using the G+Smo library.</div></div>
<div class="ttc" id="agsConfig_8h_html_ad722078677c063a09661059674fb996c"><div class="ttname"><a href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a></div><div class="ttdeci">#define index_t</div><div class="ttdef"><b>Definition</b> gsConfig.h:32</div></div>
<div class="ttc" id="agsDebug_8h_html_af6177e1e282640c3cb9175565f84a432"><div class="ttname"><a href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a></div><div class="ttdeci">#define gsInfo</div><div class="ttdef"><b>Definition</b> gsDebug.h:43</div></div>
<div class="ttc" id="anamespacegismo_html"><div class="ttname"><a href="namespacegismo.html">gismo</a></div><div class="ttdoc">The G+Smo namespace, containing all definitions for the library.</div></div>
<div class="ttc" id="anamespacegismo_html_ab72442c3b5aeef49b3c60f6e9df77110"><div class="ttname"><a href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">gismo::give</a></div><div class="ttdeci">S give(S &amp;x)</div><div class="ttdef"><b>Definition</b> gsMemory.h:266</div></div>
<div class="ttc" id="astructgismo_1_1condition__type_html_a7aead736a07eaf25623ad7bfa1f0ee2da1b4f535d1f53363637f933002efc2b4b"><div class="ttname"><a href="structgismo_1_1condition__type.html#a7aead736a07eaf25623ad7bfa1f0ee2da1b4f535d1f53363637f933002efc2b4b">gismo::condition_type::dirichlet</a></div><div class="ttdeci">@ dirichlet</div><div class="ttdoc">Dirichlet type.</div><div class="ttdef"><b>Definition</b> gsBoundaryConditions.h:31</div></div>
<div class="ttc" id="astructgismo_1_1condition__type_html_a7aead736a07eaf25623ad7bfa1f0ee2da8e855db37d5c0fbd8eda96b2f51b8b20"><div class="ttname"><a href="structgismo_1_1condition__type.html#a7aead736a07eaf25623ad7bfa1f0ee2da8e855db37d5c0fbd8eda96b2f51b8b20">gismo::condition_type::neumann</a></div><div class="ttdeci">@ neumann</div><div class="ttdoc">Neumann type.</div><div class="ttdef"><b>Definition</b> gsBoundaryConditions.h:33</div></div>
<div class="ttc" id="astructgismo_1_1gsScaledDirichletPrec_1_1Blocks_html"><div class="ttname"><a href="structgismo_1_1gsScaledDirichletPrec_1_1Blocks.html">gismo::gsScaledDirichletPrec::Blocks</a></div><div class="ttdef"><b>Definition</b> gsScaledDirichletPrec.h:148</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Jan 20 2025 09:35:27 for G+Smo by Doxygen v1.9.8 </li>
  </ul>
</div>
<!-- Piwik --> 
<!--
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? "https://stats.sylphide-consulting.com/piwik/" : "http://stats.sylphide-consulting.com/piwik/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 20);
piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
</script><noscript><p><img src="http://stats.sylphide-consulting.com/piwik/piwik.php?idsite=20" style="border:0" alt="" /></p></noscript>
-->
<!-- End Piwik Tracking Code -->
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<title>G+Smo: fitting_example.cpp</title>
<link href="gismodoxy_tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://people.ricam.oeaw.ac.at/gismo/mj/MathJax.js"></script>
<link href="doxygen.css"   rel="stylesheet" type="text/css" />
<link href="gismodoxy.css" rel="stylesheet" type="text/css">
<!--  -->
<!-- <script type="text/javascript"> -->
<!-- </script> -->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- <a name="top"></a> -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="gslogo-doxy.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname"><a href="index.html"><font style="font-variant:small-caps;">G+S</font><font style="font-variant:small-caps;"
															    color="#000000">mo</font></a>
   &#160;<span id="projectnumber">25.01.0</span>
   </div>
   <div id="projectbrief">Geometry + Simulation Modules</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('fitting_example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">fitting_example.cpp</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The spline data fitting problem can be mathematically described as follows.</p>
<p>Given a (noisy) data set of the form,  </p><p class="formulaDsp">
\begin{eqnarray*}
        \mathrm{P} = \{\mathbf{p}_i\in\mathbb{R}^N \, \vert\, i = 0, \ldots, m-1\},
\end{eqnarray*}
</p>
<p> where \(N=2\) for data points laying a plane and \(N=3\) for data points which belong to the three-dimensional space, find a spline model \(\mathbf{s}: \Omega\subseteq\mathbb{R}^D\to\mathbb{R}^N\), which approximates the data \(\mathrm{P}\) within a certain tolerance \(\epsilon\in\mathbb{R}_{&gt;0}\), in the sense that, for each \(i=0, \ldots, m-1\),  </p><p class="formulaDsp">
\begin{eqnarray*}
    \mathrm{dist}\left(\mathbf{s}_i, \mathbf{p}_i\right) \leq \epsilon,
\end{eqnarray*}
</p>
<p> where \(\mathbf{s}_i\) denotes a point on the geometric model associated with the data point \(\mathbf{p}_i\), and \(\mathrm{dist}\left(\cdot,\cdot\right)\) is a certain distance metric.</p>
<p>Therefore, the (TH)B-spline fitting problem can be stated in the following way. Given a point cloud \(\mathrm{P}\) and an error tolerance \(\epsilon &gt; 0\), find a (TH)B-spline model \(\mathbf{s}:\Omega\subseteq\mathbb{R}^D \to \mathbb{R}^N\), so that  </p><p class="formulaDsp">
\begin{eqnarray*}
        \mathrm{dist}\left(\mathbf{s}(\mathbf{u}_i), \mathbf{p}_i\right) \leq \epsilon, \quad  \text{with}\, \mathbf{u}_i\in\Omega, \quad \text{for each}\quad i=0, \ldots, m-1,
\end{eqnarray*}
</p>
<p> where \(\mathbf{u}_i\) denotes a point on the parametric domain \(\Omega\) associated with the data point \(\mathbf{p}_i\).</p>
<h1><a class="anchor" id="alg01"></a>
Leveraging moving parameterization and adaptive THB-splines for CAD surface reconstruction</h1>
<p>Given a point cloud \(\mathrm{P}= \{\mathbf{p}_i\in\mathbb{R}^3 \, \vert\, i = 0, \ldots, m-1\}\), its parametrization \(\mathrm{U} = \{\mathbf{u}_i\in\Omega\subset\mathbb{R}^2 \, \vert\, i = 0, \ldots, m-1\}\), once an initial parameter and mesh configuration is chosen, the adaptive (TH)B-spline fitting procedure is characterised by four main steps, which are successively repeated:</p><ul>
<li>(1) SOLVE: computation of the approximation on the current mesh,</li>
<li>(2) ESTIMATE: error estimation,</li>
<li>(3) MARK: marking the mesh elements with a too high error,</li>
<li>(4) REFINE: refinement strategies to suitably identify the adaptive mesh to be used in the next iteration of the adaptive loop.</li>
</ul>
<h2><a class="anchor" id="sec01"></a>
SOLVE</h2>
<p>For a fixed THB-spline space \(V\), the first step of the adaptive loop consists in finding \(\mathbf{s}\in V\), that solves the penalized least squares problem  </p><p class="formulaDsp">
\begin{eqnarray*}
    \mathbf{s} = \arg\min_{\mathbf{v}\in V}\frac{1}{2}\sum_{i=0}^{m-1}\left\| \mathbf{v}\left(\mathbf{u}_i\right) - \mathbf{p}_i\right\|_2^2 + \lambda J\left(\mathbf{v}\right),
\end{eqnarray*}
</p>
<p> where the penalization term \(J\) is the thin-plate energy functional, whose influence is controlled by a weight \(\lambda \geq 0\), i.e. for \(\mathbf{u} = (u,v)\in\Omega\),  </p><p class="formulaDsp">
\begin{eqnarray*}
J\left(\mathbf{s}\right) = \int_{\Omega}\left\|\frac{\partial^2\mathbf{s}}{\partial u\partial u}\right\|_2^2 + 2\left\|\frac{\partial^2\mathbf{s}}{\partial u\partial v}\right\|_2^2 + \left\|\frac{\partial^2\mathbf{s}}{\partial v\partial v}\right\|_2^2 \mbox{d}u\mbox{d}v.
\end{eqnarray*}
</p>
<h2><a class="anchor" id="sec02"></a>
ESTIMATE</h2>
<p>Subsequently, the second step of the adaptive fitting loop consists of evaluating the THB-spline approximant on the parameter sites \(\mathbf{u}_i\in\Omega\) related to the data points \(\mathbf{p}_i\) to compute a suitable error indicator.</p>
<p>In particular, we choose the point-wise error distance \(\left\|\mathbf{s}(\mathbf{u}_i) - \mathbf{p}_i\right\|_2\) for each \(i=0, \ldots, m-1\), among others. The error indicator indicates the region of the domain \(\Omega\) where additional degrees of freedom are needed to meet the prescribed surface accuracy, by individuating the parametric sites \(\mathbf{u}_i \in U\) where it exceeds a certain input threshold, i.e.</p>
<p class="formulaDsp">
\begin{eqnarray*}
    \left\|\mathbf{s}(\mathbf{u}_i) - \mathbf{p}_i\right\|_2 \geq \epsilon.
\end{eqnarray*}
</p>
<h2><a class="anchor" id="sec03"></a>
MARK &amp; REFINE</h2>
<p>Therefore, we identify the cells of the current hierarchical level which contain the parameters \(\mathbf{u}_i\) identified by the error indicator and mark them for refinement, together with <em>ext</em> surrounding rings of cells in the hierarchical mesh. Finally, the marked cells are dyadically split, according to the possible hierarchical configurations. </p><div class="image">
<img src="mark-ref-ext.png" alt=""/>
<div class="caption">
Marking and refinement of cells in the hierarchical mesh, with <em>ext</em> = 2 and bi-degree (2,2).</div></div>
<h2><a class="anchor" id="sec04"></a>
MOVING PARAMETERS</h2>
<p>In the context of surface fitting, the parameters update within the described adaptive methodology is performed by adding a parameter correction (PC) routine, at the end of the standard adaptive loop. This method consists of locating the points on the geometric model which are the closest to the data points, in terms of Euclidean distance.</p>
<p>Given a point cloud \(P\), its parameterization \(U\) and a surface \(\mathbf{s}: \Omega\subset\mathbb{R}^2 \to \mathbb{R}^3\), the surface closest point problem consists in solving the following minimization problem,  </p><p class="formulaDsp">
\begin{eqnarray*}
    \min_{\left(u_i, v_i\right)}\frac{1}{2}\left\|\mathbf{s}\left(u_i, v_i\right) - \mathbf{p}_i\right\|_2^2,\ 
    \quad \text{for each}\ i=0,\ldots,m-1.
\end{eqnarray*}
</p>
<p> This two-dimensional nonlinear problem can be explicitly formulated as  </p><p class="formulaDsp">
\begin{eqnarray*}
    \left(\mathbf{s}\left(u_i, v_i\right) - \mathbf{p}_i\right)^{\top} \nabla \mathbf{s}\left(u_i, v_i\right) = 0
\end{eqnarray*}
</p>
<p> for each \(i=0,\ldots, m-1\), where \(\nabla\mathbf{s}\) indicates the gradient of the surface \(\mathbf{s}\), and solved by employing a suitable optimizer.</p>
<p>The vector connecting the data point \(\mathbf{p}_i\) to the surface point \(\mathbf{s}(u_i, v_i)\) has to be orthogonal to the tangent plane of the surface and \(\mathbf{s}\left( {u}_i, {v}_i\right)\) is then usually called the foot-point of \(\mathbf{p}_i\) over \(\mathbf{s}\) for each \(i=0, \ldots, m-1\). The updated parameterization \(\bar{\mathbf{u}}_i = \left( \bar{u}_i, \bar{v}_i\right)\) is defined as the solution the minimization problem, for \(i=0,\ldots, m-1\). Note that after performing one step of PC, the geometric model can be updated by fitting again the surface \(\mathbf{s}\) to the points \(P\) with the corrected parameters. Consequently, a new projection and the corresponding correction can take place. </p><div class="image">
<img src="projection.png" alt=""/>
<div class="caption">
Parameter correction.</div></div>
<h1><a class="anchor" id="exm01"></a>
Leveraging moving parameterization and adaptive THB-splines in G+Smo</h1>
<p>In this example, we show how to fit an adaptive THB-spline surface to an input 3D point cloud.</p>
<p>First we include the library and use the gismo namespace. </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="gismo_8h.html">gismo.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacegismo.html">gismo</a>;</div>
<div class="ttc" id="agismo_8h_html"><div class="ttname"><a href="gismo_8h.html">gismo.h</a></div><div class="ttdoc">Main header to be included by clients using the G+Smo library.</div></div>
<div class="ttc" id="anamespacegismo_html"><div class="ttname"><a href="namespacegismo.html">gismo</a></div><div class="ttdoc">The G+Smo namespace, containing all definitions for the library.</div></div>
</div><!-- fragment --><p>Then we define our command line options. For example, we use the options</p><ul>
<li><code>-d</code> or <code>--data</code> to set the path to the file that contains our parameterized point cloud;</li>
<li><code>-e</code> or <code>--epsilon</code> to set the error tolerance;</li>
<li><code>-s</code> or <code>--lambda</code> to set the weight of the thin-plate energy functional;</li>
<li><code>-c</code> or <code>--parcor</code> to set the number of parameter correction steps;</li>
<li><code>-i</code> or <code>--iter</code> to set the number of adaptive refinement loops;</li>
<li><code>-p</code> or <code>--refPercent</code> to set the percentage of points to refine in each iteration;</li>
<li>...</li>
</ul>
<div class="fragment"><div class="line">    <a class="code hl_class" href="classgismo_1_1gsCmdLine.html">gsCmdLine</a> cmd(<span class="stringliteral">&quot;Fit parametrized sample data with a surface patch. Expected input file is an XML &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;file containing two matrices (&lt;Matrix&gt;), with \nMatrix id 0 : contains a 2 x N matrix. &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;Every column represents a (u,v) parametric coordinate\nMatrix id 1 : contains a &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;3 x N matrix. Every column represents a point (x,y,z) in space.&quot;</span>);</div>
<div class="line">    cmd.addSwitch(<span class="stringliteral">&quot;save&quot;</span>, <span class="stringliteral">&quot;Save result in XML format&quot;</span>, save);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;parcor&quot;</span>, <span class="stringliteral">&quot;Steps of parameter correction&quot;</span>, maxPcIter);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;i&quot;</span>, <span class="stringliteral">&quot;iter&quot;</span>, <span class="stringliteral">&quot;number of iterations&quot;</span>, iter);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;deg_x&quot;</span>, <span class="stringliteral">&quot;degree in x direction&quot;</span>, deg_x);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;y&quot;</span>, <span class="stringliteral">&quot;deg_y&quot;</span>, <span class="stringliteral">&quot;degree in y direction&quot;</span>, deg_y);</div>
<div class="line">    cmd.addReal(<span class="stringliteral">&quot;s&quot;</span>, <span class="stringliteral">&quot;lambda&quot;</span>, <span class="stringliteral">&quot;smoothing coefficient&quot;</span>, lambda);</div>
<div class="line">    cmd.addReal(<span class="stringliteral">&quot;t&quot;</span>, <span class="stringliteral">&quot;threshold&quot;</span>, <span class="stringliteral">&quot;error threshold (special valule -1)&quot;</span>, threshold);</div>
<div class="line">    cmd.addReal(<span class="stringliteral">&quot;p&quot;</span>, <span class="stringliteral">&quot;refPercent&quot;</span>, <span class="stringliteral">&quot;percentage of points to refine in each iteration&quot;</span>, refPercent);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;q&quot;</span>, <span class="stringliteral">&quot;extension&quot;</span>, <span class="stringliteral">&quot;extension size&quot;</span>, extension);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;r&quot;</span>, <span class="stringliteral">&quot;urefine&quot;</span>, <span class="stringliteral">&quot;initial uniform refinement steps&quot;</span>, numURef);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;n&quot;</span>, <span class="stringliteral">&quot;iknots&quot;</span>, <span class="stringliteral">&quot;number of interior knots in each direction&quot;</span>, numKnots);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;uknots&quot;</span>, <span class="stringliteral">&quot;number of interior knots in u-direction&quot;</span>, nx);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;vknots&quot;</span>, <span class="stringliteral">&quot;number of interior knots in v-direction&quot;</span>, ny);</div>
<div class="line">    cmd.addReal(<span class="stringliteral">&quot;e&quot;</span>, <span class="stringliteral">&quot;tolerance&quot;</span>, <span class="stringliteral">&quot;error tolerance (desired upper bound for pointwise error)&quot;</span>, tolerance);</div>
<div class="line">    cmd.addString(<span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;data&quot;</span>, <span class="stringliteral">&quot;Input sample data&quot;</span>, fn);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">try</span> { cmd.getValues(argc,argv); } <span class="keywordflow">catch</span> (<span class="keywordtype">int</span> rv) { <span class="keywordflow">return</span> rv; }</div>
<div class="ttc" id="aclassgismo_1_1gsCmdLine_html"><div class="ttname"><a href="classgismo_1_1gsCmdLine.html">gismo::gsCmdLine</a></div><div class="ttdoc">Class for command-line argument parsing.</div><div class="ttdef"><b>Definition</b> gsCmdLine.h:57</div></div>
</div><!-- fragment --><p>Then we read the input from the file that contains the parametrized point cloud. In this example, we use the function <a class="el" href="classgismo_1_1gsFileData.html#a123e8172ab69505a92db3d9b61c77437" title="Searches and fetches the Gismo object with a given id.">gsFileData::getId()</a> to read input from an <code>xml</code> file. In this function, the first argument specifies the ID of the object in the <code>xml</code> file (the <code>id</code> flag) and the second argument is the object to which the file info is written. </p><div class="fragment"><div class="line">    <span class="comment">// Surface fitting</span></div>
<div class="line">    <span class="comment">// Expected input is a file with matrices with:</span></div>
<div class="line">    <span class="comment">// id 0:  u,v   -- parametric coordinates, size 2 x N</span></div>
<div class="line">    <span class="comment">// id 1:  x,y,z -- corresponding mapped values, size 3 x N</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsFileData.html">gsFileData&lt;&gt;</a> fd_in(fn);</div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a> uv, xyz;</div>
<div class="line">    fd_in.getId&lt;<a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a> &gt;(0, uv );</div>
<div class="line">    fd_in.getId&lt;<a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a> &gt;(1, xyz);</div>
<div class="ttc" id="aclassgismo_1_1gsFileData_html"><div class="ttname"><a href="classgismo_1_1gsFileData.html">gismo::gsFileData</a></div><div class="ttdoc">This class represents an XML data tree which can be read from or written to a (file) stream.</div><div class="ttdef"><b>Definition</b> gsFileData.h:34</div></div>
<div class="ttc" id="aclassgismo_1_1gsMatrix_html"><div class="ttname"><a href="classgismo_1_1gsMatrix.html">gismo::gsMatrix</a></div><div class="ttdoc">A matrix with arbitrary coefficient type and fixed or dynamic size.</div><div class="ttdef"><b>Definition</b> gsMatrix.h:41</div></div>
</div><!-- fragment --><p>Set the initial mesh configuration and THB spline space, </p><div class="fragment"><div class="line">    <span class="comment">// Create knot-vectors without interior knots</span></div>
<div class="line">    <span class="keywordflow">if</span>( nx &lt; 0)</div>
<div class="line">      nx = numKnots;</div>
<div class="line">    <span class="keywordflow">if</span>( ny &lt; 0)</div>
<div class="line">      ny = numKnots;</div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsKnotVector.html">gsKnotVector&lt;&gt;</a> u_knots (u_min, u_max, nx, deg_x+1 ) ;</div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsKnotVector.html">gsKnotVector&lt;&gt;</a> v_knots (v_min, v_max, ny, deg_y+1 ) ;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create a tensor-basis nad apply initial uniform refinement</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsTensorBSplineBasis.html">gsTensorBSplineBasis&lt;2&gt;</a> T_tbasis( u_knots, v_knots );</div>
<div class="line">    T_tbasis.uniformRefine( (1&lt;&lt;numURef)-1 );</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create Initial hierarchical basis</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsTHBSplineBasis.html">gsTHBSplineBasis&lt;2&gt;</a>  THB ( T_tbasis ) ;</div>
<div class="ttc" id="aclassgismo_1_1gsKnotVector_html"><div class="ttname"><a href="classgismo_1_1gsKnotVector.html">gismo::gsKnotVector</a></div><div class="ttdoc">Class for representing a knot vector.</div><div class="ttdef"><b>Definition</b> gsKnotVector.h:80</div></div>
<div class="ttc" id="aclassgismo_1_1gsTHBSplineBasis_html"><div class="ttname"><a href="classgismo_1_1gsTHBSplineBasis.html">gismo::gsTHBSplineBasis</a></div><div class="ttdoc">Truncated hierarchical B-spline basis.</div><div class="ttdef"><b>Definition</b> gsTHBSplineBasis.h:36</div></div>
<div class="ttc" id="aclassgismo_1_1gsTensorBSplineBasis_html"><div class="ttname"><a href="classgismo_1_1gsTensorBSplineBasis.html">gismo::gsTensorBSplineBasis</a></div><div class="ttdoc">A tensor product B-spline basis.</div><div class="ttdef"><b>Definition</b> gsTensorBSplineBasis.h:37</div></div>
</div><!-- fragment --><p>as well as the fitting object. </p><div class="fragment"><div class="line">    <span class="comment">// Create hierarchical refinement object</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsHFitting.html">gsHFitting&lt;2, real_t&gt;</a> ref( uv, xyz, THB, refPercent, ext, lambda);</div>
<div class="ttc" id="aclassgismo_1_1gsHFitting_html"><div class="ttname"><a href="classgismo_1_1gsHFitting.html">gismo::gsHFitting</a></div><div class="ttdoc">This class applies hierarchical fitting of parametrized point clouds.</div><div class="ttdef"><b>Definition</b> gsHFitting.h:35</div></div>
</div><!-- fragment --><p>Perform the adaptive loop: </p><div class="fragment"><div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt;= iter; i++)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;----------------\n&quot;</span>;</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;Iteration &quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot;..&quot;</span>&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">        time.restart();</div>
<div class="line">        ref.nextIteration(tolerance, threshold, maxPcIter);</div>
<div class="line">        time.stop();</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;Fitting time: &quot;</span>&lt;&lt; time &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;Fitted with &quot;</span>&lt;&lt; ref.result()-&gt;basis() &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;Min distance : &quot;</span>&lt;&lt; ref.minPointError() &lt;&lt;<span class="stringliteral">&quot; / &quot;</span>;</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;Max distance : &quot;</span>&lt;&lt; ref.maxPointError() &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;Points below tolerance: &quot;</span>&lt;&lt; 100.0 * ref.numPointsBelow(tolerance)/errors.size()&lt;&lt;<span class="stringliteral">&quot;%.\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ( ref.maxPointError() &lt; tolerance )</div>
<div class="line">        {</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;Error tolerance achieved after &quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot; iterations.\n&quot;</span>;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="ttc" id="agsDebug_8h_html_af6177e1e282640c3cb9175565f84a432"><div class="ttname"><a href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a></div><div class="ttdeci">#define gsInfo</div><div class="ttdef"><b>Definition</b> gsDebug.h:43</div></div>
</div><!-- fragment --><p>Finally, export the results to ParaView. </p><div class="fragment"><div class="line">    <span class="keywordflow">if</span> ( save )</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;Done. Writing solution to file fitting_out.xml\n&quot;</span>;</div>
<div class="line">        fd &lt;&lt; *ref.result() ;</div>
<div class="line"> </div>
<div class="line">        fd.dump(<span class="stringliteral">&quot;fitting_out&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Done. No output created, re-run with --save to get a xml &quot;</span></div>
<div class="line">                  <span class="stringliteral">&quot;file containing the solution.\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
</div><!-- fragment --><h1><a class="anchor" id="fitting_exampleAnnotated"></a>
Annotated source file</h1>
<p>Here is the full file <code>examples/fitting_example.cpp</code>. Clicking on a function or class name will lead you to its reference documentation.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="gismo_8h.html">gismo.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacegismo.html">gismo</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Options with default values</span></div>
<div class="line">    <span class="keywordtype">bool</span> save     = <span class="keyword">false</span>;  <span class="comment">// save</span></div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> numURef   = 0;  <span class="comment">// r</span></div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> numKnots   = 0; <span class="comment">// n</span></div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> nx   = -1; <span class="comment">// a</span></div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> ny   = -1; <span class="comment">// b</span></div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> iter      = 2;  <span class="comment">// i</span></div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> deg_x     = 2;  <span class="comment">// x</span></div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> deg_y     = 2;  <span class="comment">// y</span></div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> maxPcIter = 0;  <span class="comment">// c</span></div>
<div class="line">    real_t lambda = 1e-06;  <span class="comment">// s</span></div>
<div class="line">    real_t threshold = 1e-02; <span class="comment">// t</span></div>
<div class="line">    real_t tolerance = 1e-02; <span class="comment">// e</span></div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> extension = 2;  <span class="comment">// q</span></div>
<div class="line">    real_t refPercent = 0.1;<span class="comment">// p</span></div>
<div class="line">    std::string fn = <span class="stringliteral">&quot;fitting/deepdrawingC.xml&quot;</span>; <span class="comment">// d</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Reading options from the command line</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsCmdLine.html">gsCmdLine</a> cmd(<span class="stringliteral">&quot;Fit parametrized sample data with a surface patch. Expected input file is an XML &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;file containing two matrices (&lt;Matrix&gt;), with \nMatrix id 0 : contains a 2 x N matrix. &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;Every column represents a (u,v) parametric coordinate\nMatrix id 1 : contains a &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;3 x N matrix. Every column represents a point (x,y,z) in space.&quot;</span>);</div>
<div class="line">    cmd.addSwitch(<span class="stringliteral">&quot;save&quot;</span>, <span class="stringliteral">&quot;Save result in XML format&quot;</span>, save);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;parcor&quot;</span>, <span class="stringliteral">&quot;Steps of parameter correction&quot;</span>, maxPcIter);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;i&quot;</span>, <span class="stringliteral">&quot;iter&quot;</span>, <span class="stringliteral">&quot;number of iterations&quot;</span>, iter);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;deg_x&quot;</span>, <span class="stringliteral">&quot;degree in x direction&quot;</span>, deg_x);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;y&quot;</span>, <span class="stringliteral">&quot;deg_y&quot;</span>, <span class="stringliteral">&quot;degree in y direction&quot;</span>, deg_y);</div>
<div class="line">    cmd.addReal(<span class="stringliteral">&quot;s&quot;</span>, <span class="stringliteral">&quot;lambda&quot;</span>, <span class="stringliteral">&quot;smoothing coefficient&quot;</span>, lambda);</div>
<div class="line">    cmd.addReal(<span class="stringliteral">&quot;t&quot;</span>, <span class="stringliteral">&quot;threshold&quot;</span>, <span class="stringliteral">&quot;error threshold (special valule -1)&quot;</span>, threshold);</div>
<div class="line">    cmd.addReal(<span class="stringliteral">&quot;p&quot;</span>, <span class="stringliteral">&quot;refPercent&quot;</span>, <span class="stringliteral">&quot;percentage of points to refine in each iteration&quot;</span>, refPercent);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;q&quot;</span>, <span class="stringliteral">&quot;extension&quot;</span>, <span class="stringliteral">&quot;extension size&quot;</span>, extension);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;r&quot;</span>, <span class="stringliteral">&quot;urefine&quot;</span>, <span class="stringliteral">&quot;initial uniform refinement steps&quot;</span>, numURef);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;n&quot;</span>, <span class="stringliteral">&quot;iknots&quot;</span>, <span class="stringliteral">&quot;number of interior knots in each direction&quot;</span>, numKnots);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;uknots&quot;</span>, <span class="stringliteral">&quot;number of interior knots in u-direction&quot;</span>, nx);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;vknots&quot;</span>, <span class="stringliteral">&quot;number of interior knots in v-direction&quot;</span>, ny);</div>
<div class="line">    cmd.addReal(<span class="stringliteral">&quot;e&quot;</span>, <span class="stringliteral">&quot;tolerance&quot;</span>, <span class="stringliteral">&quot;error tolerance (desired upper bound for pointwise error)&quot;</span>, tolerance);</div>
<div class="line">    cmd.addString(<span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;data&quot;</span>, <span class="stringliteral">&quot;Input sample data&quot;</span>, fn);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">try</span> { cmd.getValues(argc,argv); } <span class="keywordflow">catch</span> (<span class="keywordtype">int</span> rv) { <span class="keywordflow">return</span> rv; }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (deg_x &lt; 1)</div>
<div class="line">    { <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Degree x must be positive.\n&quot;</span>;  <span class="keywordflow">return</span> 0;}</div>
<div class="line">    <span class="keywordflow">if</span> (deg_y &lt; 1)</div>
<div class="line">    { <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Degree y must be positive.\n&quot;</span>; <span class="keywordflow">return</span> 0;}</div>
<div class="line">    <span class="keywordflow">if</span> (extension &lt; 0)</div>
<div class="line">    { <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Extension must be non negative.\n&quot;</span>; <span class="keywordflow">return</span> 0;}</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ( tolerance &lt; 0 )</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Error tolerance cannot be negative, setting it to default value.\n&quot;</span>;</div>
<div class="line">        tolerance = 1e-02;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (threshold &gt; 0 &amp;&amp; threshold &gt; tolerance )</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Refinement threshold is over tolerance, setting it the same as tolerance.\n&quot;</span>;</div>
<div class="line">        threshold = tolerance;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Surface fitting</span></div>
<div class="line">    <span class="comment">// Expected input is a file with matrices with:</span></div>
<div class="line">    <span class="comment">// id 0:  u,v   -- parametric coordinates, size 2 x N</span></div>
<div class="line">    <span class="comment">// id 1:  x,y,z -- corresponding mapped values, size 3 x N</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsFileData.html">gsFileData&lt;&gt;</a> fd_in(fn);</div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a> uv, xyz;</div>
<div class="line">    fd_in.getId&lt;<a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a> &gt;(0, uv );</div>
<div class="line">    fd_in.getId&lt;<a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a> &gt;(1, xyz);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// This is for outputing an XML file, if requested</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsFileData.html">gsFileData&lt;&gt;</a> fd;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Check if matrix sizes are OK</span></div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#afef28a292b09ce4b06f94e6ed3b8abb4">GISMO_ASSERT</a>( uv.cols() == xyz.cols() &amp;&amp; uv.rows() == 2,</div>
<div class="line">                  <span class="stringliteral">&quot;Wrong input&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Determine the parameter domain by mi/max of parameter values</span></div>
<div class="line">    real_t u_min = uv.row(0).minCoeff(),</div>
<div class="line">        u_max = uv.row(0).maxCoeff(),</div>
<div class="line">        v_min = uv.row(1).minCoeff(),</div>
<div class="line">        v_max = uv.row(1).maxCoeff();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create knot-vectors without interior knots</span></div>
<div class="line">    <span class="keywordflow">if</span>( nx &lt; 0)</div>
<div class="line">      nx = numKnots;</div>
<div class="line">    <span class="keywordflow">if</span>( ny &lt; 0)</div>
<div class="line">      ny = numKnots;</div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsKnotVector.html">gsKnotVector&lt;&gt;</a> u_knots (u_min, u_max, nx, deg_x+1 ) ;</div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsKnotVector.html">gsKnotVector&lt;&gt;</a> v_knots (v_min, v_max, ny, deg_y+1 ) ;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create a tensor-basis nad apply initial uniform refinement</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsTensorBSplineBasis.html">gsTensorBSplineBasis&lt;2&gt;</a> T_tbasis( u_knots, v_knots );</div>
<div class="line">    T_tbasis.uniformRefine( (1&lt;&lt;numURef)-1 );</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create Initial hierarchical basis</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsTHBSplineBasis.html">gsTHBSplineBasis&lt;2&gt;</a>  THB ( T_tbasis ) ;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Specify extension size in u and v cells</span></div>
<div class="line">    std::vector&lt;unsigned&gt; ext;</div>
<div class="line">    ext.push_back(extension);</div>
<div class="line">    ext.push_back(extension);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create hierarchical refinement object</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsHFitting.html">gsHFitting&lt;2, real_t&gt;</a> ref( uv, xyz, THB, refPercent, ext, lambda);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;real_t&gt; &amp; errors = ref.pointWiseErrors();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Print settings summary</span></div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;Fitting &quot;</span>&lt;&lt; xyz.cols() &lt;&lt;<span class="stringliteral">&quot; samples.\n&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;----------------\n&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;Cell extension     : &quot;</span>&lt;&lt; ext[0]&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;ext[1]&lt;&lt;<span class="stringliteral">&quot;.\n&quot;</span>;</div>
<div class="line">    <span class="keywordflow">if</span> ( threshold &gt;= 0.0 )</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;Ref. threshold     : &quot;</span>&lt;&lt; threshold&lt;&lt;<span class="stringliteral">&quot;.\n&quot;</span>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;Cell refinement    : &quot;</span>&lt;&lt; 100*refPercent&lt;&lt;<span class="stringliteral">&quot;%%.\n&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;Error tolerance    : &quot;</span>&lt;&lt; tolerance&lt;&lt;<span class="stringliteral">&quot;.\n&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;Smoothing parameter: &quot;</span>&lt;&lt; lambda&lt;&lt;<span class="stringliteral">&quot;.\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsGenericStopwatch.html">gsStopwatch</a> time;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt;= iter; i++)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;----------------\n&quot;</span>;</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;Iteration &quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot;..&quot;</span>&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">        time.<a class="code hl_function" href="classgismo_1_1gsGenericStopwatch.html#a22ee094ca3f45aa4156b97d34fe678bf">restart</a>();</div>
<div class="line">        ref.nextIteration(tolerance, threshold, maxPcIter);</div>
<div class="line">        time.<a class="code hl_function" href="classgismo_1_1gsGenericStopwatch.html#a0041a7a576355baa3259e96e9f0e4eb3">stop</a>();</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;Fitting time: &quot;</span>&lt;&lt; time &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;Fitted with &quot;</span>&lt;&lt; ref.result()-&gt;basis() &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;Min distance : &quot;</span>&lt;&lt; ref.minPointError() &lt;&lt;<span class="stringliteral">&quot; / &quot;</span>;</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;Max distance : &quot;</span>&lt;&lt; ref.maxPointError() &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;Points below tolerance: &quot;</span>&lt;&lt; 100.0 * ref.numPointsBelow(tolerance)/errors.size()&lt;&lt;<span class="stringliteral">&quot;%.\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ( ref.maxPointError() &lt; tolerance )</div>
<div class="line">        {</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;Error tolerance achieved after &quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot; iterations.\n&quot;</span>;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;----------------\n&quot;</span>;</div>
<div class="line">    <span class="keywordflow">if</span> ( save )</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a>&lt;&lt;<span class="stringliteral">&quot;Done. Writing solution to file fitting_out.xml\n&quot;</span>;</div>
<div class="line">        fd &lt;&lt; *ref.result() ;</div>
<div class="line"> </div>
<div class="line">        fd.dump(<span class="stringliteral">&quot;fitting_out&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Done. No output created, re-run with --save to get a xml &quot;</span></div>
<div class="line">                  <span class="stringliteral">&quot;file containing the solution.\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aclassgismo_1_1gsGenericStopwatch_html"><div class="ttname"><a href="classgismo_1_1gsGenericStopwatch.html">gismo::gsGenericStopwatch&lt; WallClock &gt;</a></div></div>
<div class="ttc" id="aclassgismo_1_1gsGenericStopwatch_html_a0041a7a576355baa3259e96e9f0e4eb3"><div class="ttname"><a href="classgismo_1_1gsGenericStopwatch.html#a0041a7a576355baa3259e96e9f0e4eb3">gismo::gsGenericStopwatch::stop</a></div><div class="ttdeci">double stop()</div><div class="ttdoc">Return elapsed time in seconds.</div><div class="ttdef"><b>Definition</b> gsStopwatch.h:83</div></div>
<div class="ttc" id="aclassgismo_1_1gsGenericStopwatch_html_a22ee094ca3f45aa4156b97d34fe678bf"><div class="ttname"><a href="classgismo_1_1gsGenericStopwatch.html#a22ee094ca3f45aa4156b97d34fe678bf">gismo::gsGenericStopwatch::restart</a></div><div class="ttdeci">void restart()</div><div class="ttdoc">Start taking the time.</div><div class="ttdef"><b>Definition</b> gsStopwatch.h:80</div></div>
<div class="ttc" id="agsConfig_8h_html_ad722078677c063a09661059674fb996c"><div class="ttname"><a href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a></div><div class="ttdeci">#define index_t</div><div class="ttdef"><b>Definition</b> gsConfig.h:32</div></div>
<div class="ttc" id="agsDebug_8h_html_afef28a292b09ce4b06f94e6ed3b8abb4"><div class="ttname"><a href="gsDebug_8h.html#afef28a292b09ce4b06f94e6ed3b8abb4">GISMO_ASSERT</a></div><div class="ttdeci">#define GISMO_ASSERT(cond, message)</div><div class="ttdef"><b>Definition</b> gsDebug.h:89</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Jan 20 2025 09:35:26 for G+Smo by Doxygen v1.9.8 </li>
  </ul>
</div>
<!-- Piwik --> 
<!--
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? "https://stats.sylphide-consulting.com/piwik/" : "http://stats.sylphide-consulting.com/piwik/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 20);
piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
</script><noscript><p><img src="http://stats.sylphide-consulting.com/piwik/piwik.php?idsite=20" style="border:0" alt="" /></p></noscript>
-->
<!-- End Piwik Tracking Code -->
</body>
</html>

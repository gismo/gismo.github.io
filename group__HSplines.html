<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<title>G+Smo: Hierarchical splines module</title>
<link href="gismodoxy_tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://people.ricam.oeaw.ac.at/gismo/mj/MathJax.js"></script>
<link href="doxygen.css"   rel="stylesheet" type="text/css" />
<link href="gismodoxy.css" rel="stylesheet" type="text/css">
<!--  -->
<!-- <script type="text/javascript"> -->
<!-- </script> -->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- <a name="top"></a> -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="gslogo-doxy.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname"><a href="index.html"><font style="font-variant:small-caps;">G+S</font><font style="font-variant:small-caps;"
															    color="#000000">mo</font></a>
   &#160;<span id="projectnumber">25.01.0</span>
   </div>
   <div id="projectbrief">Geometry + Simulation Modules</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__HSplines.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle"><div class="title">Hierarchical splines module<div class="ingroups"><a class="el" href="group__Modules.html">The G+Smo modules</a></div></div></div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>This module implements hierarchical and truncated hierarchical tensor-product B-splines.</p>
<p>See also <a class="el" href="thbSplineBasis_example.html">thbSplineBasis_example.cpp</a> and <a class="el" href="adaptRefinementThb_example.html">adaptRefinementThb_example.cpp</a>.</p>
<h1><a class="anchor" id="THB-splines"></a>
Tutorial</h1>
<p>We will now have a closer look at the <code>gsThbs_test.cpp</code> file. After parsing the command line arguments it either reads the hierarchical basis from the file given by the user or runs a default example. To understand how the hierarchical basis is specified you can look into the file with the default example. This you do by </p><blockquote class="doxtable">
<p>&zwj;cat ./filedata/thbbasis/simple.xml </p>
</blockquote>
<p>in your <code>gismo-build</code> directory. This should give something like</p>
<div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span>?&gt;</div>
<div class="line">&lt;xml&gt;</div>
<div class="line">  &lt;Basis type=<span class="stringliteral">&quot;THBSplineBasis2&quot;</span> levels=<span class="stringliteral">&quot;3&quot;</span>&gt;</div>
<div class="line">   &lt;Basis type=<span class="stringliteral">&quot;TensorBSplineBasis2&quot;</span>&gt;</div>
<div class="line">    &lt;Basis type=<span class="stringliteral">&quot;BSplineBasis&quot;</span> index=<span class="stringliteral">&quot;0&quot;</span>&gt;</div>
<div class="line">     &lt;KnotVector degree=<span class="stringliteral">&quot;2&quot;</span>&gt;0 0 0 0.25 0.5 0.75 1 1 1&lt;/KnotVector&gt;</div>
<div class="line">    &lt;/Basis&gt;</div>
<div class="line">    &lt;Basis type=<span class="stringliteral">&quot;BSplineBasis&quot;</span> index=<span class="stringliteral">&quot;1&quot;</span>&gt;</div>
<div class="line">     &lt;KnotVector degree=<span class="stringliteral">&quot;2&quot;</span>&gt;0 0 0 0.25 0.5 0.75 1 1 1&lt;/KnotVector&gt;</div>
<div class="line">    &lt;/Basis&gt;</div>
<div class="line">   &lt;/Basis&gt;</div>
<div class="line">   &lt;box level=<span class="stringliteral">&quot;1&quot;</span>&gt;2 2 6 6&lt;/box&gt;</div>
<div class="line">   &lt;box level=<span class="stringliteral">&quot;2&quot;</span>&gt;4 4 10 10&lt;/box&gt;</div>
<div class="line">  &lt;/Basis&gt;</div>
<div class="line">&lt;/xml&gt;</div>
</div><!-- fragment --><p>This means that we are first given a unit square equidistantly divided into 16 pieces and having triple knots on the boundary. Note number 2 in the specification of the <code>THBSplineBasis2</code> (and the other bases as well) telling the number of variables. If omitted, it is expected to be one as in the case of the univariate bases in the tensor product. Note also that <code>levels="3"</code>. This means that (in the current implementation) cannot get more than three levels of dyadic refinement.</p>
<p>This leads us to an important concept of local and global indices. Internally, G+Smo stores the knot points indexed by the <b>finest</b> level. See the following table.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">physical coordinates   </th><th class="markdownTableHeadNone">0   </th><th class="markdownTableHeadNone">0.25   </th><th class="markdownTableHeadNone">0.5   </th><th class="markdownTableHeadNone">0.75   </th><th class="markdownTableHeadNone">1    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">indices in level 0   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">4    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">indices in level 1   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone">6   </td><td class="markdownTableBodyNone">8    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">indices in level 2   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone">8   </td><td class="markdownTableBodyNone">12   </td><td class="markdownTableBodyNone">16   </td></tr>
</table>
<p>The mesh is then refined in the specified boxes. Important is that each of these boxes is specified by its lower left and upper right corner and these corners are given in the indices of the <b>current</b> level. The final mesh together with the bivariate (check, where this is specified!) basis functions is depicted in Figure 1.</p>
<div class="image">
<img src="hierarchical_mesh_grid.png" alt=""/>
<div class="caption">
Figure 1. Hierarchical mesh.</div></div>
<p>The triple knots at the domain boundary are shown with spaces for illustration. First we refined the square \( [2,6]\times [2,6]\) in the numbering of level 1 and then the square \( [4,10]\times [4,10]\) in the indices of level 2. The physical coordinates are visible from the picture.</p>
<p>The active basis functions (those that are in the hierarchical basis) are printed in the console as the output of <code>gsThbs_test.cpp</code> starting with </p><blockquote class="doxtable">
<p>&zwj;Characteristic matrix: </p>
</blockquote>
<p>There should be 36, 3 and 16 basis functions in levels 0, 1 and 2, respectively. The basis functions are given as pairs \((x,y)\), where \(x\) is the number of this basis function in the horizontal direction counted from the left (note that the functions in each level has their own numbering, since the size of their support is different) and \(y\) is its number in the vertical numbering starting from below. Consult Figure 2 for the numbering of the basis functions.</p>
<div class="image">
<img src="hierarchical_mesh_basis.png" alt=""/>
<div class="caption">
Figure 2. Basis functions.</div></div>
<p>You can see the mesh specified in <code>~gismo/filedata/thbbasis/simple</code>.xml together with the Greville points (center points of supports) of the basis functions. Basis functions from levels 0, 1 and 2 are marked by black, red and turqoise dots, respectively. The axes show the numbering of the basis functions from the three levels. </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgismo_1_1gsAABB.html">gsAABB&lt; d, Z &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Struct of for an Axis-aligned bounding box.  <a href="structgismo_1_1gsAABB.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgismo_1_1gsHBox.html">gsHBox&lt; d, T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class provides a Hierarchical Box (<a class="el" href="classgismo_1_1gsHBox.html" title="This class provides a Hierarchical Box (gsHBox)">gsHBox</a>)  <a href="classgismo_1_1gsHBox.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgismo_1_1gsHBSpline.html">gsHBSpline&lt; d, T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A hierarchical B-Spline function, in <em>d</em> dimensions.  <a href="classgismo_1_1gsHBSpline.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgismo_1_1gsHBSplineBasis.html">gsHBSplineBasis&lt; d, T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A hierarchical B-spline basis of parametric dimension <em>d</em>.  <a href="classgismo_1_1gsHBSplineBasis.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgismo_1_1gsHDomain.html">gsHDomain&lt; d, Z &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class with a <em>hierarchical domain structure</em> represented by a box k-d-tree.  <a href="classgismo_1_1gsHDomain.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgismo_1_1gsHDomainBoundaryIterator.html">gsHDomainBoundaryIterator&lt; T, d &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Re-implements <a class="el" href="classgismo_1_1gsDomainIterator.html" title="Class which enables iteration over all elements of a parameter domain.">gsDomainIterator</a> for iteration over all boundary elements of a <b>hierarchical</b> parameter domain.  <a href="classgismo_1_1gsHDomainBoundaryIterator.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgismo_1_1gsHDomainIterator.html">gsHDomainIterator&lt; T, d &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Re-implements <a class="el" href="classgismo_1_1gsDomainIterator.html" title="Class which enables iteration over all elements of a parameter domain.">gsDomainIterator</a> for iteration over all boundary elements of a <b>hierarchical</b> parameter domain.  <a href="classgismo_1_1gsHDomainIterator.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgismo_1_1gsHDomainLeafIter.html">gsHDomainLeafIter&lt; node, isconst &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Iterates over the leaves of an <a class="el" href="classgismo_1_1gsHDomain.html" title="Class with a hierarchical domain structure represented by a box k-d-tree.">gsHDomain</a> (tree).  <a href="classgismo_1_1gsHDomainLeafIter.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgismo_1_1gsHDomainSliceIter.html">gsHDomainSliceIter&lt; node, isconst &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Iterates over the leaves of an <a class="el" href="classgismo_1_1gsHDomain.html" title="Class with a hierarchical domain structure represented by a box k-d-tree.">gsHDomain</a> (tree) that intersect with a slice position.  <a href="classgismo_1_1gsHDomainSliceIter.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgismo_1_1gsHFitting.html">gsHFitting&lt; d, T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class applies hierarchical fitting of parametrized point clouds.  <a href="classgismo_1_1gsHFitting.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgismo_1_1gsHTensorBasis.html">gsHTensorBasis&lt; d, T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class representing a (scalar) hierarchical tensor basis of functions \( \mathbb R^d \to \mathbb R \).  <a href="classgismo_1_1gsHTensorBasis.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgismo_1_1gsKdNode.html">gsKdNode&lt; d, Z &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Struct representing a kd-tree node.  <a href="structgismo_1_1gsKdNode.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgismo_1_1gsRationalTHBSpline.html">gsRationalTHBSpline&lt; d, T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A rational truncated hierarchical B-Spline function of parametric dimension <em>d</em>, with arbitrary target dimension.  <a href="classgismo_1_1gsRationalTHBSpline.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgismo_1_1gsRationalTHBSplineBasis.html">gsRationalTHBSplineBasis&lt; d, T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A rational Truncated Hierarchical B-Spline basis.  <a href="classgismo_1_1gsRationalTHBSplineBasis.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgismo_1_1gsTHBSpline.html">gsTHBSpline&lt; d, T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A truncated hierarchical B-Spline function, in <em>d</em> dimensions.  <a href="classgismo_1_1gsTHBSpline.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgismo_1_1gsTHBSplineBasis.html">gsTHBSplineBasis&lt; d, T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Truncated hierarchical B-spline basis.  <a href="classgismo_1_1gsTHBSplineBasis.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgismo_1_1gsVSegment.html">gsVSegment&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class for representing a vertical line segment in 2D. Helper for the class gsAAPolyline.  <a href="classgismo_1_1gsVSegment.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Jan 20 2025 09:35:27 for G+Smo by Doxygen v1.9.8 </li>
  </ul>
</div>
<!-- Piwik --> 
<!--
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? "https://stats.sylphide-consulting.com/piwik/" : "http://stats.sylphide-consulting.com/piwik/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 20);
piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
</script><noscript><p><img src="http://stats.sylphide-consulting.com/piwik/piwik.php?idsite=20" style="border:0" alt="" /></p></noscript>
-->
<!-- End Piwik Tracking Code -->
</body>
</html>

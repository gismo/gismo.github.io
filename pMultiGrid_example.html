<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<title>G+Smo: pMultiGrid_example.cpp</title>
<link href="gismodoxy_tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://people.ricam.oeaw.ac.at/gismo/mj/MathJax.js"></script>
<link href="doxygen.css"   rel="stylesheet" type="text/css" />
<link href="gismodoxy.css" rel="stylesheet" type="text/css">
<!--  -->
<!-- <script type="text/javascript"> -->
<!-- </script> -->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- <a name="top"></a> -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="gslogo-doxy.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname"><a href="index.html"><font style="font-variant:small-caps;">G+S</font><font style="font-variant:small-caps;"
															    color="#000000">mo</font></a>
   &#160;<span id="projectnumber">25.01.0</span>
   </div>
   <div id="projectbrief">Geometry + Simulation Modules</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('pMultiGrid_example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">pMultiGrid_example.cpp</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>After reading the command line arguments, we define the problem specification (domain, right-hand side, function for boundary conditions, functions for CDR equation) for the chosen benchmark problem (option <code>&ndash;Benchmark</code>).</p>
<div class="fragment"><div class="line">    gsFunctionExpr&lt;&gt; sol_exact, rhs_exact, coeff_diff, coeff_conv, coeff_reac;</div>
<div class="line">    gsMultiPatch&lt;&gt; mp;</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;|| Benchmark information ||\n&quot;</span>;</div>
<div class="line">    <span class="keywordflow">switch</span> (numBenchmark)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">case</span> 1:</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;1) CDR-equation the unit square\n&quot;</span>;</div>
<div class="line">            mp = gsMultiPatch&lt;&gt;(*gsNurbsCreator&lt;&gt;::BSplineSquare(1.0, 0.0, 0.0));</div>
<div class="line">            sol_exact = gsFunctionExpr&lt;&gt;(<span class="stringliteral">&quot;sin(pi*x)*sin(pi*y)&quot;</span>,2);</div>
<div class="line">            rhs_exact = gsFunctionExpr&lt;&gt;(<span class="stringliteral">&quot;1.2*pi*pi*sin(pi*x)*sin(pi*y)+0.9*pi*pi*sin(pi*x)*sin(pi*y)+0.7*pi*pi*cos(pi*x)*cos(pi*y)&quot;</span></div>
<div class="line">                            <span class="stringliteral">&quot; + 0.4*pi*pi*cos(pi*x)*cos(pi*y) +0.4*pi*cos(pi*x)*sin(pi*y)-0.2*pi*sin(pi*x)*cos(pi*y)+0.3*sin(pi*x)*sin(pi*y)&quot;</span>, 2);</div>
<div class="line">            coeff_diff = gsFunctionExpr&lt;&gt;(<span class="stringliteral">&quot;1.2&quot;</span>,<span class="stringliteral">&quot;-0.7&quot;</span>,<span class="stringliteral">&quot;-0.4&quot;</span>,<span class="stringliteral">&quot;0.9&quot;</span>,2);</div>
<div class="line">            coeff_conv = gsFunctionExpr&lt;&gt;(<span class="stringliteral">&quot;0.4&quot;</span>,<span class="stringliteral">&quot;-0.2&quot;</span>,2);</div>
<div class="line">            coeff_reac = gsFunctionExpr&lt;&gt;(<span class="stringliteral">&quot;0.3&quot;</span>,2);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> 2:</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;2) Poisson equation on the quarter annulus\n&quot;</span>;</div>
<div class="line">            mp = gsMultiPatch&lt;&gt;(*<a class="code hl_function" href="structgismo_1_1gsNurbsCreator.html#ae9750c3092e1dd8fa99a7f724b9a72bf">gsNurbsCreator&lt;&gt;::BSplineFatQuarterAnnulus</a>(1.0, 2.0));</div>
<div class="line">            sol_exact = gsFunctionExpr&lt;&gt;( <span class="stringliteral">&quot;-(x*x+y*y-1)*(x*x+y*y-4)*x*y*y&quot;</span>, 2);</div>
<div class="line">            rhs_exact = gsFunctionExpr&lt;&gt;( <span class="stringliteral">&quot;2*x*(22*x*x*y*y+21*y*y*y*y-45*y*y+x*x*x*x-5*x*x+4)&quot;</span>, 2);</div>
<div class="line">            coeff_diff = gsFunctionExpr&lt;&gt;(<span class="stringliteral">&quot;1&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;1&quot;</span>,2);</div>
<div class="line">            coeff_conv = gsFunctionExpr&lt;&gt;(<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,2);</div>
<div class="line">            coeff_reac = gsFunctionExpr&lt;&gt;(<span class="stringliteral">&quot;0&quot;</span>,2);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> 3:</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;3) Poisson equation on the quarter annulus\n&quot;</span>;</div>
<div class="line">            mp = gsMultiPatch&lt;&gt;(*<a class="code hl_function" href="structgismo_1_1gsNurbsCreator.html#ae9750c3092e1dd8fa99a7f724b9a72bf">gsNurbsCreator&lt;&gt;::BSplineFatQuarterAnnulus</a>(1.0, 2.0));</div>
<div class="line">            sol_exact = gsFunctionExpr&lt;&gt;( <span class="stringliteral">&quot;(x^2+y^2-3*sqrt(x^2+y^2)+2)*sin(2*atan(y/x))&quot;</span>, 2);</div>
<div class="line">            rhs_exact = gsFunctionExpr&lt;&gt;( <span class="stringliteral">&quot;(8-9*sqrt(x^2 + y^2))*sin(2*atan(y/x))/(x^2+y^2)&quot;</span>, 2);</div>
<div class="line">            coeff_diff = gsFunctionExpr&lt;&gt;(<span class="stringliteral">&quot;1&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;1&quot;</span>,2);</div>
<div class="line">            coeff_conv = gsFunctionExpr&lt;&gt;(<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,2);</div>
<div class="line">            coeff_reac = gsFunctionExpr&lt;&gt;(<span class="stringliteral">&quot;0&quot;</span>,2);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> 4:</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;4) Poisson equation on an L-shaped domain\n&quot;</span>;</div>
<div class="line">            mp = gsMultiPatch&lt;&gt;(*<a class="code hl_function" href="structgismo_1_1gsNurbsCreator.html#a027e926a635602194dfa721f26cffd34">gsNurbsCreator&lt;&gt;::BSplineLShape_p1</a>());</div>
<div class="line">            sol_exact = gsFunctionExpr&lt;&gt;( <span class="stringliteral">&quot;if ( y&gt;0, ( (x^2+y^2)^(1.0/3.0) )*sin( (2*atan2(y,x) - pi)/3.0 ), ( (x^2+y^2)^(1.0/3.0) )*sin( (2*atan2(y,x) +3*pi)/3.0 ) )&quot;</span>, 2);</div>
<div class="line">            rhs_exact = gsFunctionExpr&lt;&gt;( <span class="stringliteral">&quot;0&quot;</span>, 2);</div>
<div class="line">            coeff_diff = gsFunctionExpr&lt;&gt;(<span class="stringliteral">&quot;1&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;1&quot;</span>,2);</div>
<div class="line">            coeff_conv = gsFunctionExpr&lt;&gt;(<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,2);</div>
<div class="line">            coeff_reac = gsFunctionExpr&lt;&gt;(<span class="stringliteral">&quot;0&quot;</span>,2);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> 5:</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;5) Poisson equation on the unit cube\n&quot;</span>;</div>
<div class="line">            mp = gsMultiPatch&lt;&gt;(*<a class="code hl_function" href="structgismo_1_1gsNurbsCreator.html#ad8c90f6f1bf48d9ae8933b4de5398dfe">gsNurbsCreator&lt;&gt;::BSplineCube</a>((real_t)1));</div>
<div class="line">            sol_exact = gsFunctionExpr&lt;&gt;( <span class="stringliteral">&quot;sin(pi*x)*sin(pi*y)*sin(pi*z)&quot;</span>, 3);</div>
<div class="line">            rhs_exact = gsFunctionExpr&lt;&gt;( <span class="stringliteral">&quot;(3*pi^2)*sin(pi*x)*sin(pi*y)*sin(pi*z)&quot;</span>, 3);</div>
<div class="line">            coeff_diff = gsFunctionExpr&lt;&gt;(<span class="stringliteral">&quot;1&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;1&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;1&quot;</span>,3);</div>
<div class="line">            coeff_conv = gsFunctionExpr&lt;&gt;(<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,3);</div>
<div class="line">            coeff_reac = gsFunctionExpr&lt;&gt;(<span class="stringliteral">&quot;0&quot;</span>,3);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> 6:</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;6) Poisson&#39;s equation on Yeti footprint\n&quot;</span>;</div>
<div class="line">            mp = *<span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="classgismo_1_1gsMultiPatch.html#ad7190c68d8ead80bd1b6fd7256779894">gsMultiPatch&lt;&gt;::uPtr</a><span class="keyword">&gt;</span>(gsReadFile&lt;&gt;(<span class="stringliteral">&quot;domain2d/yeti_mp2.xml&quot;</span>));</div>
<div class="line">            sol_exact = gsFunctionExpr&lt;&gt;( <span class="stringliteral">&quot;sin(5*pi*x)*sin(5*pi*y)&quot;</span>, 2);</div>
<div class="line">            rhs_exact = gsFunctionExpr&lt;&gt;( <span class="stringliteral">&quot;(50*pi^2)*sin(5*pi*x)*sin(5*pi*y)&quot;</span>, 2);</div>
<div class="line">            coeff_diff = gsFunctionExpr&lt;&gt;(<span class="stringliteral">&quot;1&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;1&quot;</span>,2);</div>
<div class="line">            coeff_conv = gsFunctionExpr&lt;&gt;(<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,2);</div>
<div class="line">            coeff_reac = gsFunctionExpr&lt;&gt;(<span class="stringliteral">&quot;0&quot;</span>,2);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Unknown benchmark case chosen.\n&quot;</span>;</div>
<div class="line">            <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">    }</div>
<div class="ttc" id="aclassgismo_1_1gsMultiPatch_html_ad7190c68d8ead80bd1b6fd7256779894"><div class="ttname"><a href="classgismo_1_1gsMultiPatch.html#ad7190c68d8ead80bd1b6fd7256779894">gismo::gsMultiPatch::uPtr</a></div><div class="ttdeci">memory::unique_ptr&lt; gsMultiPatch &gt; uPtr</div><div class="ttdoc">Unique pointer for gsMultiPatch.</div><div class="ttdef"><b>Definition</b> gsMultiPatch.h:109</div></div>
<div class="ttc" id="agsDebug_8h_html_af6177e1e282640c3cb9175565f84a432"><div class="ttname"><a href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a></div><div class="ttdeci">#define gsInfo</div><div class="ttdef"><b>Definition</b> gsDebug.h:43</div></div>
<div class="ttc" id="astructgismo_1_1gsNurbsCreator_html_a027e926a635602194dfa721f26cffd34"><div class="ttname"><a href="structgismo_1_1gsNurbsCreator.html#a027e926a635602194dfa721f26cffd34">gismo::gsNurbsCreator::BSplineLShape_p1</a></div><div class="ttdeci">static TensorBSpline2Ptr BSplineLShape_p1(T r=(T)(1))</div><div class="ttdoc">L-Shaped domain represented as a tensor B-spline of degree 1.</div><div class="ttdef"><b>Definition</b> gsNurbsCreator.hpp:1262</div></div>
<div class="ttc" id="astructgismo_1_1gsNurbsCreator_html_ad8c90f6f1bf48d9ae8933b4de5398dfe"><div class="ttname"><a href="structgismo_1_1gsNurbsCreator.html#ad8c90f6f1bf48d9ae8933b4de5398dfe">gismo::gsNurbsCreator::BSplineCube</a></div><div class="ttdeci">static TensorBSpline3Ptr BSplineCube(T const &amp;r=1, T const &amp;x=0, T const &amp;y=0, T const &amp;z=0)</div><div class="ttdoc">Cube of side r, with lower left corner at (x,y,z)</div><div class="ttdef"><b>Definition</b> gsNurbsCreator.hpp:731</div></div>
<div class="ttc" id="astructgismo_1_1gsNurbsCreator_html_ae9750c3092e1dd8fa99a7f724b9a72bf"><div class="ttname"><a href="structgismo_1_1gsNurbsCreator.html#ae9750c3092e1dd8fa99a7f724b9a72bf">gismo::gsNurbsCreator::BSplineFatQuarterAnnulus</a></div><div class="ttdeci">static TensorBSpline2Ptr BSplineFatQuarterAnnulus(T const &amp;r0=1, T const &amp;r1=2)</div><div class="ttdef"><b>Definition</b> gsNurbsCreator.hpp:949</div></div>
</div><!-- fragment --><p>The command line option <code>&ndash;PatchSplits</code> \(i\) allows to apply \(i\) uniform splits of each patch into \( 2^d \) sub-patches.</p>
<div class="fragment"><div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i=0; i&lt;numSplits; ++i)</div>
<div class="line">        mp = mp.uniformSplit();</div>
<div class="ttc" id="agsConfig_8h_html_ad722078677c063a09661059674fb996c"><div class="ttname"><a href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a></div><div class="ttdeci">#define index_t</div><div class="ttdef"><b>Definition</b> gsConfig.h:32</div></div>
</div><!-- fragment --><p>We define the boundary conditions object with the function containing the corresponding Dirichlet data.</p>
<div class="fragment"><div class="line">    gsBoundaryConditions&lt;&gt; bcInfo;</div>
<div class="line">    gsFunctionExpr&lt;&gt; zero(<span class="stringliteral">&quot;0&quot;</span>, mp.geoDim());</div>
<div class="line">    <span class="keywordflow">for</span> (gsMultiPatch&lt;&gt;::const_biterator bit = mp.bBegin(); bit != mp.bEnd(); ++bit)</div>
<div class="line">        bcInfo.addCondition(*bit, <a class="code hl_enumvalue" href="structgismo_1_1condition__type.html#a7aead736a07eaf25623ad7bfa1f0ee2da1b4f535d1f53363637f933002efc2b4b">condition_type::dirichlet</a>, &amp;sol_exact);</div>
<div class="line">    bcInfo.setGeoMap(mp);</div>
<div class="ttc" id="astructgismo_1_1condition__type_html_a7aead736a07eaf25623ad7bfa1f0ee2da1b4f535d1f53363637f933002efc2b4b"><div class="ttname"><a href="structgismo_1_1condition__type.html#a7aead736a07eaf25623ad7bfa1f0ee2da1b4f535d1f53363637f933002efc2b4b">gismo::condition_type::dirichlet</a></div><div class="ttdeci">@ dirichlet</div><div class="ttdoc">Dirichlet type.</div><div class="ttdef"><b>Definition</b> gsBoundaryConditions.h:31</div></div>
</div><!-- fragment --><p>The setup of the multigrid hierarchy is given by the command line parameters <code>&ndash;Levels</code>, <code>&ndash;Projection</code> and <code>&ndash;Coarsening</code>.</p>
<p>With <code>&ndash;Levels</code>, the number of levels \(L\) is specified.</p>
<p>Using <code>&ndash;Coarsening</code>, one can specify \(L-1\) values for the coarsening (the leftmost entry corresponds to the coarsest level): <code>h</code>: standard grid coarsening (as by uniform grid refinement; increase grid size by factor 2) <code>p</code>: reduce spline degree and smoothness (keep grid as-is) <code>z</code>: reduce spline degree and smoothness and grid coarsening</p>
<p>The choice <code>&ndash;Projection 1</code> means that <code>p</code> and <code>z</code> refer to a direct coarsening from degree \(p\) to degree 1. The choice <code>&ndash;Projection 2</code> means that <code>p</code> and <code>z</code> refer to a reduction of the spline degree by 1, like from \(p\) to \(p-1\).</p>
<p>If <code>&ndash;Projection 1</code>, there can only be one single <code>p</code> or <code>z</code> coarsening.</p>
<p>If <code>&ndash;Coarsening</code> is not specified: in case of <code>&ndash;Projection 1</code>, the default is <code>h...hz</code>, meaning that we have degree 1 for the levels \(\ell=1,\ldots,L-1\) and the degree specified by <code>&ndash;Degree</code> for the finest level \(L\). All levels refer to different grid sizes. in case of <code>&ndash;Projection 2</code>, the default is <code>h...hz...z</code>, meaning that we have the degree specified by <code>&ndash;Degree</code> for the finest level \(L\). On each next coarser level, the degree is reduced by 1. After reaching degree 1, further coarsening (if still necessary) is only of type <code>h</code>. All levels refer to different grid sizes.</p>
<div class="fragment"><div class="line">    <span class="keywordflow">if</span> (typeCoarsening.empty())</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Just setup some defaults</span></div>
<div class="line">        <span class="keywordflow">if</span> (typeProjection==1)</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// If we have a transition from degree p to degree 1, we only need</span></div>
<div class="line">            <span class="comment">// a single refinement where the degree is changed. We apply this</span></div>
<div class="line">            <span class="comment">// between the finest and the second finest levels.</span></div>
<div class="line">            typeCoarsening = std::string(numLevels-2, <span class="charliteral">&#39;h&#39;</span>) + <span class="stringliteral">&quot;z&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="comment">//if (typeProjection==2)</span></div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// If we have a transition where the degree is changed by only one,</span></div>
<div class="line">            <span class="comment">// we need up to p-1 transitions. The remainder needs to by of type h.</span></div>
<div class="line">            <span class="keywordflow">if</span> (numLevels&gt;numDegree)</div>
<div class="line">                typeCoarsening = std::string(numLevels-numDegree, <span class="charliteral">&#39;h&#39;</span>) + std::string(numDegree-1, <span class="charliteral">&#39;z&#39;</span>);</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                <span class="comment">// It can happen that the coarsest problem does not have degree 1 (if there</span></div>
<div class="line">                <span class="comment">// are not enough levels).</span></div>
<div class="line">                typeCoarsening = std::string(numLevels-1, <span class="charliteral">&#39;z&#39;</span>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --><p>We now compute the parameters for the coarsest grid such that the finest grid is as prescribed using the parameters <code>&ndash;Degree</code> and <code>&ndash;Refinement</code>.</p>
<div class="fragment"><div class="line">    <span class="comment">// Index 0 refers to coarsest level; we first setup that basis</span></div>
<div class="line">    std::vector&lt;gsMultiBasis&lt;&gt;&gt; bases;</div>
<div class="line">    bases.emplace_back(mp);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Adjust spline degree for coarsest level</span></div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> degreeOffset = numDegree - (numRefP+numRefZ) * (typeProjection==1?(numDegree-1):1) - bases[0].degree();</div>
<div class="line">    <span class="keywordflow">if</span> (degreeOffset&gt;0)</div>
<div class="line">        bases[0].degreeIncrease(degreeOffset);</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (degreeOffset&lt;0)</div>
<div class="line">        bases[0].degreeReduce(-degreeOffset);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Apply refinement in h for the coarses level</span></div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i = 0; i &lt; numRefine - numRefH - numRefZ; ++i)</div>
<div class="line">        bases[0].uniformRefine();</div>
</div><!-- fragment --><p>The finer grids are then constructed as indicated using the parameters <code>&ndash;Coarsening</code> and <code>&ndash;Projection</code>.</p>
<div class="fragment"><div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i = 1; i &lt; numLevels; i++)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// New basis object, which is just a copy</span></div>
<div class="line">        bases.push_back(bases.back());</div>
<div class="line">        <span class="keywordflow">if</span> (typeCoarsening[i-1] == <span class="charliteral">&#39;p&#39;</span>)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (typeProjection == 1)</div>
<div class="line">                bases.back().degreeIncrease(numDegree-1);</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                bases.back().degreeIncrease();</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (typeCoarsening[i-1] == <span class="charliteral">&#39;h&#39;</span>)</div>
<div class="line">        {</div>
<div class="line">            bases.back().uniformRefine();</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="comment">//if (typeCoarsening[i-1] == &#39;z&#39;)</span></div>
<div class="line">        {</div>
<div class="line">            bases.back().uniformRefine();</div>
<div class="line">            <span class="keywordflow">if</span> (typeProjection == 1)</div>
<div class="line">                bases.back().degreeIncrease(numDegree-1);</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                bases.back().degreeIncrease();</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --><p>The next step is the setup of the refinement and prolongation operators. In case of h-coarsening, the prolongation is the canonical embedding matrix and the restriction is its transpose.</p>
<p>In case of p- and z-coarsening, the method depends on the lumping type specified by <code>&ndash;Lumping</code>.</p>
<p>In case of lumping type 1, the restriction and the prolongation are the corresponding \(L_2\)-orthogonal projectors, given by  </p><p class="formulaDsp">
\[
  M_{\ell-1}^{-1} M_{\ell-1,\ell}
  \quad\mbox{and}\quad
  M_{\ell}^{-1} M_{\ell,\ell-1}
\]
</p>
<p> respectively. Here, \( M_{\ell} \) and \( M_{\ell-1} \) are the mass matrices on those grid levels (assembleMass). \( M_{\ell-1,\ell} = M_{\ell,\ell-1}^\top \) is obtained by deriving a mass matrix with the basis functions for the level \(\ell-1\) as trial functions and the basis functions for the level \(\ell\) as test functions (assembleMixedMass). The realization of the inverses is done by applying a conjugate gradient solver.</p>
<p>In case of lumping type 2, the matrices \( M_{\ell} \) and \( M_{\ell-1} \) are replaced by diagonal matrices, where the diagonal entries coincide with the row-sum of the \( M_{\ell} \) or \( M_{\ell-1} \), respectively. Using the partition-of-unity property, these diagonal entries are obtained by evaluating \( (\cdot,1)_{L_2(\Omega)} \) for the basis functions (assembleLumpedMass).</p>
<div class="fragment"><div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;|| Multigrid hierarchy ||\n&quot;</span>;</div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i=1; i&lt;numLevels; i++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (typeCoarsening[i-1] != <span class="charliteral">&#39;h&#39;</span>)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (typeLumping == 1)</div>
<div class="line">            {</div>
<div class="line">                <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Restriction and prolongation between levels &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; i-1 &lt;&lt; <span class="stringliteral">&quot;: L2-projection with lumped mass.\n&quot;</span>;</div>
<div class="line">                gsSparseMatrix&lt;&gt; mixedMass = assembleMixedMass(mp, bases[i], bases[i-1], bcInfo, opt);</div>
<div class="line">                gsSparseMatrix&lt;real_t&gt; prolongationMatrix</div>
<div class="line">                      = assembleLumpedMass(mp, bases[i], bcInfo, opt).asDiagonal().inverse()</div>
<div class="line">                      * mixedMass;</div>
<div class="line">                gsSparseMatrix&lt;real_t&gt; restrictionMatrix</div>
<div class="line">                      = assembleLumpedMass(mp, bases[i-1], bcInfo, opt).asDiagonal().inverse()</div>
<div class="line">                      * mixedMass.transpose();</div>
<div class="line">                prolongation[i-1] = makeMatrixOp(prolongationMatrix.moveToPtr());</div>
<div class="line">                restriction[i-1] = makeMatrixOp(restrictionMatrix.moveToPtr());</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Restriction and prolongation between levels &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; i-1 &lt;&lt; <span class="stringliteral">&quot;: exact L2-projection.\n&quot;</span>;</div>
<div class="line">                gsSparseMatrix&lt;&gt; prolongationP = assembleMixedMass(mp, bases[i], bases[i-1], bcInfo, opt);</div>
<div class="line">                gsSparseMatrix&lt;&gt; restrictionP = prolongationP.transpose();</div>
<div class="line">                gsSparseMatrix&lt;&gt; prolongationM = assembleMass(mp, bases[i], bcInfo, opt);</div>
<div class="line">                gsSparseMatrix&lt;&gt; restrictionM = assembleMass(mp, bases[i-1], bcInfo, opt);</div>
<div class="line"> </div>
<div class="line">                prolongation[i-1] = makeLinearOp(</div>
<div class="line">                    [prolongationP=<a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(prolongationP),prolongationM=<a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(prolongationM)]</div>
<div class="line">                    (<span class="keyword">const</span> gsMatrix&lt;&gt;&amp; Xcoarse, gsMatrix&lt;&gt;&amp; Xfine)</div>
<div class="line">                    {</div>
<div class="line">                        gsConjugateGradient&lt;&gt; CGSolver(prolongationM);</div>
<div class="line">                        CGSolver.setTolerance(1e-12);</div>
<div class="line">                        CGSolver.solve(prolongationP*Xcoarse,Xfine);</div>
<div class="line">                    },</div>
<div class="line">                    prolongationP.rows(), prolongationP.cols()</div>
<div class="line">                );</div>
<div class="line">                restriction[i-1] = makeLinearOp(</div>
<div class="line">                    [restrictionP=<a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(restrictionP),restrictionM=<a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(restrictionM)]</div>
<div class="line">                    (<span class="keyword">const</span> gsMatrix&lt;&gt;&amp; Xfine, gsMatrix&lt;&gt;&amp; Xcoarse)</div>
<div class="line">                    {</div>
<div class="line">                        gsConjugateGradient&lt;&gt; CGSolver(restrictionM);</div>
<div class="line">                        CGSolver.setTolerance(1e-12);</div>
<div class="line">                        CGSolver.solve(restrictionP*Xfine,Xcoarse);</div>
<div class="line">                    },</div>
<div class="line">                    restrictionP.rows(), restrictionP.cols()</div>
<div class="line">                );</div>
<div class="line"> </div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="comment">//if (typeCoarsening[i-1] == &#39;h&#39;)</span></div>
<div class="line">        {</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Restriction and prolongation between levels &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; i-1 &lt;&lt; <span class="stringliteral">&quot;: canonical embedding and its transpose.\n&quot;</span>;</div>
<div class="line">            bases[i].clone()-&gt;uniformCoarsen_withTransfer(prolongation_H[i-1],bcInfo,opt);</div>
<div class="line">            prolongation[i-1] = makeMatrixOp(prolongation_H[i-1]);</div>
<div class="line">            restriction[i-1] = makeMatrixOp(prolongation_H[i-1].transpose());</div>
<div class="line"> </div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="ttc" id="anamespacegismo_html_ab72442c3b5aeef49b3c60f6e9df77110"><div class="ttname"><a href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">gismo::give</a></div><div class="ttdeci">S give(S &amp;x)</div><div class="ttdef"><b>Definition</b> gsMemory.h:266</div></div>
</div><!-- fragment --><p>For a p-multigrid method, one has to assemble the problem for the individual levels. The assembler is used to derive the stiffness matrix for the finest level, the spline degree on the corresponding level is different to the level on the next finer level, or rediscretization is explicitly requested (using <code>&ndash;CoarseOperator 1</code>). Otherwise, Galerkin projections are used.</p>
<div class="fragment"><div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i=numLevels-1; i&gt;=0; --i)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (typeCoarseOperator == 1 || i == numLevels-1 || typeCoarsening[i] != <span class="charliteral">&#39;h&#39;</span>)</div>
<div class="line">        {</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Assemble on level &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;</div>
<div class="line">            clock.restart();</div>
<div class="line">            gsCDRAssembler&lt;real_t&gt; assembler(</div>
<div class="line">                mp,</div>
<div class="line">                bases[i],</div>
<div class="line">                bcInfo,</div>
<div class="line">                rhs_exact,</div>
<div class="line">                coeff_diff, coeff_conv, coeff_reac,</div>
<div class="line">                (dirichlet::strategy)opt.getInt(<span class="stringliteral">&quot;DirichletStrategy&quot;</span>),</div>
<div class="line">                iFace::glue</div>
<div class="line">            );</div>
<div class="line">            assembler.assemble();</div>
<div class="line">            matrices[i] = assembler.matrix();</div>
<div class="line">            <span class="keywordflow">if</span> (i==numLevels-1)</div>
<div class="line">                rhs = assembler.rhs();</div>
<div class="line">            Time_Assembly += clock.stop();</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Degree: &quot;</span> &lt;&lt; bases[i].degree()  &lt;&lt; <span class="stringliteral">&quot;, Ndof: &quot;</span> &lt;&lt; matrices[i].rows() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Apply Galerkin projection on level &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;</div>
<div class="line">            clock.restart();</div>
<div class="line">            matrices[i] = prolongation_H[i].transpose() * matrices[i+1] * prolongation_H[i];</div>
<div class="line">            Time_Galerkin += clock.stop();</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Ndof: &quot;</span> &lt;&lt; matrices[i].rows() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">        operators[i] = makeMatrixOp(matrices[i]);</div>
<div class="line">    }</div>
<div class="line">    gsSparseMatrix&lt;&gt;&amp; matrix = matrices.back();</div>
</div><!-- fragment --><p>Now, we are able to setup the <em>gsMultiGrid</em> object. This class has two kinds of constructors: stiffness matrix on the finest grid and vector of prolongation matrices (all as <em><a class="el" href="classgismo_1_1gsSparseMatrix.html" title="Sparse matrix class, based on gsEigen::SparseMatrix.">gsSparseMatrix</a></em>) vectors of all the stiffness matrices, the restriction operators and the prolongation operators (all as <em><a class="el" href="classgismo_1_1gsLinearOperator.html#a7e083f6c92575f77236d6cb193997e84" title="Shared pointer for gsLinearOperator.">gsLinearOperator::Ptr</a></em>).</p>
<p>In the first case, the stiffness matrices on the finer grids are derived automatically using a Galerkin projection.</p>
<p>Since we have a vector of stiffness matrices and since our restrictions and prolongations might not be just matrices, we need to use the second option.</p>
<div class="fragment"><div class="line">    <a class="code hl_typedef" href="classgismo_1_1gsMultiGridOp.html#a1693f061596a1ece25c96f7900b573a3">gsMultiGridOp&lt;&gt;::Ptr</a> mg = <a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#aa379574148d989edf4572077d919d546">gsMultiGridOp&lt;&gt;::make</a>(operators, prolongation, restriction);</div>
<div class="ttc" id="aclassgismo_1_1gsMultiGridOp_html_a1693f061596a1ece25c96f7900b573a3"><div class="ttname"><a href="classgismo_1_1gsMultiGridOp.html#a1693f061596a1ece25c96f7900b573a3">gismo::gsMultiGridOp::Ptr</a></div><div class="ttdeci">memory::shared_ptr&lt; gsMultiGridOp &gt; Ptr</div><div class="ttdoc">Shared pointer for gsMultiGridOp.</div><div class="ttdef"><b>Definition</b> gsMultiGrid.h:63</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiGridOp_html_aa379574148d989edf4572077d919d546"><div class="ttname"><a href="classgismo_1_1gsMultiGridOp.html#aa379574148d989edf4572077d919d546">gismo::gsMultiGridOp::make</a></div><div class="ttdeci">static uPtr make(SpMatrix fineMatrix, std::vector&lt; SpMatrixRowMajor &gt; transferMatrices, OpPtr coarseSolver=OpPtr())</div><div class="ttdoc">Make function returning smart pointer.</div><div class="ttdef"><b>Definition</b> gsMultiGrid.h:136</div></div>
</div><!-- fragment --><p>We setup the coarse solver exactly since the "matrix-free" version of <em><a class="el" href="classgismo_1_1gsMultiGridOp.html" title="Multigrid preconditioner.">gsMultiGridOp</a></em> does not setup the coarse solver automatically.</p>
<div class="fragment"><div class="line">    mg-&gt;setCoarseSolver(makeSparseLUSolver(matrices[0]));</div>
</div><!-- fragment --><p>Next, we choose the type of the cycle (1=V-cycle, 2=W-cycle). Here, we can use different options, depending if the coarsening is a h-coarsening or a coarsening which involves a change of the degree (p- or z-coarsening).</p>
<div class="fragment"><div class="line">    <span class="keywordflow">if</span> (typeCycle_p == typeCycle_h)</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Multigrid cycle type: &quot;</span> &lt;&lt; typeCycle_h &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Multigrid cycle type: &quot;</span> &lt;&lt; typeCycle_h &lt;&lt; <span class="stringliteral">&quot; for h-refinement and &quot;</span> &lt;&lt; typeCycle_p &lt;&lt; <span class="stringliteral">&quot; for p- and z-refinement\n&quot;</span>;</div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i=1; i&lt;numLevels-1; i++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (typeCoarsening[i] != <span class="charliteral">&#39;h&#39;</span>)</div>
<div class="line">            mg-&gt;setNumCycles(i,typeCycle_p);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            mg-&gt;setNumCycles(i,typeCycle_h);</div>
<div class="line">    }</div>
</div><!-- fragment --><p>The next step is the setup of the smoothers. As smoothers, one can choose an incomplete LU smoother (<code>&ndash;Smoother 1</code>), a blockwise incomplete LU smoother (<code>&ndash;Smoother 4</code>), the subspace corrected mass smoother (<code>&ndash;Smoother 3</code>; see multiGrid_example.cpp) the Gauss-Seidel smoother (<code>&ndash;Smoother 2</code>). For the levels with spline degree 1, always the Gauss-Seidel smoother is used. For the setup, we use a for loop over the levels 1,...,numLevels. On level 0, we use a direct solver.</p>
<p>Moreover, we specify the number of pre and post smoothing steps (default: 1), as given via command <code>&ndash;Smoothing</code>.</p>
<p>If a conjugate gradient solver (<code>&ndash;Solver 3</code>) is used, the post smoothing operator is the transpose of the pre smoothing. Otherwise, we choose the post smoothing to be equal to the pre smoothing. This is obtained with by setting setSymmSmooth to false.</p>
<div class="fragment"><div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i=1; i&lt;numLevels; i++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (bases[i].degree()==1)</div>
<div class="line">        {</div>
<div class="line">            mg-&gt;setSmoother(i,makeGaussSeidelOp(matrices[i]));</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Smoother for level &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: Gauss-Seidel\n&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">switch</span> (typeSmoother)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">case</span> 1:</div>
<div class="line">                mg-&gt;setSmoother(i,makeIncompleteLUOp(matrices[i]));</div>
<div class="line">                <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Smoother for level &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: Incomplete LU\n&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> 2:</div>
<div class="line">                mg-&gt;setSmoother(i,makeGaussSeidelOp(matrices[i]));</div>
<div class="line">                <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Smoother for level &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: Gauss-Seidel\n&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> 3:</div>
<div class="line">                mg-&gt;setSmoother(i,setupSubspaceCorrectedMassSmoother(matrices[i], bases[i], bcInfo, opt));</div>
<div class="line">                <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Smoother for level &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: Subspace corrected mass smoother (damping = &quot;</span>&lt;&lt;dampingSCMS&lt;&lt;<span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> 4:</div>
<div class="line">                mg-&gt;setSmoother(i,setupBlockILUT(matrices[i], bases[i], bcInfo, opt));</div>
<div class="line">                <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Smoother for level &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: Blockwise Incomplete LU\n&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">default</span>:</div>
<div class="line">                <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Unknown smoother chosen.\n&quot;</span>;</div>
<div class="line">                <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Number of smoothing steps: &quot;</span> &lt;&lt; numSmoothing &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    mg-&gt;setNumPreSmooth(numSmoothing);</div>
<div class="line">    mg-&gt;setNumPostSmooth(numSmoothing);</div>
<div class="line">    <span class="comment">// For the conjugate Gradient solver, the post smoother needs to be the transpose of the</span></div>
<div class="line">    <span class="comment">// pre smoother. For all other iterative solvers, it does not matter. So, we choose</span></div>
<div class="line">    <span class="comment">// pre smoothing and post smoothing to be the same.</span></div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Post smoothing is transpose of pre smoothing: &quot;</span> &lt;&lt; (typeSolver == 3?<span class="stringliteral">&quot;yes&quot;</span>:<span class="stringliteral">&quot;no&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    mg-&gt;setSymmSmooth(typeSolver == 3);</div>
</div><!-- fragment --><p>Next, we initialize the chosen iterative solver.</p>
<div class="fragment"><div class="line">    gsIterativeSolver&lt;&gt;::Ptr solver;</div>
<div class="line">    <span class="keywordflow">switch</span> (typeSolver)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">case</span> 1:</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;\n|| Solver information ||\np-multigrid is applied as stand-alone solver\n&quot;</span>;</div>
<div class="line">            <span class="comment">// The preconditioned gradient method is noting but applying p-multigrid as a stand-alone solver.</span></div>
<div class="line">            <span class="comment">// We have to set step size = 1 to deactivate automatic stepsize control.</span></div>
<div class="line">            solver = <a class="code hl_function" href="classgismo_1_1gsGradientMethod.html#a65bee13a4c1bab7f1a7d4f0b725fb59f">gsGradientMethod&lt;&gt;::make</a>(matrix, mg, 1);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> 2:</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;\n|| Solver information ||\nBiCGStab is applied as solver, p-multigrid as a preconditioner\n&quot;</span>;</div>
<div class="line">            solver = <a class="code hl_function" href="classgismo_1_1gsBiCgStab.html#a65bee13a4c1bab7f1a7d4f0b725fb59f">gsBiCgStab&lt;&gt;::make</a>(matrix, mg);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> 3:</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;\n|| Solver information ||\nCG is applied as solver, p-multigrid as a preconditioner\n&quot;</span>;</div>
<div class="line">            solver = <a class="code hl_function" href="classgismo_1_1gsConjugateGradient.html#a65bee13a4c1bab7f1a7d4f0b725fb59f">gsConjugateGradient&lt;&gt;::make</a>(matrix, mg);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Unknown iterative solver chosen.\n&quot;</span>;</div>
<div class="line">            <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">    }</div>
<div class="ttc" id="aclassgismo_1_1gsBiCgStab_html_a65bee13a4c1bab7f1a7d4f0b725fb59f"><div class="ttname"><a href="classgismo_1_1gsBiCgStab.html#a65bee13a4c1bab7f1a7d4f0b725fb59f">gismo::gsBiCgStab::make</a></div><div class="ttdeci">static uPtr make(const OperatorType &amp;mat, const LinOpPtr &amp;precond=LinOpPtr())</div><div class="ttdoc">Make function using a matrix (operator) and optionally a preconditionner.</div><div class="ttdef"><b>Definition</b> gsBiCgStab.h:50</div></div>
<div class="ttc" id="aclassgismo_1_1gsConjugateGradient_html_a65bee13a4c1bab7f1a7d4f0b725fb59f"><div class="ttname"><a href="classgismo_1_1gsConjugateGradient.html#a65bee13a4c1bab7f1a7d4f0b725fb59f">gismo::gsConjugateGradient::make</a></div><div class="ttdeci">static uPtr make(const OperatorType &amp;mat, const LinOpPtr &amp;precond=LinOpPtr())</div><div class="ttdoc">Make function using a matrix (operator) and optionally a preconditionner.</div><div class="ttdef"><b>Definition</b> gsConjugateGradient.h:55</div></div>
<div class="ttc" id="aclassgismo_1_1gsGradientMethod_html_a65bee13a4c1bab7f1a7d4f0b725fb59f"><div class="ttname"><a href="classgismo_1_1gsGradientMethod.html#a65bee13a4c1bab7f1a7d4f0b725fb59f">gismo::gsGradientMethod::make</a></div><div class="ttdeci">static uPtr make(const OperatorType &amp;mat, const LinOpPtr &amp;precond=LinOpPtr())</div><div class="ttdoc">Constructor using a matrix (operator) and optionally a preconditionner.</div><div class="ttdef"><b>Definition</b> gsGradientMethod.h:72</div></div>
</div><!-- fragment --><p>We choose a random initial guess.</p>
<div class="fragment"><div class="line">    gsMatrix&lt;&gt; x = gsMatrix&lt;&gt;::Random(matrix.rows(),1);</div>
</div><!-- fragment --><p>Finally, we use the iterative solver to solve the problem. We use solveDetailed with an <code>errorHistory</code> in order to be able to give the convergence behavior.</p>
<div class="fragment"><div class="line">    solver-&gt;solveDetailed( rhs, x, error_history );</div>
</div><!-- fragment --><h1><a class="anchor" id="pMultiGrid_exampleAnnotated"></a>
Annotated source file</h1>
<p>Here is the full file <code>examples/pMultiGrid_example.cpp</code>. Clicking on a function or class name will lead you to its reference documentation.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="gismo_8h.html">gismo.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacegismo.html">gismo</a>;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="classgismo_1_1gsPreconditionerOp.html#a73ef689606fbfc5909797bc3e417a4ce">gsPreconditionerOp&lt;&gt;::Ptr</a> setupSubspaceCorrectedMassSmoother(</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;&gt;</a>&amp;,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsMultiBasis.html">gsMultiBasis&lt;&gt;</a>&amp;,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsBoundaryConditions.html">gsBoundaryConditions&lt;&gt;</a>&amp;,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsOptionList.html">gsOptionList</a>&amp;</div>
<div class="line">);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="classgismo_1_1gsPreconditionerOp.html#a73ef689606fbfc5909797bc3e417a4ce">gsPreconditionerOp&lt;&gt;::Ptr</a> setupBlockILUT(</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;&gt;</a>&amp;,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsMultiBasis.html">gsMultiBasis&lt;&gt;</a>&amp;,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsBoundaryConditions.html">gsBoundaryConditions&lt;&gt;</a>&amp;,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsOptionList.html">gsOptionList</a>&amp;</div>
<div class="line">);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a> assembleLumpedMass(</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch&lt;&gt;</a>&amp; mp,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsMultiBasis.html">gsMultiBasis&lt;&gt;</a>&amp; basis,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsBoundaryConditions.html">gsBoundaryConditions&lt;&gt;</a>&amp; bcInfo,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsOptionList.html">gsOptionList</a>&amp;</div>
<div class="line">);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;&gt;</a> assembleMass(</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch&lt;&gt;</a>&amp; mp,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsMultiBasis.html">gsMultiBasis&lt;&gt;</a>&amp; basis,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsBoundaryConditions.html">gsBoundaryConditions&lt;&gt;</a>&amp; bcInfo,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsOptionList.html">gsOptionList</a>&amp;</div>
<div class="line">);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;&gt;</a> assembleMixedMass(</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch&lt;&gt;</a>&amp; mp,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsMultiBasis.html">gsMultiBasis&lt;&gt;</a>&amp; basisU,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsMultiBasis.html">gsMultiBasis&lt;&gt;</a>&amp; basisV,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsBoundaryConditions.html">gsBoundaryConditions&lt;&gt;</a>&amp; bcInfo,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsOptionList.html">gsOptionList</a>&amp;</div>
<div class="line">);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> numBenchmark = 3;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> numSplits = 0;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> numDegree = 2;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> numRefine = 6;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> typeBCHandling = 2;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> numLevels = 2;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> typeProjection = 2;</div>
<div class="line">    std::string typeCoarsening;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> typeLumping = 1;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> typeCoarseOperator = 2;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> typeCycle_p = 1;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> typeCycle_h = 2;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> typeSmoother = 1;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> numSmoothing = 1;</div>
<div class="line">    real_t dampingSCMS = 1;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> typeSolver = 2;</div>
<div class="line">    real_t tol = 1e-8;</div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> maxIter = 20;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Command line argument parser</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsCmdLine.html">gsCmdLine</a> cmd(<span class="stringliteral">&quot;This program solves the CDR-equation with a p-multigrid or h-multigrid method&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Add command line arguments</span></div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;Benchmark&quot;</span>, <span class="stringliteral">&quot;Number of the benchmark problem&quot;</span>, numBenchmark);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;P&quot;</span>, <span class="stringliteral">&quot;PatchSplits&quot;</span>, <span class="stringliteral">&quot;Number of patch splittings: split each patch that many times into 2^d patches&quot;</span>, numSplits);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;p&quot;</span>, <span class="stringliteral">&quot;Degree&quot;</span>, <span class="stringliteral">&quot;Spline degree for finest grid&quot;</span>, numDegree);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;r&quot;</span>, <span class="stringliteral">&quot;Refinement&quot;</span>, <span class="stringliteral">&quot;Number of global refinements to obtain finest grid&quot;</span>, numRefine);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;BCHandling&quot;</span>, <span class="stringliteral">&quot;Handle Dirichlet BC&#39;s by (1) elimination or (2) Nitsche&#39;s method&quot;</span>, typeBCHandling);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;l&quot;</span>, <span class="stringliteral">&quot;Levels&quot;</span>, <span class="stringliteral">&quot;Number of levels for multigrid&quot;</span>, numLevels);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;D&quot;</span>, <span class="stringliteral">&quot;Projection&quot;</span>, <span class="stringliteral">&quot;A p or z coarsening refers to (1) changing the degree directly to 1 or (2) reducing the degree by 1&quot;</span>, typeProjection);</div>
<div class="line">    cmd.addString(<span class="stringliteral">&quot;z&quot;</span>, <span class="stringliteral">&quot;Coarsening&quot;</span>, <span class="stringliteral">&quot;Coarsening strategy for each of the levels: (h) coarser grid, (p) reduced spline degree or (z) both&quot;</span>, typeCoarsening);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;L&quot;</span>, <span class="stringliteral">&quot;Lumping&quot;</span>, <span class="stringliteral">&quot;Restriction and prolongation performed with the (1) lumped or (2) full mass matrix&quot;</span>, typeLumping);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;G&quot;</span>, <span class="stringliteral">&quot;CoarseOperator&quot;</span>, <span class="stringliteral">&quot;Derive coarse stiffness matrix (1) by rediscretization or (2) using Galerkin projection if possible&quot;</span>, typeCoarseOperator);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;m&quot;</span>, <span class="stringliteral">&quot;Cycle_p&quot;</span>, <span class="stringliteral">&quot;Type of cycle where p or z-coarsening is applied: (1) V-cycle or (2) W-cycle&quot;</span>, typeCycle_p);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;M&quot;</span>, <span class="stringliteral">&quot;Cycle_h&quot;</span>, <span class="stringliteral">&quot;Type of cycle where h-coarsening is applied: (1) V-cycle or (2) W-cycle&quot;</span>, typeCycle_h);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;S&quot;</span>, <span class="stringliteral">&quot;Smoother&quot;</span>, <span class="stringliteral">&quot;Smoother: (1) ILUT, (2) Gauss-Seidel, (3) subspace corrected mass smoother or (4) Block ILUT&quot;</span>, typeSmoother);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;v&quot;</span>, <span class="stringliteral">&quot;Smoothing&quot;</span>, <span class="stringliteral">&quot;Number of pre and post smoothing steps&quot;</span>, numSmoothing);</div>
<div class="line">    cmd.addReal(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;DampingSCMS&quot;</span>, <span class="stringliteral">&quot;Damping for subspace corrected mass smoother (otherwise ignored)&quot;</span>, dampingSCMS);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;s&quot;</span>, <span class="stringliteral">&quot;Solver&quot;</span>, <span class="stringliteral">&quot;Solver: (1) mg as stand-alone solver, (2) BiCGStab prec. with mg or (3) CG prec. with mg&quot;</span>, typeSolver);</div>
<div class="line">    cmd.addReal(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;Tolerance&quot;</span>, <span class="stringliteral">&quot;Threshold for iterative solver&quot;</span>, tol);</div>
<div class="line">    cmd.addInt(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;MaxIter&quot;</span>, <span class="stringliteral">&quot;Maximum number of iterations for iterative solver&quot;</span>, maxIter);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Read parameters from command line</span></div>
<div class="line">    <span class="keywordflow">try</span> { cmd.getValues(argc,argv);  } <span class="keywordflow">catch</span> (<span class="keywordtype">int</span> rv) { <span class="keywordflow">return</span> rv; }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsOptionList.html">gsOptionList</a> opt;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Check validity of input</span></div>
<div class="line">    <span class="keywordflow">if</span> (numDegree&lt;=0)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;--Degree has to be a positive value.\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (numRefine&lt;0)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;--Refinement has to be a non-negative value.\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (numSmoothing&lt;0)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;--Smoothing has to be a non-negative value.\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (numLevels&lt;=0)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;--Levels has to be a positive value.\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (numSplits&lt;0)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;--PatchSplits has to be a non-negative value.\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (typeCycle_p&lt;=0 || typeCycle_h&lt;=0)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;--Cycle_p and Cycle_h have to be a positvie value.\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span> (typeBCHandling)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">case</span> 1:</div>
<div class="line">            opt.<a class="code hl_function" href="classgismo_1_1gsOptionList.html#a1f5c150efc2fdcb14e12580864c59984">addInt</a>(<span class="stringliteral">&quot;DirichletStrategy&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,dirichlet::elimination); <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> 2:</div>
<div class="line">            opt.<a class="code hl_function" href="classgismo_1_1gsOptionList.html#a1f5c150efc2fdcb14e12580864c59984">addInt</a>(<span class="stringliteral">&quot;DirichletStrategy&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,dirichlet::nitsche    ); <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Unknown boundary condition handling type chosen.\n&quot;</span>;</div>
<div class="line">            <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (typeLumping &lt; 1 || typeLumping &gt; 2)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Unknown lumping type chosen.\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (typeProjection &lt; 1 || typeProjection &gt; 2)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Unknown projection type chosen.\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (typeCoarseOperator &lt; 1 || typeCoarseOperator &gt; 2)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Unknown coarse operator chosen.\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Initialize solution, rhs and geometry</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a> sol_exact, rhs_exact, coeff_diff, coeff_conv, coeff_reac;</div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch&lt;&gt;</a> mp;</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;|| Benchmark information ||\n&quot;</span>;</div>
<div class="line">    <span class="keywordflow">switch</span> (numBenchmark)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">case</span> 1:</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;1) CDR-equation the unit square\n&quot;</span>;</div>
<div class="line">            mp = <a class="code hl_class" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch&lt;&gt;</a>(*<a class="code hl_struct" href="structgismo_1_1gsNurbsCreator.html">gsNurbsCreator&lt;&gt;::BSplineSquare</a>(1.0, 0.0, 0.0));</div>
<div class="line">            sol_exact = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>(<span class="stringliteral">&quot;sin(pi*x)*sin(pi*y)&quot;</span>,2);</div>
<div class="line">            rhs_exact = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>(<span class="stringliteral">&quot;1.2*pi*pi*sin(pi*x)*sin(pi*y)+0.9*pi*pi*sin(pi*x)*sin(pi*y)+0.7*pi*pi*cos(pi*x)*cos(pi*y)&quot;</span></div>
<div class="line">                            <span class="stringliteral">&quot; + 0.4*pi*pi*cos(pi*x)*cos(pi*y) +0.4*pi*cos(pi*x)*sin(pi*y)-0.2*pi*sin(pi*x)*cos(pi*y)+0.3*sin(pi*x)*sin(pi*y)&quot;</span>, 2);</div>
<div class="line">            coeff_diff = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>(<span class="stringliteral">&quot;1.2&quot;</span>,<span class="stringliteral">&quot;-0.7&quot;</span>,<span class="stringliteral">&quot;-0.4&quot;</span>,<span class="stringliteral">&quot;0.9&quot;</span>,2);</div>
<div class="line">            coeff_conv = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>(<span class="stringliteral">&quot;0.4&quot;</span>,<span class="stringliteral">&quot;-0.2&quot;</span>,2);</div>
<div class="line">            coeff_reac = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>(<span class="stringliteral">&quot;0.3&quot;</span>,2);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> 2:</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;2) Poisson equation on the quarter annulus\n&quot;</span>;</div>
<div class="line">            mp = <a class="code hl_class" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch&lt;&gt;</a>(*<a class="code hl_struct" href="structgismo_1_1gsNurbsCreator.html">gsNurbsCreator&lt;&gt;::BSplineFatQuarterAnnulus</a>(1.0, 2.0));</div>
<div class="line">            sol_exact = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>( <span class="stringliteral">&quot;-(x*x+y*y-1)*(x*x+y*y-4)*x*y*y&quot;</span>, 2);</div>
<div class="line">            rhs_exact = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>( <span class="stringliteral">&quot;2*x*(22*x*x*y*y+21*y*y*y*y-45*y*y+x*x*x*x-5*x*x+4)&quot;</span>, 2);</div>
<div class="line">            coeff_diff = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>(<span class="stringliteral">&quot;1&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;1&quot;</span>,2);</div>
<div class="line">            coeff_conv = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>(<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,2);</div>
<div class="line">            coeff_reac = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>(<span class="stringliteral">&quot;0&quot;</span>,2);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> 3:</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;3) Poisson equation on the quarter annulus\n&quot;</span>;</div>
<div class="line">            mp = <a class="code hl_class" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch&lt;&gt;</a>(*<a class="code hl_struct" href="structgismo_1_1gsNurbsCreator.html">gsNurbsCreator&lt;&gt;::BSplineFatQuarterAnnulus</a>(1.0, 2.0));</div>
<div class="line">            sol_exact = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>( <span class="stringliteral">&quot;(x^2+y^2-3*sqrt(x^2+y^2)+2)*sin(2*atan(y/x))&quot;</span>, 2);</div>
<div class="line">            rhs_exact = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>( <span class="stringliteral">&quot;(8-9*sqrt(x^2 + y^2))*sin(2*atan(y/x))/(x^2+y^2)&quot;</span>, 2);</div>
<div class="line">            coeff_diff = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>(<span class="stringliteral">&quot;1&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;1&quot;</span>,2);</div>
<div class="line">            coeff_conv = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>(<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,2);</div>
<div class="line">            coeff_reac = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>(<span class="stringliteral">&quot;0&quot;</span>,2);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> 4:</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;4) Poisson equation on an L-shaped domain\n&quot;</span>;</div>
<div class="line">            mp = <a class="code hl_class" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch&lt;&gt;</a>(*<a class="code hl_struct" href="structgismo_1_1gsNurbsCreator.html">gsNurbsCreator&lt;&gt;::BSplineLShape_p1</a>());</div>
<div class="line">            sol_exact = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>( <span class="stringliteral">&quot;if ( y&gt;0, ( (x^2+y^2)^(1.0/3.0) )*sin( (2*atan2(y,x) - pi)/3.0 ), ( (x^2+y^2)^(1.0/3.0) )*sin( (2*atan2(y,x) +3*pi)/3.0 ) )&quot;</span>, 2);</div>
<div class="line">            rhs_exact = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>( <span class="stringliteral">&quot;0&quot;</span>, 2);</div>
<div class="line">            coeff_diff = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>(<span class="stringliteral">&quot;1&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;1&quot;</span>,2);</div>
<div class="line">            coeff_conv = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>(<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,2);</div>
<div class="line">            coeff_reac = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>(<span class="stringliteral">&quot;0&quot;</span>,2);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> 5:</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;5) Poisson equation on the unit cube\n&quot;</span>;</div>
<div class="line">            mp = <a class="code hl_class" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch&lt;&gt;</a>(*<a class="code hl_struct" href="structgismo_1_1gsNurbsCreator.html">gsNurbsCreator&lt;&gt;::BSplineCube</a>((real_t)1));</div>
<div class="line">            sol_exact = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>( <span class="stringliteral">&quot;sin(pi*x)*sin(pi*y)*sin(pi*z)&quot;</span>, 3);</div>
<div class="line">            rhs_exact = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>( <span class="stringliteral">&quot;(3*pi^2)*sin(pi*x)*sin(pi*y)*sin(pi*z)&quot;</span>, 3);</div>
<div class="line">            coeff_diff = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>(<span class="stringliteral">&quot;1&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;1&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;1&quot;</span>,3);</div>
<div class="line">            coeff_conv = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>(<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,3);</div>
<div class="line">            coeff_reac = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>(<span class="stringliteral">&quot;0&quot;</span>,3);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> 6:</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;6) Poisson&#39;s equation on Yeti footprint\n&quot;</span>;</div>
<div class="line">            mp = *<span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="classgismo_1_1gsMultiPatch.html#ad7190c68d8ead80bd1b6fd7256779894">gsMultiPatch&lt;&gt;::uPtr</a><span class="keyword">&gt;</span>(<a class="code hl_class" href="classgismo_1_1gsReadFile.html">gsReadFile&lt;&gt;</a>(<span class="stringliteral">&quot;domain2d/yeti_mp2.xml&quot;</span>));</div>
<div class="line">            sol_exact = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>( <span class="stringliteral">&quot;sin(5*pi*x)*sin(5*pi*y)&quot;</span>, 2);</div>
<div class="line">            rhs_exact = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>( <span class="stringliteral">&quot;(50*pi^2)*sin(5*pi*x)*sin(5*pi*y)&quot;</span>, 2);</div>
<div class="line">            coeff_diff = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>(<span class="stringliteral">&quot;1&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;1&quot;</span>,2);</div>
<div class="line">            coeff_conv = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>(<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;0&quot;</span>,2);</div>
<div class="line">            coeff_reac = <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a>(<span class="stringliteral">&quot;0&quot;</span>,2);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Unknown benchmark case chosen.\n&quot;</span>;</div>
<div class="line">            <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Print information about benchmark</span></div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Exact solution: &quot;</span> &lt;&lt; sol_exact &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Right hand side: &quot;</span> &lt;&lt; rhs_exact &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Handling of boundary conditions: &quot;</span> &lt;&lt; (typeBCHandling==1 ? <span class="stringliteral">&quot;elimination&quot;</span> : <span class="stringliteral">&quot;Nitsche&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Handle the uniform splitting</span></div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i=0; i&lt;numSplits; ++i)</div>
<div class="line">        mp = mp.uniformSplit();</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Number of patches: &quot;</span> &lt;&lt; mp.nPatches() &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Define boundary conditions</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsBoundaryConditions.html">gsBoundaryConditions&lt;&gt;</a> bcInfo;</div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsFunctionExpr.html">gsFunctionExpr&lt;&gt;</a> zero(<span class="stringliteral">&quot;0&quot;</span>, mp.geoDim());</div>
<div class="line">    <span class="keywordflow">for</span> (gsMultiPatch&lt;&gt;::const_biterator bit = mp.bBegin(); bit != mp.bEnd(); ++bit)</div>
<div class="line">        bcInfo.<a class="code hl_function" href="classgismo_1_1gsBoundaryConditions.html#a1dd0c4f4cdae8082d37db999fc3932d2">addCondition</a>(*bit, <a class="code hl_enumvalue" href="structgismo_1_1condition__type.html#a7aead736a07eaf25623ad7bfa1f0ee2da1b4f535d1f53363637f933002efc2b4b">condition_type::dirichlet</a>, &amp;sol_exact);</div>
<div class="line">    bcInfo.<a class="code hl_function" href="classgismo_1_1gsBoundaryConditions.html#aff5423866bbe8b3870298fcef256a321">setGeoMap</a>(mp);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Setup of vector of bases</span></div>
<div class="line">    <span class="keywordflow">if</span> (typeCoarsening.empty())</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Just setup some defaults</span></div>
<div class="line">        <span class="keywordflow">if</span> (typeProjection==1)</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// If we have a transition from degree p to degree 1, we only need</span></div>
<div class="line">            <span class="comment">// a single refinement where the degree is changed. We apply this</span></div>
<div class="line">            <span class="comment">// between the finest and the second finest levels.</span></div>
<div class="line">            typeCoarsening = std::string(numLevels-2, <span class="charliteral">&#39;h&#39;</span>) + <span class="stringliteral">&quot;z&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="comment">//if (typeProjection==2)</span></div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// If we have a transition where the degree is changed by only one,</span></div>
<div class="line">            <span class="comment">// we need up to p-1 transitions. The remainder needs to by of type h.</span></div>
<div class="line">            <span class="keywordflow">if</span> (numLevels&gt;numDegree)</div>
<div class="line">                typeCoarsening = std::string(numLevels-numDegree, <span class="charliteral">&#39;h&#39;</span>) + std::string(numDegree-1, <span class="charliteral">&#39;z&#39;</span>);</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                <span class="comment">// It can happen that the coarsest problem does not have degree 1 (if there</span></div>
<div class="line">                <span class="comment">// are not enough levels).</span></div>
<div class="line">                typeCoarsening = std::string(numLevels-1, <span class="charliteral">&#39;z&#39;</span>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (typeCoarsening.size() != (<span class="keywordtype">size_t</span>)numLevels-1)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;The string provided to --Coarsening should have length &quot;</span> &lt;&lt; numLevels-1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">// Now, we count the coarsening type informations</span></div>
<div class="line">    <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> numRefH = 0, numRefP = 0, numRefZ = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i = 0; i &lt; numLevels-1; ++i)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> ( typeCoarsening[i] == <span class="charliteral">&#39;h&#39;</span>)</div>
<div class="line">            numRefH++;</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( typeCoarsening[i] == <span class="charliteral">&#39;p&#39;</span>)</div>
<div class="line">            numRefP++;</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( typeCoarsening[i] == <span class="charliteral">&#39;z&#39;</span>)</div>
<div class="line">            numRefZ++;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Unknown type given in --Coarsening.\n&quot;</span>;</div>
<div class="line">            <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (typeProjection==1 &amp;&amp; numRefP+numRefZ &gt; 1)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;If --Projection 1, there should be only one coarsening of type p or z in --Coarsening.\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (numRefine - numRefH - numRefZ&lt;0)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Cannot have more h or z refinements in --Coarsening than overall number of refinement steps.\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Vector of multibasis objects</span></div>
<div class="line">    <span class="comment">// Index 0 refers to coarsest level; we first setup that basis</span></div>
<div class="line">    std::vector&lt;gsMultiBasis&lt;&gt;&gt; bases;</div>
<div class="line">    bases.emplace_back(mp);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Adjust spline degree for coarsest level</span></div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> degreeOffset = numDegree - (numRefP+numRefZ) * (typeProjection==1?(numDegree-1):1) - bases[0].degree();</div>
<div class="line">    <span class="keywordflow">if</span> (degreeOffset&gt;0)</div>
<div class="line">        bases[0].degreeIncrease(degreeOffset);</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (degreeOffset&lt;0)</div>
<div class="line">        bases[0].degreeReduce(-degreeOffset);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Apply refinement in h for the coarses level</span></div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i = 0; i &lt; numRefine - numRefH - numRefZ; ++i)</div>
<div class="line">        bases[0].uniformRefine();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Now, we setup the remaining levels</span></div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i = 1; i &lt; numLevels; i++)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// New basis object, which is just a copy</span></div>
<div class="line">        bases.push_back(bases.back());</div>
<div class="line">        <span class="keywordflow">if</span> (typeCoarsening[i-1] == <span class="charliteral">&#39;p&#39;</span>)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (typeProjection == 1)</div>
<div class="line">                bases.back().degreeIncrease(numDegree-1);</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                bases.back().degreeIncrease();</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (typeCoarsening[i-1] == <span class="charliteral">&#39;h&#39;</span>)</div>
<div class="line">        {</div>
<div class="line">            bases.back().uniformRefine();</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="comment">//if (typeCoarsening[i-1] == &#39;z&#39;)</span></div>
<div class="line">        {</div>
<div class="line">            bases.back().uniformRefine();</div>
<div class="line">            <span class="keywordflow">if</span> (typeProjection == 1)</div>
<div class="line">                bases.back().degreeIncrease(numDegree-1);</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                bases.back().degreeIncrease();</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsGenericStopwatch.html">gsStopwatch</a> clock;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Determine prolongation/restriction operators</span></div>
<div class="line">    std::vector&lt;gsSparseMatrix&lt;real_t,RowMajor&gt;&gt; prolongation_H(numLevels-1);</div>
<div class="line">    std::vector&lt;gsLinearOperator&lt;&gt;::Ptr&gt; restriction(numLevels-1);</div>
<div class="line">    std::vector&lt;gsLinearOperator&lt;&gt;::Ptr&gt; prolongation(numLevels-1);</div>
<div class="line"> </div>
<div class="line">    clock.<a class="code hl_function" href="classgismo_1_1gsGenericStopwatch.html#a22ee094ca3f45aa4156b97d34fe678bf">restart</a>();</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;|| Multigrid hierarchy ||\n&quot;</span>;</div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i=1; i&lt;numLevels; i++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (typeCoarsening[i-1] != <span class="charliteral">&#39;h&#39;</span>)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (typeLumping == 1)</div>
<div class="line">            {</div>
<div class="line">                <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Restriction and prolongation between levels &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; i-1 &lt;&lt; <span class="stringliteral">&quot;: L2-projection with lumped mass.\n&quot;</span>;</div>
<div class="line">                <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;&gt;</a> mixedMass = assembleMixedMass(mp, bases[i], bases[i-1], bcInfo, opt);</div>
<div class="line">                <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;real_t&gt;</a> prolongationMatrix</div>
<div class="line">                      = assembleLumpedMass(mp, bases[i], bcInfo, opt).asDiagonal().inverse()</div>
<div class="line">                      * mixedMass;</div>
<div class="line">                <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;real_t&gt;</a> restrictionMatrix</div>
<div class="line">                      = assembleLumpedMass(mp, bases[i-1], bcInfo, opt).asDiagonal().inverse()</div>
<div class="line">                      * mixedMass.transpose();</div>
<div class="line">                prolongation[i-1] = makeMatrixOp(prolongationMatrix.<a class="code hl_function" href="classgismo_1_1gsSparseMatrix.html#a24da616b328c15186de32aa2c9a51938">moveToPtr</a>());</div>
<div class="line">                restriction[i-1] = makeMatrixOp(restrictionMatrix.<a class="code hl_function" href="classgismo_1_1gsSparseMatrix.html#a24da616b328c15186de32aa2c9a51938">moveToPtr</a>());</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Restriction and prolongation between levels &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; i-1 &lt;&lt; <span class="stringliteral">&quot;: exact L2-projection.\n&quot;</span>;</div>
<div class="line">                <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;&gt;</a> prolongationP = assembleMixedMass(mp, bases[i], bases[i-1], bcInfo, opt);</div>
<div class="line">                <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;&gt;</a> restrictionP = prolongationP.transpose();</div>
<div class="line">                <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;&gt;</a> prolongationM = assembleMass(mp, bases[i], bcInfo, opt);</div>
<div class="line">                <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;&gt;</a> restrictionM = assembleMass(mp, bases[i-1], bcInfo, opt);</div>
<div class="line"> </div>
<div class="line">                prolongation[i-1] = makeLinearOp(</div>
<div class="line">                    [prolongationP=<a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(prolongationP),prolongationM=<a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(prolongationM)]</div>
<div class="line">                    (<span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a>&amp; Xcoarse, <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a>&amp; Xfine)</div>
<div class="line">                    {</div>
<div class="line">                        <a class="code hl_class" href="classgismo_1_1gsConjugateGradient.html">gsConjugateGradient&lt;&gt;</a> CGSolver(prolongationM);</div>
<div class="line">                        CGSolver.setTolerance(1e-12);</div>
<div class="line">                        CGSolver.solve(prolongationP*Xcoarse,Xfine);</div>
<div class="line">                    },</div>
<div class="line">                    prolongationP.rows(), prolongationP.cols()</div>
<div class="line">                );</div>
<div class="line">                restriction[i-1] = makeLinearOp(</div>
<div class="line">                    [restrictionP=<a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(restrictionP),restrictionM=<a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(restrictionM)]</div>
<div class="line">                    (<span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a>&amp; Xfine, <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a>&amp; Xcoarse)</div>
<div class="line">                    {</div>
<div class="line">                        <a class="code hl_class" href="classgismo_1_1gsConjugateGradient.html">gsConjugateGradient&lt;&gt;</a> CGSolver(restrictionM);</div>
<div class="line">                        CGSolver.setTolerance(1e-12);</div>
<div class="line">                        CGSolver.solve(restrictionP*Xfine,Xcoarse);</div>
<div class="line">                    },</div>
<div class="line">                    restrictionP.rows(), restrictionP.cols()</div>
<div class="line">                );</div>
<div class="line"> </div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="comment">//if (typeCoarsening[i-1] == &#39;h&#39;)</span></div>
<div class="line">        {</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Restriction and prolongation between levels &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; i-1 &lt;&lt; <span class="stringliteral">&quot;: canonical embedding and its transpose.\n&quot;</span>;</div>
<div class="line">            bases[i].clone()-&gt;uniformCoarsen_withTransfer(prolongation_H[i-1],bcInfo,opt);</div>
<div class="line">            prolongation[i-1] = makeMatrixOp(prolongation_H[i-1]);</div>
<div class="line">            restriction[i-1] = makeMatrixOp(prolongation_H[i-1].transpose());</div>
<div class="line"> </div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">double</span> Time_Transfer = clock.<a class="code hl_function" href="classgismo_1_1gsGenericStopwatch.html#a0041a7a576355baa3259e96e9f0e4eb3">stop</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Determine stiffness matrices (assembling or Galerkin projection)</span></div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;\n|| Assembling ||\n&quot;</span>;</div>
<div class="line">    std::vector&lt;gsSparseMatrix&lt;&gt;&gt; matrices(numLevels);</div>
<div class="line">    std::vector&lt;gsLinearOperator&lt;&gt;::Ptr&gt; operators(numLevels);</div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a> rhs;</div>
<div class="line">    <span class="keywordtype">double</span> Time_Assembly = 0, Time_Galerkin = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i=numLevels-1; i&gt;=0; --i)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (typeCoarseOperator == 1 || i == numLevels-1 || typeCoarsening[i] != <span class="charliteral">&#39;h&#39;</span>)</div>
<div class="line">        {</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Assemble on level &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;</div>
<div class="line">            clock.<a class="code hl_function" href="classgismo_1_1gsGenericStopwatch.html#a22ee094ca3f45aa4156b97d34fe678bf">restart</a>();</div>
<div class="line">            <a class="code hl_class" href="classgismo_1_1gsCDRAssembler.html">gsCDRAssembler&lt;real_t&gt;</a> assembler(</div>
<div class="line">                mp,</div>
<div class="line">                bases[i],</div>
<div class="line">                bcInfo,</div>
<div class="line">                rhs_exact,</div>
<div class="line">                coeff_diff, coeff_conv, coeff_reac,</div>
<div class="line">                (dirichlet::strategy)opt.<a class="code hl_function" href="classgismo_1_1gsOptionList.html#a7a30d84a62647a575d6045ea8cd847ea">getInt</a>(<span class="stringliteral">&quot;DirichletStrategy&quot;</span>),</div>
<div class="line">                iFace::glue</div>
<div class="line">            );</div>
<div class="line">            assembler.assemble();</div>
<div class="line">            matrices[i] = assembler.matrix();</div>
<div class="line">            <span class="keywordflow">if</span> (i==numLevels-1)</div>
<div class="line">                rhs = assembler.rhs();</div>
<div class="line">            Time_Assembly += clock.<a class="code hl_function" href="classgismo_1_1gsGenericStopwatch.html#a0041a7a576355baa3259e96e9f0e4eb3">stop</a>();</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Degree: &quot;</span> &lt;&lt; bases[i].degree()  &lt;&lt; <span class="stringliteral">&quot;, Ndof: &quot;</span> &lt;&lt; matrices[i].rows() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Apply Galerkin projection on level &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;</div>
<div class="line">            clock.<a class="code hl_function" href="classgismo_1_1gsGenericStopwatch.html#a22ee094ca3f45aa4156b97d34fe678bf">restart</a>();</div>
<div class="line">            matrices[i] = prolongation_H[i].transpose() * matrices[i+1] * prolongation_H[i];</div>
<div class="line">            Time_Galerkin += clock.<a class="code hl_function" href="classgismo_1_1gsGenericStopwatch.html#a0041a7a576355baa3259e96e9f0e4eb3">stop</a>();</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Ndof: &quot;</span> &lt;&lt; matrices[i].rows() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">        operators[i] = makeMatrixOp(matrices[i]);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;&gt;</a>&amp; matrix = matrices.back();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Setup of multigrid object</span></div>
<div class="line">    <a class="code hl_typedef" href="classgismo_1_1gsMultiGridOp.html#a1693f061596a1ece25c96f7900b573a3">gsMultiGridOp&lt;&gt;::Ptr</a> mg = <a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#aa379574148d989edf4572077d919d546">gsMultiGridOp&lt;&gt;::make</a>(operators, prolongation, restriction);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Setup of solver for coarsest grid level</span></div>
<div class="line">    clock.<a class="code hl_function" href="classgismo_1_1gsGenericStopwatch.html#a22ee094ca3f45aa4156b97d34fe678bf">restart</a>();</div>
<div class="line">    mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#a68354ca89c65a5c40310b185082ca557">setCoarseSolver</a>(makeSparseLUSolver(matrices[0]));</div>
<div class="line">    <span class="keywordtype">double</span> Time_Coarse_Solver_Setup = clock.<a class="code hl_function" href="classgismo_1_1gsGenericStopwatch.html#a0041a7a576355baa3259e96e9f0e4eb3">stop</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Specify the number of cycles</span></div>
<div class="line">    <span class="comment">// For coarsest level, we stick to 1 in any case (exact solver is never cycled)</span></div>
<div class="line">    <span class="keywordflow">if</span> (typeCycle_p == typeCycle_h)</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Multigrid cycle type: &quot;</span> &lt;&lt; typeCycle_h &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Multigrid cycle type: &quot;</span> &lt;&lt; typeCycle_h &lt;&lt; <span class="stringliteral">&quot; for h-refinement and &quot;</span> &lt;&lt; typeCycle_p &lt;&lt; <span class="stringliteral">&quot; for p- and z-refinement\n&quot;</span>;</div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i=1; i&lt;numLevels-1; i++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (typeCoarsening[i] != <span class="charliteral">&#39;h&#39;</span>)</div>
<div class="line">            mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#a42c119b27458d6d8e6b498b405e19dca">setNumCycles</a>(i,typeCycle_p);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#a42c119b27458d6d8e6b498b405e19dca">setNumCycles</a>(i,typeCycle_h);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Setup of smoothers</span></div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;\n|| Smoother ||\n&quot;</span>;</div>
<div class="line">    opt.<a class="code hl_function" href="classgismo_1_1gsOptionList.html#a8eb1cbaadd87bafb8c9a2b9f065c4bfd">addReal</a>(<span class="stringliteral">&quot;Scaling&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,0.12);           <span class="comment">// only used for SCMS</span></div>
<div class="line">    opt.<a class="code hl_function" href="classgismo_1_1gsOptionList.html#a8eb1cbaadd87bafb8c9a2b9f065c4bfd">addReal</a>(<span class="stringliteral">&quot;Damping&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,dampingSCMS);    <span class="comment">// only used for SCMS</span></div>
<div class="line">    clock.<a class="code hl_function" href="classgismo_1_1gsGenericStopwatch.html#a22ee094ca3f45aa4156b97d34fe678bf">restart</a>();</div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i=1; i&lt;numLevels; i++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (bases[i].degree()==1)</div>
<div class="line">        {</div>
<div class="line">            mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#a575e42fb17150414509b0651bbaa7e8a">setSmoother</a>(i,makeGaussSeidelOp(matrices[i]));</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Smoother for level &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: Gauss-Seidel\n&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">switch</span> (typeSmoother)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">case</span> 1:</div>
<div class="line">                mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#a575e42fb17150414509b0651bbaa7e8a">setSmoother</a>(i,makeIncompleteLUOp(matrices[i]));</div>
<div class="line">                <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Smoother for level &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: Incomplete LU\n&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> 2:</div>
<div class="line">                mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#a575e42fb17150414509b0651bbaa7e8a">setSmoother</a>(i,makeGaussSeidelOp(matrices[i]));</div>
<div class="line">                <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Smoother for level &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: Gauss-Seidel\n&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> 3:</div>
<div class="line">                mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#a575e42fb17150414509b0651bbaa7e8a">setSmoother</a>(i,setupSubspaceCorrectedMassSmoother(matrices[i], bases[i], bcInfo, opt));</div>
<div class="line">                <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Smoother for level &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: Subspace corrected mass smoother (damping = &quot;</span>&lt;&lt;dampingSCMS&lt;&lt;<span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> 4:</div>
<div class="line">                mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#a575e42fb17150414509b0651bbaa7e8a">setSmoother</a>(i,setupBlockILUT(matrices[i], bases[i], bcInfo, opt));</div>
<div class="line">                <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Smoother for level &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: Blockwise Incomplete LU\n&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">default</span>:</div>
<div class="line">                <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Unknown smoother chosen.\n&quot;</span>;</div>
<div class="line">                <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Number of smoothing steps: &quot;</span> &lt;&lt; numSmoothing &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#af17c268f2b7e37835c03701d0d676c19">setNumPreSmooth</a>(numSmoothing);</div>
<div class="line">    mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#a31ca402ad9cb955a3b9bd7305d0f8a17">setNumPostSmooth</a>(numSmoothing);</div>
<div class="line">    <span class="comment">// For the conjugate Gradient solver, the post smoother needs to be the transpose of the</span></div>
<div class="line">    <span class="comment">// pre smoother. For all other iterative solvers, it does not matter. So, we choose</span></div>
<div class="line">    <span class="comment">// pre smoothing and post smoothing to be the same.</span></div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Post smoothing is transpose of pre smoothing: &quot;</span> &lt;&lt; (typeSolver == 3?<span class="stringliteral">&quot;yes&quot;</span>:<span class="stringliteral">&quot;no&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    mg-&gt;<a class="code hl_function" href="classgismo_1_1gsMultiGridOp.html#a4c5846872963e26fa59fc9a7bd807efb">setSymmSmooth</a>(typeSolver == 3);</div>
<div class="line">    <span class="keywordtype">double</span> Time_Smoother_Setup = clock.<a class="code hl_function" href="classgismo_1_1gsGenericStopwatch.html#a0041a7a576355baa3259e96e9f0e4eb3">stop</a>();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;\n|| Setup Timings || \n&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Total transfer setup time: &quot;</span> &lt;&lt; Time_Transfer &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Total Assembly time: &quot;</span> &lt;&lt; Time_Assembly &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Total Galerkin projections: &quot;</span> &lt;&lt; Time_Galerkin &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Coarse solver setup time: &quot;</span> &lt;&lt; Time_Coarse_Solver_Setup &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Smoother setup time: &quot;</span> &lt;&lt; Time_Smoother_Setup &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Total setup time: &quot;</span> &lt;&lt; Time_Assembly + Time_Galerkin + Time_Transfer</div>
<div class="line">        + Time_Coarse_Solver_Setup + Time_Smoother_Setup &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Setup of iterative solver</span></div>
<div class="line">    gsIterativeSolver&lt;&gt;::Ptr solver;</div>
<div class="line">    <span class="keywordflow">switch</span> (typeSolver)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">case</span> 1:</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;\n|| Solver information ||\np-multigrid is applied as stand-alone solver\n&quot;</span>;</div>
<div class="line">            <span class="comment">// The preconditioned gradient method is noting but applying p-multigrid as a stand-alone solver.</span></div>
<div class="line">            <span class="comment">// We have to set step size = 1 to deactivate automatic stepsize control.</span></div>
<div class="line">            solver = <a class="code hl_function" href="classgismo_1_1gsGradientMethod.html#a65bee13a4c1bab7f1a7d4f0b725fb59f">gsGradientMethod&lt;&gt;::make</a>(matrix, mg, 1);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> 2:</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;\n|| Solver information ||\nBiCGStab is applied as solver, p-multigrid as a preconditioner\n&quot;</span>;</div>
<div class="line">            solver = <a class="code hl_function" href="classgismo_1_1gsBiCgStab.html#a65bee13a4c1bab7f1a7d4f0b725fb59f">gsBiCgStab&lt;&gt;::make</a>(matrix, mg);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> 3:</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;\n|| Solver information ||\nCG is applied as solver, p-multigrid as a preconditioner\n&quot;</span>;</div>
<div class="line">            solver = <a class="code hl_function" href="classgismo_1_1gsConjugateGradient.html#a65bee13a4c1bab7f1a7d4f0b725fb59f">gsConjugateGradient&lt;&gt;::make</a>(matrix, mg);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Unknown iterative solver chosen.\n&quot;</span>;</div>
<div class="line">            <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a> x = <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;::Random</a>(matrix.rows(),1);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Unfortunately, the stopping criterion is relative to the rhs not to the initial residual (not yet configurable)</span></div>
<div class="line">    <span class="keyword">const</span> real_t rhs_norm = rhs.norm();</div>
<div class="line">    solver-&gt;<a class="code hl_function" href="classgismo_1_1gsIterativeSolver.html#a41cd86e56b44b46ca179e4e05703fc8e">setTolerance</a>( tol * (rhs-matrix*x).norm() / rhs_norm );</div>
<div class="line">    solver-&gt;<a class="code hl_function" href="classgismo_1_1gsIterativeSolver.html#a11f636c7dcc30209e2d33f1154a96bf3">setMaxIterations</a>(maxIter);</div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a> error_history;</div>
<div class="line">    clock.<a class="code hl_function" href="classgismo_1_1gsGenericStopwatch.html#a22ee094ca3f45aa4156b97d34fe678bf">restart</a>();</div>
<div class="line">    solver-&gt;<a class="code hl_function" href="classgismo_1_1gsIterativeSolver.html#a6e04b51fc392c977e044b1c25f9d32c6">solveDetailed</a>( rhs, x, error_history );</div>
<div class="line">    <span class="keywordtype">double</span> Time_Solve = clock.<a class="code hl_function" href="classgismo_1_1gsGenericStopwatch.html#a0041a7a576355baa3259e96e9f0e4eb3">stop</a>();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;   0  |  Residual norm: &quot;</span> &lt;&lt; std::setprecision(6) &lt;&lt; (error_history(0,0) * rhs_norm) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i=1; i&lt;error_history.rows(); ++i)</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; std::right &lt;&lt; std::setw(4) &lt;&lt; i</div>
<div class="line">               &lt;&lt; <span class="stringliteral">&quot;  |  Residual norm: &quot;</span></div>
<div class="line">               &lt;&lt; std::setprecision(6) &lt;&lt; std::left &lt;&lt; std::setw(15) &lt;&lt; (error_history(i,0) * rhs_norm)</div>
<div class="line">               &lt;&lt; <span class="stringliteral">&quot;  reduction:  1 / &quot;</span></div>
<div class="line">               &lt;&lt; std::setprecision(3) &lt;&lt; (error_history(i-1,0)/error_history(i,0))</div>
<div class="line">               &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">bool</span> success = solver-&gt;<a class="code hl_function" href="classgismo_1_1gsIterativeSolver.html#ad651792969ec8e02432af05f6e2e7822">error</a>() &lt;= solver-&gt;<a class="code hl_function" href="classgismo_1_1gsIterativeSolver.html#a2720b14a5781bbbef350348211375fcb">tolerance</a>();</div>
<div class="line">    <span class="keywordflow">if</span> (success)</div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Solver reached accuracy goal after &quot;</span> &lt;&lt; solver-&gt;<a class="code hl_function" href="classgismo_1_1gsIterativeSolver.html#a03ac4dbc2131d84b7c4427be6e761de3">iterations</a>() &lt;&lt; <span class="stringliteral">&quot; iterations.\n&quot;</span>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Solver did not reach accuracy goal within &quot;</span> &lt;&lt; solver-&gt;<a class="code hl_function" href="classgismo_1_1gsIterativeSolver.html#a03ac4dbc2131d84b7c4427be6e761de3">iterations</a>() &lt;&lt; <span class="stringliteral">&quot; iterations.\n&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;The iteration took &quot;</span> &lt;&lt; Time_Solve &lt;&lt; <span class="stringliteral">&quot; seconds.\n&quot;</span>;</div>
<div class="line">    <span class="comment">// Determine residual and l2 error</span></div>
<div class="line">    <a class="code hl_define" href="gsDebug_8h.html#af6177e1e282640c3cb9175565f84a432">gsInfo</a> &lt;&lt; <span class="stringliteral">&quot;Residual after solving: &quot;</span>  &lt;&lt; (rhs-matrix*x).norm() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> success ? EXIT_SUCCESS : EXIT_FAILURE;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create the subspace corrected mass smoother</span></div>
<div class="line"><a class="code hl_typedef" href="classgismo_1_1gsPreconditionerOp.html#a73ef689606fbfc5909797bc3e417a4ce">gsPreconditionerOp&lt;&gt;::Ptr</a> setupSubspaceCorrectedMassSmoother(</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;&gt;</a>&amp; matrix,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsMultiBasis.html">gsMultiBasis&lt;&gt;</a>&amp; mb,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsBoundaryConditions.html">gsBoundaryConditions&lt;&gt;</a>&amp; bc,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsOptionList.html">gsOptionList</a>&amp; opt</div>
<div class="line">)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#a368985810450e531ca9324d659d9e1e2">short_t</a> dim = mb.topology().dim();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Setup dof mapper</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsDofMapper.html">gsDofMapper</a> dm;</div>
<div class="line">    mb.getMapper(</div>
<div class="line">       (dirichlet::strategy)opt.<a class="code hl_function" href="classgismo_1_1gsOptionList.html#a7a30d84a62647a575d6045ea8cd847ea">getInt</a>(<span class="stringliteral">&quot;DirichletStrategy&quot;</span>),</div>
<div class="line">       iFace::glue,</div>
<div class="line">       bc,</div>
<div class="line">       dm,</div>
<div class="line">       0</div>
<div class="line">    );</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> nTotalDofs = dm.<a class="code hl_function" href="classgismo_1_1gsDofMapper.html#aae5019a3c2c3bb7d79ff5d05b090101f">freeSize</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Decompose the whole domain into components</span></div>
<div class="line">    std::vector&lt; std::vector&lt;patchComponent&gt; &gt; components = mb.topology().allComponents(<span class="keyword">true</span>);</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> nr_components = components.size();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Setup Dirichlet boundary conditions</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsBoundaryConditions.html">gsBoundaryConditions&lt;&gt;</a> dir_bc;</div>
<div class="line">    <span class="keywordflow">for</span> ( <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> ps=0; ps &lt; 2*dim; ++ps )</div>
<div class="line">        dir_bc.<a class="code hl_function" href="classgismo_1_1gsBoundaryConditions.html#a1dd0c4f4cdae8082d37db999fc3932d2">addCondition</a>( 0, 1+ps, <a class="code hl_enumvalue" href="structgismo_1_1condition__type.html#a7aead736a07eaf25623ad7bfa1f0ee2da1b4f535d1f53363637f933002efc2b4b">condition_type::dirichlet</a>, NULL );</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Setup transfer matrices and local preconditioners</span></div>
<div class="line">    std::vector&lt; gsSparseMatrix&lt;real_t,RowMajor&gt; &gt; transfers;</div>
<div class="line">    transfers.reserve(nr_components);</div>
<div class="line">    std::vector&lt; gsLinearOperator&lt;&gt;::Ptr &gt; ops;</div>
<div class="line">    ops.reserve(nr_components);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> i=0; i&lt;nr_components; ++i)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;index_t&gt;</a> indices;</div>
<div class="line">        std::vector&lt;gsBasis&lt;&gt;::uPtr&gt; bases = mb.componentBasis_withIndices(components[i],dm,indices,<span class="keyword">true</span>);</div>
<div class="line">        <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> sz = indices.rows();</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsSparseEntries.html">gsSparseEntries&lt;&gt;</a> se;</div>
<div class="line">        se.reserve(sz);</div>
<div class="line">        <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> l=0; l&lt;sz; ++l)</div>
<div class="line">            se.add(indices(l,0),l,(real_t)(1));</div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;real_t,RowMajor&gt;</a> transfer(nTotalDofs,sz);</div>
<div class="line">        transfer.setFrom(se);</div>
<div class="line">        <span class="keywordflow">if</span> (sz&gt;0)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (bases[0]-&gt;dim() == dim)</div>
<div class="line">            {</div>
<div class="line">                <a class="code hl_define" href="gsDebug_8h.html#afef28a292b09ce4b06f94e6ed3b8abb4">GISMO_ASSERT</a> ( bases.size() == 1, <span class="stringliteral">&quot;Only one basis is expected for each patch.&quot;</span> );</div>
<div class="line">                ops.push_back(</div>
<div class="line">                    <a class="code hl_class" href="classgismo_1_1gsPatchPreconditionersCreator.html">gsPatchPreconditionersCreator&lt;&gt;::subspaceCorrectedMassSmootherOp</a>(</div>
<div class="line">                        *(bases[0]),</div>
<div class="line">                        dir_bc,</div>
<div class="line">                        <a class="code hl_class" href="classgismo_1_1gsOptionList.html">gsOptionList</a>(),</div>
<div class="line">                        opt.<a class="code hl_function" href="classgismo_1_1gsOptionList.html#a7c40ddd4ee31ebbd48cc64fb0ba6a3c9">getReal</a>(<span class="stringliteral">&quot;Scaling&quot;</span>)</div>
<div class="line">                    )</div>
<div class="line">                );</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;&gt;</a> mat = transfer.transpose() * matrix * transfer;</div>
<div class="line">                ops.push_back( makeSparseCholeskySolver(mat) );</div>
<div class="line">            }</div>
<div class="line">            transfers.push_back(<a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(transfer));</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_typedef" href="classgismo_1_1gsPreconditionerOp.html#a62eed84808d09f9125546e10cddc6a5a">gsPreconditionerOp&lt;&gt;::uPtr</a> result = <a class="code hl_function" href="classgismo_1_1gsPreconditionerFromOp.html#acb39d514900c1fc91c4e811867cb8dad">gsPreconditionerFromOp&lt;&gt;::make</a>(makeMatrixOp(matrix), <a class="code hl_class" href="classgismo_1_1gsAdditiveOp.html">gsAdditiveOp&lt;&gt;::make</a>(transfers, ops));</div>
<div class="line">    result-&gt;<a class="code hl_function" href="classgismo_1_1gsPreconditionerOp.html#ac08d3df9c39d7a0e92c1a32438429157">setOptions</a>(opt);</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(result);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="classgismo_1_1gsPreconditionerOp.html#a73ef689606fbfc5909797bc3e417a4ce">gsPreconditionerOp&lt;&gt;::Ptr</a> setupBlockILUT(</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;&gt;</a>&amp; A,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsMultiBasis.html">gsMultiBasis&lt;&gt;</a>&amp; mb,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsBoundaryConditions.html">gsBoundaryConditions&lt;&gt;</a>&amp; bc,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsOptionList.html">gsOptionList</a>&amp; opt</div>
<div class="line">)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> nPatches = mb.nPieces();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Setup dof mapper</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsDofMapper.html">gsDofMapper</a> dm;</div>
<div class="line">    mb.getMapper(</div>
<div class="line">       (dirichlet::strategy)opt.<a class="code hl_function" href="classgismo_1_1gsOptionList.html#a7a30d84a62647a575d6045ea8cd847ea">getInt</a>(<span class="stringliteral">&quot;DirichletStrategy&quot;</span>),</div>
<div class="line">       iFace::glue,</div>
<div class="line">       bc,</div>
<div class="line">       dm,</div>
<div class="line">       0</div>
<div class="line">    );</div>
<div class="line">    <span class="comment">// Subdivide the overal dofs into</span></div>
<div class="line">    <span class="comment">//   a) the patch-local dofs (l=0,...,nPatches-1)</span></div>
<div class="line">    <span class="comment">//   b) the coupled dofs (l=nPatches)</span></div>
<div class="line">    std::vector&lt;index_t&gt; sizes(nPatches+1);</div>
<div class="line">    std::vector&lt;index_t&gt; shifts(nPatches+1);</div>
<div class="line">    shifts[0] = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> k=0; k&lt;nPatches; k++)</div>
<div class="line">    {</div>
<div class="line">        sizes[k] = dm.<a class="code hl_function" href="classgismo_1_1gsDofMapper.html#aac2ac682a747b1187b53a862741ab802">findFreeUncoupled</a>(k).rows();</div>
<div class="line">        shifts[k+1] = shifts[k] + sizes[k];</div>
<div class="line">    }</div>
<div class="line">    sizes[nPatches] = A.rows() - shifts[nPatches];</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Vector of factorized operators</span></div>
<div class="line">    std::vector&lt; gsEigen::PermutationMatrix&lt;Dynamic,Dynamic,index_t&gt; &gt; P(nPatches+1);</div>
<div class="line">    <span class="comment">// Vector of factorized operators</span></div>
<div class="line">    std::vector&lt; gsEigen::PermutationMatrix&lt;Dynamic,Dynamic,index_t&gt; &gt; Pinv(nPatches+1);</div>
<div class="line">    <span class="comment">// Define the A_aprox matrix</span></div>
<div class="line">    <span class="comment">// Inefficient since it does not use a sparse matrix</span></div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a> A_aprox(A.rows(),A.cols());</div>
<div class="line">    A_aprox.setZero();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;&gt;</a> S = A.block(shifts[nPatches],shifts[nPatches],sizes[nPatches],sizes[nPatches]);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> k=0 ; k&lt;nPatches; k++)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Diagonal entries</span></div>
<div class="line">        <a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;&gt;</a> block = A.block(shifts[k],shifts[k],sizes[k],sizes[k]);</div>
<div class="line">        gsEigen::IncompleteLUT&lt;real_t&gt; ilu;</div>
<div class="line">        ilu.setFillfactor(1);</div>
<div class="line">        ilu.compute(block);</div>
<div class="line">        P[k] = ilu.fillReducingPermutation();</div>
<div class="line">        Pinv[k] = ilu.inversePermutation();</div>
<div class="line">        A_aprox.block(shifts[k],shifts[k],sizes[k],sizes[k]) = ilu.factors();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Schur complement and off-diagonal contributions</span></div>
<div class="line">        <span class="keywordflow">if</span> (sizes[nPatches]&gt;0)</div>
<div class="line">        {</div>
<div class="line">            <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a> ddB = A.block(shifts[nPatches],shifts[k],sizes[nPatches],sizes[k]);</div>
<div class="line">            <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a> ddC = A.block(shifts[k],shifts[nPatches],sizes[k],sizes[nPatches]);</div>
<div class="line">            <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a> ddBtilde = ilu.factors().triangularView&lt;gsEigen::Upper&gt;().transpose().solve((ddB*P[k]).transpose()).transpose();</div>
<div class="line">            <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a> ddCtilde = ilu.factors().triangularView&lt;gsEigen::UnitLower&gt;().solve(Pinv[k]*ddC);</div>
<div class="line"> </div>
<div class="line">            S -= (ddBtilde*ddCtilde).sparseView();</div>
<div class="line">            A_aprox.block(shifts[k],shifts[nPatches],sizes[k],sizes[nPatches]) = ddCtilde;</div>
<div class="line">            A_aprox.block(shifts[nPatches],shifts[k],sizes[nPatches],sizes[k]) = ddBtilde;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// If there is no coupling (for example if there is only one patch), the work</span></div>
<div class="line">    <span class="comment">// is done. We should not try to compute the ilu factorization then.</span></div>
<div class="line">    <span class="keywordflow">if</span> (sizes[nPatches]&gt;0)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Preform ILUT on the S-matrix.</span></div>
<div class="line">        gsEigen::IncompleteLUT&lt;real_t&gt; ilu;</div>
<div class="line">        ilu.setFillfactor(1);</div>
<div class="line">        ilu.compute(S);</div>
<div class="line">        P[nPatches] = ilu.fillReducingPermutation();</div>
<div class="line">        Pinv[nPatches] = ilu.inversePermutation();</div>
<div class="line">        A_aprox.block(shifts[nPatches],shifts[nPatches],sizes[nPatches],sizes[nPatches]) = ilu.factors();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_function" href="classgismo_1_1gsPreconditionerFromOp.html#acb39d514900c1fc91c4e811867cb8dad">gsPreconditionerFromOp&lt;&gt;::make</a>(</div>
<div class="line">        makeMatrixOp(A),</div>
<div class="line">        makeLinearOp(</div>
<div class="line">            [m_A_aprox=<a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(A_aprox), m_P=<a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(P), m_Pinv=<a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(Pinv),m_shifts=<a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(shifts),m_sizes=<a class="code hl_function" href="namespacegismo.html#ab72442c3b5aeef49b3c60f6e9df77110">give</a>(sizes),</div>
<div class="line">                m_nPatches=nPatches](<span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a>&amp; rhs, <a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a>&amp; x)</div>
<div class="line">            {</div>
<div class="line">                x.setZero(rhs.rows(),rhs.cols());</div>
<div class="line">                <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> k=0; k&lt;=m_nPatches; ++k)</div>
<div class="line">                    x.block(m_shifts[k],0,m_sizes[k],1) = m_Pinv[k]*rhs.block(m_shifts[k],0,m_sizes[k],1);</div>
<div class="line">                x = m_A_aprox.template triangularView&lt;gsEigen::UnitLower&gt;().solve(x);</div>
<div class="line">                x = m_A_aprox.template triangularView&lt;gsEigen::Upper&gt;().solve(x);</div>
<div class="line">                <span class="keywordflow">for</span> (<a class="code hl_define" href="gsConfig_8h.html#ad722078677c063a09661059674fb996c">index_t</a> k=0; k&lt;=m_nPatches; ++k)</div>
<div class="line">                    x.block(m_shifts[k],0,m_sizes[k],1) = m_P[k]*x.block(m_shifts[k],0,m_sizes[k],1);</div>
<div class="line">            },</div>
<div class="line">            A.rows(),</div>
<div class="line">            A.cols()</div>
<div class="line">        )</div>
<div class="line">    );</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classgismo_1_1gsMatrix.html">gsMatrix&lt;&gt;</a> assembleLumpedMass(</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch&lt;&gt;</a>&amp; mp,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsMultiBasis.html">gsMultiBasis&lt;&gt;</a>&amp; basis,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsBoundaryConditions.html">gsBoundaryConditions&lt;&gt;</a>&amp; bcInfo,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsOptionList.html">gsOptionList</a>&amp; opt</div>
<div class="line">)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">typedef</span> <a class="code hl_typedef" href="classgismo_1_1gsExprAssembler.html#a16c60fa6666b6a61c747b016c385a4e2">gsExprAssembler&lt;real_t&gt;::geometryMap</a> geometryMap;</div>
<div class="line">    <span class="keyword">typedef</span> <a class="code hl_class" href="classgismo_1_1expr_1_1gsFeVariable.html">gsExprAssembler&lt;real_t&gt;::variable</a> variable;</div>
<div class="line">    <span class="keyword">typedef</span> <a class="code hl_class" href="classgismo_1_1expr_1_1gsFeSpace.html">gsExprAssembler&lt;real_t&gt;::space</a> space;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsExprAssembler.html">gsExprAssembler&lt;real_t&gt;</a> ex(1,1);</div>
<div class="line">    geometryMap G = ex.getMap(mp);</div>
<div class="line">    space w_n = ex.getSpace(basis, 1, 0);</div>
<div class="line">    w_n.setInterfaceCont(0);</div>
<div class="line">    <span class="keywordflow">if</span> ((dirichlet::strategy)opt.<a class="code hl_function" href="classgismo_1_1gsOptionList.html#a7a30d84a62647a575d6045ea8cd847ea">getInt</a>(<span class="stringliteral">&quot;DirichletStrategy&quot;</span>) == dirichlet::elimination)</div>
<div class="line">    {</div>
<div class="line">        w_n.setup(bcInfo, dirichlet::interpolation, 0);</div>
<div class="line">    }</div>
<div class="line">    ex.setIntegrationElements(basis);</div>
<div class="line">    ex.initSystem();</div>
<div class="line">    ex.assemble(w_n * <a class="code hl_function" href="namespacegismo_1_1expr.html#a37e91c8b6c3efac383e28a3cb2b5f092">meas</a>(G));</div>
<div class="line">    <span class="keywordflow">return</span> ex.rhs();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;&gt;</a> assembleMass(</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch&lt;&gt;</a>&amp; mp,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsMultiBasis.html">gsMultiBasis&lt;&gt;</a>&amp; basis,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsBoundaryConditions.html">gsBoundaryConditions&lt;&gt;</a>&amp; bcInfo,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsOptionList.html">gsOptionList</a>&amp; opt</div>
<div class="line">)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">typedef</span> <a class="code hl_typedef" href="classgismo_1_1gsExprAssembler.html#a16c60fa6666b6a61c747b016c385a4e2">gsExprAssembler&lt;real_t&gt;::geometryMap</a> geometryMap;</div>
<div class="line">    <span class="keyword">typedef</span> <a class="code hl_class" href="classgismo_1_1expr_1_1gsFeVariable.html">gsExprAssembler&lt;real_t&gt;::variable</a> variable;</div>
<div class="line">    <span class="keyword">typedef</span> <a class="code hl_class" href="classgismo_1_1expr_1_1gsFeSpace.html">gsExprAssembler&lt;real_t&gt;::space</a> space;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsExprAssembler.html">gsExprAssembler&lt;real_t&gt;</a> ex(1,1);</div>
<div class="line">    geometryMap G = ex.getMap(mp);</div>
<div class="line">    space w_n = ex.getSpace(basis, 1, 0);</div>
<div class="line">    <span class="keywordflow">if</span> ((dirichlet::strategy)opt.<a class="code hl_function" href="classgismo_1_1gsOptionList.html#a7a30d84a62647a575d6045ea8cd847ea">getInt</a>(<span class="stringliteral">&quot;DirichletStrategy&quot;</span>) == dirichlet::elimination)</div>
<div class="line">    {</div>
<div class="line">        w_n.setup(bcInfo, dirichlet::interpolation, 0);</div>
<div class="line">    }</div>
<div class="line">    ex.setIntegrationElements(basis);</div>
<div class="line">    ex.initSystem();</div>
<div class="line">    ex.assemble(w_n * <a class="code hl_function" href="namespacegismo_1_1expr.html#a37e91c8b6c3efac383e28a3cb2b5f092">meas</a>(G) * w_n.tr());</div>
<div class="line">    <span class="keywordflow">return</span> ex.matrix();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix&lt;&gt;</a> assembleMixedMass(</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch&lt;&gt;</a>&amp; mp,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsMultiBasis.html">gsMultiBasis&lt;&gt;</a>&amp; basisU,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsMultiBasis.html">gsMultiBasis&lt;&gt;</a>&amp; basisV,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsBoundaryConditions.html">gsBoundaryConditions&lt;&gt;</a>&amp; bcInfo,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgismo_1_1gsOptionList.html">gsOptionList</a>&amp; opt</div>
<div class="line">)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">typedef</span> <a class="code hl_typedef" href="classgismo_1_1gsExprAssembler.html#a16c60fa6666b6a61c747b016c385a4e2">gsExprAssembler&lt;real_t&gt;::geometryMap</a> geometryMap;</div>
<div class="line">    <span class="keyword">typedef</span> <a class="code hl_class" href="classgismo_1_1expr_1_1gsFeVariable.html">gsExprAssembler&lt;real_t&gt;::variable</a> variable;</div>
<div class="line">    <span class="keyword">typedef</span> <a class="code hl_class" href="classgismo_1_1expr_1_1gsFeSpace.html">gsExprAssembler&lt;real_t&gt;::space</a> space;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classgismo_1_1gsExprAssembler.html">gsExprAssembler&lt;real_t&gt;</a> ex(1,1);</div>
<div class="line">    geometryMap G = ex.getMap(mp);</div>
<div class="line">    space v_n = ex.getSpace(basisU, 1, 0);</div>
<div class="line">    space u_n = ex.getTestSpace(v_n, basisV);</div>
<div class="line">    <span class="keywordflow">if</span> ((dirichlet::strategy)opt.<a class="code hl_function" href="classgismo_1_1gsOptionList.html#a7a30d84a62647a575d6045ea8cd847ea">getInt</a>(<span class="stringliteral">&quot;DirichletStrategy&quot;</span>) == dirichlet::elimination)</div>
<div class="line">    {</div>
<div class="line">        v_n.setup(bcInfo, dirichlet::interpolation, 0);</div>
<div class="line">        u_n.setup(bcInfo, dirichlet::interpolation, 0);</div>
<div class="line">    }</div>
<div class="line">    ex.setIntegrationElements(basisU);</div>
<div class="line">    ex.initSystem();</div>
<div class="line">    ex.assemble(u_n * <a class="code hl_function" href="namespacegismo_1_1expr.html#a37e91c8b6c3efac383e28a3cb2b5f092">meas</a>(G) * v_n.tr());</div>
<div class="line">    <span class="keywordflow">return</span> ex.matrix().transpose();</div>
<div class="line">}</div>
<div class="ttc" id="aclassgismo_1_1expr_1_1gsFeSpace_html"><div class="ttname"><a href="classgismo_1_1expr_1_1gsFeSpace.html">gismo::expr::gsFeSpace</a></div><div class="ttdef"><b>Definition</b> gsExpressions.h:973</div></div>
<div class="ttc" id="aclassgismo_1_1expr_1_1gsFeVariable_html"><div class="ttname"><a href="classgismo_1_1expr_1_1gsFeVariable.html">gismo::expr::gsFeVariable</a></div><div class="ttdef"><b>Definition</b> gsExpressions.h:928</div></div>
<div class="ttc" id="aclassgismo_1_1gsAdditiveOp_html"><div class="ttname"><a href="classgismo_1_1gsAdditiveOp.html">gismo::gsAdditiveOp</a></div><div class="ttdoc">Generic preconditioner which applies an arbitrary linear operator to the residual.</div><div class="ttdef"><b>Definition</b> gsAdditiveOp.h:51</div></div>
<div class="ttc" id="aclassgismo_1_1gsBoundaryConditions_html"><div class="ttname"><a href="classgismo_1_1gsBoundaryConditions.html">gismo::gsBoundaryConditions</a></div><div class="ttdoc">Class containing a set of boundary conditions.</div><div class="ttdef"><b>Definition</b> gsBoundaryConditions.h:342</div></div>
<div class="ttc" id="aclassgismo_1_1gsBoundaryConditions_html_a1dd0c4f4cdae8082d37db999fc3932d2"><div class="ttname"><a href="classgismo_1_1gsBoundaryConditions.html#a1dd0c4f4cdae8082d37db999fc3932d2">gismo::gsBoundaryConditions::addCondition</a></div><div class="ttdeci">void addCondition(int p, boxSide s, condition_type::type t, gsFunctionSet&lt; T &gt; *f, short_t unknown=0, bool parametric=false, int comp=-1)</div><div class="ttdoc">Adds another boundary condition.</div><div class="ttdef"><b>Definition</b> gsBoundaryConditions.h:650</div></div>
<div class="ttc" id="aclassgismo_1_1gsBoundaryConditions_html_aff5423866bbe8b3870298fcef256a321"><div class="ttname"><a href="classgismo_1_1gsBoundaryConditions.html#aff5423866bbe8b3870298fcef256a321">gismo::gsBoundaryConditions::setGeoMap</a></div><div class="ttdeci">void setGeoMap(const gsFunctionSet&lt; T &gt; &amp;gm)</div><div class="ttdoc">Set the geometry map to evaluate boundary conditions.</div><div class="ttdef"><b>Definition</b> gsBoundaryConditions.h:916</div></div>
<div class="ttc" id="aclassgismo_1_1gsCDRAssembler_html"><div class="ttname"><a href="classgismo_1_1gsCDRAssembler.html">gismo::gsCDRAssembler</a></div><div class="ttdoc">Implementation of an (multiple righ-hand side) Poisson solver.</div><div class="ttdef"><b>Definition</b> gsCDRAssembler.h:50</div></div>
<div class="ttc" id="aclassgismo_1_1gsCmdLine_html"><div class="ttname"><a href="classgismo_1_1gsCmdLine.html">gismo::gsCmdLine</a></div><div class="ttdoc">Class for command-line argument parsing.</div><div class="ttdef"><b>Definition</b> gsCmdLine.h:57</div></div>
<div class="ttc" id="aclassgismo_1_1gsConjugateGradient_html"><div class="ttname"><a href="classgismo_1_1gsConjugateGradient.html">gismo::gsConjugateGradient</a></div><div class="ttdoc">The conjugate gradient method.</div><div class="ttdef"><b>Definition</b> gsConjugateGradient.h:30</div></div>
<div class="ttc" id="aclassgismo_1_1gsDofMapper_html"><div class="ttname"><a href="classgismo_1_1gsDofMapper.html">gismo::gsDofMapper</a></div><div class="ttdoc">Maintains a mapping from patch-local dofs to global dof indices and allows the elimination of individ...</div><div class="ttdef"><b>Definition</b> gsDofMapper.h:69</div></div>
<div class="ttc" id="aclassgismo_1_1gsDofMapper_html_aac2ac682a747b1187b53a862741ab802"><div class="ttname"><a href="classgismo_1_1gsDofMapper.html#aac2ac682a747b1187b53a862741ab802">gismo::gsDofMapper::findFreeUncoupled</a></div><div class="ttdeci">gsVector&lt; index_t &gt; findFreeUncoupled(const index_t k) const</div><div class="ttdoc">Returns all free, not coupled dofs on patch k (local dof indices)</div><div class="ttdef"><b>Definition</b> gsDofMapper.cpp:709</div></div>
<div class="ttc" id="aclassgismo_1_1gsDofMapper_html_aae5019a3c2c3bb7d79ff5d05b090101f"><div class="ttname"><a href="classgismo_1_1gsDofMapper.html#aae5019a3c2c3bb7d79ff5d05b090101f">gismo::gsDofMapper::freeSize</a></div><div class="ttdeci">index_t freeSize() const</div><div class="ttdoc">Returns the number of free (not eliminated) dofs.</div><div class="ttdef"><b>Definition</b> gsDofMapper.h:436</div></div>
<div class="ttc" id="aclassgismo_1_1gsExprAssembler_html"><div class="ttname"><a href="classgismo_1_1gsExprAssembler.html">gismo::gsExprAssembler</a></div><div class="ttdef"><b>Definition</b> gsExprAssembler.h:33</div></div>
<div class="ttc" id="aclassgismo_1_1gsExprAssembler_html_a16c60fa6666b6a61c747b016c385a4e2"><div class="ttname"><a href="classgismo_1_1gsExprAssembler.html#a16c60fa6666b6a61c747b016c385a4e2">gismo::gsExprAssembler::geometryMap</a></div><div class="ttdeci">gsExprHelper&lt; T &gt;::geometryMap geometryMap</div><div class="ttdoc">Geometry map type.</div><div class="ttdef"><b>Definition</b> gsExprAssembler.h:65</div></div>
<div class="ttc" id="aclassgismo_1_1gsFunctionExpr_html"><div class="ttname"><a href="classgismo_1_1gsFunctionExpr.html">gismo::gsFunctionExpr</a></div><div class="ttdoc">Class defining a multivariate (real or vector) function given by a string mathematical expression.</div><div class="ttdef"><b>Definition</b> gsFunctionExpr.h:52</div></div>
<div class="ttc" id="aclassgismo_1_1gsGenericStopwatch_html"><div class="ttname"><a href="classgismo_1_1gsGenericStopwatch.html">gismo::gsGenericStopwatch&lt; WallClock &gt;</a></div></div>
<div class="ttc" id="aclassgismo_1_1gsGenericStopwatch_html_a0041a7a576355baa3259e96e9f0e4eb3"><div class="ttname"><a href="classgismo_1_1gsGenericStopwatch.html#a0041a7a576355baa3259e96e9f0e4eb3">gismo::gsGenericStopwatch::stop</a></div><div class="ttdeci">double stop()</div><div class="ttdoc">Return elapsed time in seconds.</div><div class="ttdef"><b>Definition</b> gsStopwatch.h:83</div></div>
<div class="ttc" id="aclassgismo_1_1gsGenericStopwatch_html_a22ee094ca3f45aa4156b97d34fe678bf"><div class="ttname"><a href="classgismo_1_1gsGenericStopwatch.html#a22ee094ca3f45aa4156b97d34fe678bf">gismo::gsGenericStopwatch::restart</a></div><div class="ttdeci">void restart()</div><div class="ttdoc">Start taking the time.</div><div class="ttdef"><b>Definition</b> gsStopwatch.h:80</div></div>
<div class="ttc" id="aclassgismo_1_1gsIterativeSolver_html_a03ac4dbc2131d84b7c4427be6e761de3"><div class="ttname"><a href="classgismo_1_1gsIterativeSolver.html#a03ac4dbc2131d84b7c4427be6e761de3">gismo::gsIterativeSolver::iterations</a></div><div class="ttdeci">index_t iterations() const</div><div class="ttdoc">The number of iterations needed to reach the error criteria.</div><div class="ttdef"><b>Definition</b> gsIterativeSolver.h:226</div></div>
<div class="ttc" id="aclassgismo_1_1gsIterativeSolver_html_a11f636c7dcc30209e2d33f1154a96bf3"><div class="ttname"><a href="classgismo_1_1gsIterativeSolver.html#a11f636c7dcc30209e2d33f1154a96bf3">gismo::gsIterativeSolver::setMaxIterations</a></div><div class="ttdeci">void setMaxIterations(index_t max_iters)</div><div class="ttdoc">Set the maximum number of iterations (default: 1000)</div><div class="ttdef"><b>Definition</b> gsIterativeSolver.h:220</div></div>
<div class="ttc" id="aclassgismo_1_1gsIterativeSolver_html_a2720b14a5781bbbef350348211375fcb"><div class="ttname"><a href="classgismo_1_1gsIterativeSolver.html#a2720b14a5781bbbef350348211375fcb">gismo::gsIterativeSolver::tolerance</a></div><div class="ttdeci">T tolerance() const</div><div class="ttdoc">The chosen tolerance for the error criteria on the relative residual error.</div><div class="ttdef"><b>Definition</b> gsIterativeSolver.h:235</div></div>
<div class="ttc" id="aclassgismo_1_1gsIterativeSolver_html_a41cd86e56b44b46ca179e4e05703fc8e"><div class="ttname"><a href="classgismo_1_1gsIterativeSolver.html#a41cd86e56b44b46ca179e4e05703fc8e">gismo::gsIterativeSolver::setTolerance</a></div><div class="ttdeci">void setTolerance(T tol)</div><div class="ttdoc">Set the tolerance for the error criteria on the relative residual error (default: 1e-10)</div><div class="ttdef"><b>Definition</b> gsIterativeSolver.h:223</div></div>
<div class="ttc" id="aclassgismo_1_1gsIterativeSolver_html_a6e04b51fc392c977e044b1c25f9d32c6"><div class="ttname"><a href="classgismo_1_1gsIterativeSolver.html#a6e04b51fc392c977e044b1c25f9d32c6">gismo::gsIterativeSolver::solveDetailed</a></div><div class="ttdeci">void solveDetailed(const VectorType &amp;rhs, VectorType &amp;x, VectorType &amp;error_history)</div><div class="ttdoc">Solves the linear system and stores the solution in x and records the error histroy.</div><div class="ttdef"><b>Definition</b> gsIterativeSolver.h:134</div></div>
<div class="ttc" id="aclassgismo_1_1gsIterativeSolver_html_ad651792969ec8e02432af05f6e2e7822"><div class="ttname"><a href="classgismo_1_1gsIterativeSolver.html#ad651792969ec8e02432af05f6e2e7822">gismo::gsIterativeSolver::error</a></div><div class="ttdeci">T error() const</div><div class="ttdoc">The relative residual error of the current iterate.</div><div class="ttdef"><b>Definition</b> gsIterativeSolver.h:232</div></div>
<div class="ttc" id="aclassgismo_1_1gsMatrix_html"><div class="ttname"><a href="classgismo_1_1gsMatrix.html">gismo::gsMatrix</a></div><div class="ttdoc">A matrix with arbitrary coefficient type and fixed or dynamic size.</div><div class="ttdef"><b>Definition</b> gsMatrix.h:41</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiBasis_html"><div class="ttname"><a href="classgismo_1_1gsMultiBasis.html">gismo::gsMultiBasis</a></div><div class="ttdoc">Holds a set of patch-wise bases and their topology information.</div><div class="ttdef"><b>Definition</b> gsMultiBasis.h:37</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiGridOp_html_a31ca402ad9cb955a3b9bd7305d0f8a17"><div class="ttname"><a href="classgismo_1_1gsMultiGridOp.html#a31ca402ad9cb955a3b9bd7305d0f8a17">gismo::gsMultiGridOp::setNumPostSmooth</a></div><div class="ttdeci">void setNumPostSmooth(index_t n)</div><div class="ttdoc">Set number of post-smoothing steps to perform.</div><div class="ttdef"><b>Definition</b> gsMultiGrid.h:314</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiGridOp_html_a42c119b27458d6d8e6b498b405e19dca"><div class="ttname"><a href="classgismo_1_1gsMultiGridOp.html#a42c119b27458d6d8e6b498b405e19dca">gismo::gsMultiGridOp::setNumCycles</a></div><div class="ttdeci">void setNumCycles(index_t n)</div><div class="ttdef"><b>Definition</b> gsMultiGrid.h:328</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiGridOp_html_a4c5846872963e26fa59fc9a7bd807efb"><div class="ttname"><a href="classgismo_1_1gsMultiGridOp.html#a4c5846872963e26fa59fc9a7bd807efb">gismo::gsMultiGridOp::setSymmSmooth</a></div><div class="ttdeci">void setSymmSmooth(bool s)</div><div class="ttdef"><b>Definition</b> gsMultiGrid.h:321</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiGridOp_html_a575e42fb17150414509b0651bbaa7e8a"><div class="ttname"><a href="classgismo_1_1gsMultiGridOp.html#a575e42fb17150414509b0651bbaa7e8a">gismo::gsMultiGridOp::setSmoother</a></div><div class="ttdeci">void setSmoother(index_t lvl, const PrecondPtr &amp;sm)</div><div class="ttdef"><b>Definition</b> gsMultiGrid.hpp:284</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiGridOp_html_a68354ca89c65a5c40310b185082ca557"><div class="ttname"><a href="classgismo_1_1gsMultiGridOp.html#a68354ca89c65a5c40310b185082ca557">gismo::gsMultiGridOp::setCoarseSolver</a></div><div class="ttdeci">void setCoarseSolver(const OpPtr &amp;sol)</div><div class="ttdoc">Set the solver for the coarsest problem (level 0)</div><div class="ttdef"><b>Definition</b> gsMultiGrid.h:302</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiGridOp_html_af17c268f2b7e37835c03701d0d676c19"><div class="ttname"><a href="classgismo_1_1gsMultiGridOp.html#af17c268f2b7e37835c03701d0d676c19">gismo::gsMultiGridOp::setNumPreSmooth</a></div><div class="ttdeci">void setNumPreSmooth(index_t n)</div><div class="ttdoc">Set number of pre-smoothing steps to perform.</div><div class="ttdef"><b>Definition</b> gsMultiGrid.h:308</div></div>
<div class="ttc" id="aclassgismo_1_1gsMultiPatch_html"><div class="ttname"><a href="classgismo_1_1gsMultiPatch.html">gismo::gsMultiPatch</a></div><div class="ttdoc">Container class for a set of geometry patches and their topology, that is, the interface connections ...</div><div class="ttdef"><b>Definition</b> gsMultiPatch.h:100</div></div>
<div class="ttc" id="aclassgismo_1_1gsOptionList_html"><div class="ttname"><a href="classgismo_1_1gsOptionList.html">gismo::gsOptionList</a></div><div class="ttdoc">Class which holds a list of parameters/options, and provides easy access to them.</div><div class="ttdef"><b>Definition</b> gsOptionList.h:33</div></div>
<div class="ttc" id="aclassgismo_1_1gsOptionList_html_a1f5c150efc2fdcb14e12580864c59984"><div class="ttname"><a href="classgismo_1_1gsOptionList.html#a1f5c150efc2fdcb14e12580864c59984">gismo::gsOptionList::addInt</a></div><div class="ttdeci">void addInt(const std::string &amp;label, const std::string &amp;desc, const index_t &amp;value)</div><div class="ttdoc">Adds a option named label, with description desc and value value.</div><div class="ttdef"><b>Definition</b> gsOptionList.cpp:201</div></div>
<div class="ttc" id="aclassgismo_1_1gsOptionList_html_a7a30d84a62647a575d6045ea8cd847ea"><div class="ttname"><a href="classgismo_1_1gsOptionList.html#a7a30d84a62647a575d6045ea8cd847ea">gismo::gsOptionList::getInt</a></div><div class="ttdeci">const index_t &amp; getInt(const std::string &amp;label) const</div><div class="ttdoc">Reads value for option label from options.</div><div class="ttdef"><b>Definition</b> gsOptionList.cpp:37</div></div>
<div class="ttc" id="aclassgismo_1_1gsOptionList_html_a7c40ddd4ee31ebbd48cc64fb0ba6a3c9"><div class="ttname"><a href="classgismo_1_1gsOptionList.html#a7c40ddd4ee31ebbd48cc64fb0ba6a3c9">gismo::gsOptionList::getReal</a></div><div class="ttdeci">Real getReal(const std::string &amp;label) const</div><div class="ttdoc">Reads value for option label from options.</div><div class="ttdef"><b>Definition</b> gsOptionList.cpp:44</div></div>
<div class="ttc" id="aclassgismo_1_1gsOptionList_html_a8eb1cbaadd87bafb8c9a2b9f065c4bfd"><div class="ttname"><a href="classgismo_1_1gsOptionList.html#a8eb1cbaadd87bafb8c9a2b9f065c4bfd">gismo::gsOptionList::addReal</a></div><div class="ttdeci">void addReal(const std::string &amp;label, const std::string &amp;desc, const Real &amp;value)</div><div class="ttdoc">Adds a option named label, with description desc and value value.</div><div class="ttdef"><b>Definition</b> gsOptionList.cpp:211</div></div>
<div class="ttc" id="aclassgismo_1_1gsPatchPreconditionersCreator_html"><div class="ttname"><a href="classgismo_1_1gsPatchPreconditionersCreator.html">gismo::gsPatchPreconditionersCreator</a></div><div class="ttdoc">Provides robust preconditioners for single patch geometries.</div><div class="ttdef"><b>Definition</b> gsPatchPreconditionersCreator.h:30</div></div>
<div class="ttc" id="aclassgismo_1_1gsPreconditionerFromOp_html_acb39d514900c1fc91c4e811867cb8dad"><div class="ttname"><a href="classgismo_1_1gsPreconditionerFromOp.html#acb39d514900c1fc91c4e811867cb8dad">gismo::gsPreconditionerFromOp::make</a></div><div class="ttdeci">static uPtr make(BasePtr underlying, BasePtr preconditioner, T tau=(T) 1)</div><div class="ttdoc">Make function returning a smart pointer.</div><div class="ttdef"><b>Definition</b> gsPreconditioner.h:188</div></div>
<div class="ttc" id="aclassgismo_1_1gsPreconditionerOp_html_a62eed84808d09f9125546e10cddc6a5a"><div class="ttname"><a href="classgismo_1_1gsPreconditionerOp.html#a62eed84808d09f9125546e10cddc6a5a">gismo::gsPreconditionerOp::uPtr</a></div><div class="ttdeci">memory::unique_ptr&lt; gsPreconditionerOp &gt; uPtr</div><div class="ttdoc">Unique pointer for gsLinearOperator.</div><div class="ttdef"><b>Definition</b> gsPreconditioner.h:50</div></div>
<div class="ttc" id="aclassgismo_1_1gsPreconditionerOp_html_a73ef689606fbfc5909797bc3e417a4ce"><div class="ttname"><a href="classgismo_1_1gsPreconditionerOp.html#a73ef689606fbfc5909797bc3e417a4ce">gismo::gsPreconditionerOp::Ptr</a></div><div class="ttdeci">memory::shared_ptr&lt; gsPreconditionerOp &gt; Ptr</div><div class="ttdoc">Shared pointer for gsLinearOperator.</div><div class="ttdef"><b>Definition</b> gsPreconditioner.h:47</div></div>
<div class="ttc" id="aclassgismo_1_1gsPreconditionerOp_html_ac08d3df9c39d7a0e92c1a32438429157"><div class="ttname"><a href="classgismo_1_1gsPreconditionerOp.html#ac08d3df9c39d7a0e92c1a32438429157">gismo::gsPreconditionerOp::setOptions</a></div><div class="ttdeci">virtual void setOptions(const gsOptionList &amp;opt)</div><div class="ttdoc">Set options based on a gsOptionList object.</div><div class="ttdef"><b>Definition</b> gsPreconditioner.h:111</div></div>
<div class="ttc" id="aclassgismo_1_1gsReadFile_html"><div class="ttname"><a href="classgismo_1_1gsReadFile.html">gismo::gsReadFile</a></div><div class="ttdoc">Reads an object from a data file, if such the requested object exists in the file.</div><div class="ttdef"><b>Definition</b> gsReadFile.h:43</div></div>
<div class="ttc" id="aclassgismo_1_1gsSparseEntries_html"><div class="ttname"><a href="classgismo_1_1gsSparseEntries.html">gismo::gsSparseEntries</a></div><div class="ttdoc">Class that provides a container for triplets (i,j,value) to be filled in a sparse matrix.</div><div class="ttdef"><b>Definition</b> gsSparseMatrix.h:34</div></div>
<div class="ttc" id="aclassgismo_1_1gsSparseMatrix_html"><div class="ttname"><a href="classgismo_1_1gsSparseMatrix.html">gismo::gsSparseMatrix</a></div><div class="ttdoc">Sparse matrix class, based on gsEigen::SparseMatrix.</div><div class="ttdef"><b>Definition</b> gsSparseMatrix.h:139</div></div>
<div class="ttc" id="aclassgismo_1_1gsSparseMatrix_html_a24da616b328c15186de32aa2c9a51938"><div class="ttname"><a href="classgismo_1_1gsSparseMatrix.html#a24da616b328c15186de32aa2c9a51938">gismo::gsSparseMatrix::moveToPtr</a></div><div class="ttdeci">uPtr moveToPtr()</div><div class="ttdoc">This function returns a smart pointer to the matrix. After calling it, the matrix object becomes empt...</div><div class="ttdef"><b>Definition</b> gsSparseMatrix.h:247</div></div>
<div class="ttc" id="agismo_8h_html"><div class="ttname"><a href="gismo_8h.html">gismo.h</a></div><div class="ttdoc">Main header to be included by clients using the G+Smo library.</div></div>
<div class="ttc" id="agsConfig_8h_html_a368985810450e531ca9324d659d9e1e2"><div class="ttname"><a href="gsConfig_8h.html#a368985810450e531ca9324d659d9e1e2">short_t</a></div><div class="ttdeci">#define short_t</div><div class="ttdef"><b>Definition</b> gsConfig.h:35</div></div>
<div class="ttc" id="agsDebug_8h_html_afef28a292b09ce4b06f94e6ed3b8abb4"><div class="ttname"><a href="gsDebug_8h.html#afef28a292b09ce4b06f94e6ed3b8abb4">GISMO_ASSERT</a></div><div class="ttdeci">#define GISMO_ASSERT(cond, message)</div><div class="ttdef"><b>Definition</b> gsDebug.h:89</div></div>
<div class="ttc" id="anamespacegismo_1_1expr_html_a37e91c8b6c3efac383e28a3cb2b5f092"><div class="ttname"><a href="namespacegismo_1_1expr.html#a37e91c8b6c3efac383e28a3cb2b5f092">gismo::expr::meas</a></div><div class="ttdeci">EIGEN_STRONG_INLINE meas_expr&lt; T &gt; meas(const gsGeometryMap&lt; T &gt; &amp;G)</div><div class="ttdoc">The measure of a geometry map.</div><div class="ttdef"><b>Definition</b> gsExpressions.h:4555</div></div>
<div class="ttc" id="anamespacegismo_html"><div class="ttname"><a href="namespacegismo.html">gismo</a></div><div class="ttdoc">The G+Smo namespace, containing all definitions for the library.</div></div>
<div class="ttc" id="astructgismo_1_1gsNurbsCreator_html"><div class="ttname"><a href="structgismo_1_1gsNurbsCreator.html">gismo::gsNurbsCreator</a></div><div class="ttdoc">Class gsNurbsCreator provides some simple examples of Nurbs Geometries.</div><div class="ttdef"><b>Definition</b> gsNurbsCreator.h:37</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Jan 20 2025 09:35:27 for G+Smo by Doxygen v1.9.8 </li>
  </ul>
</div>
<!-- Piwik --> 
<!--
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? "https://stats.sylphide-consulting.com/piwik/" : "http://stats.sylphide-consulting.com/piwik/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 20);
piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
</script><noscript><p><img src="http://stats.sylphide-consulting.com/piwik/piwik.php?idsite=20" style="border:0" alt="" /></p></noscript>
-->
<!-- End Piwik Tracking Code -->
</body>
</html>

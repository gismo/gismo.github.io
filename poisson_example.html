<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<title>G+Smo: poisson_example.cpp</title>
<link href="gismodoxy_tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://people.ricam.oeaw.ac.at/gismo/mj/MathJax.js"></script>
<link href="doxygen.css"   rel="stylesheet" type="text/css" />
<link href="gismodoxy.css" rel="stylesheet" type="text/css">
<!--  -->
<!-- <script type="text/javascript"> -->
<!-- </script> -->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- <a name="top"></a> -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="gslogo-doxy.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname"><a href="index.html"><font style="font-variant:small-caps;">G+S</font><font style="font-variant:small-caps;"
															    color="#000000">mo</font></a>
   &#160;<span id="projectnumber">25.01.0</span>
   </div>
   <div id="projectbrief">Geometry + Simulation Modules</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('poisson_example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">poisson_example.cpp</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Poisson equation:  </p><p class="formulaDsp">
\begin{eqnarray*}
                    -\Delta\mathbf{u} &amp;=&amp; \mathbf{f} \quad \text{in} \quad \Omega,         \\
                           \mathbf{u} &amp;=&amp; \mathbf{g} \quad \text{on} \quad \Gamma_D,       \\
   \mathbf{n} \cdot \nabla \mathbf{u} &amp;=&amp; \mathbf{h} \quad \text{on} \quad \Gamma_N,
\end{eqnarray*}
</p>
<p> where \(\mathbf{n}\) is the outward pointing unit normal vector, \(\Gamma_D\) and \(\Gamma_N\) are the parts of the boundary where Dirichlet (essential) and Neumann (natural) boundary conditions are prescribed, respectively.</p>
<p>We can also create a own <code></code>.cpp and solve more complicated Poisson problems. In this tutorial, we explain how to do this. As an example we will use the <code>poisson2_example.cpp</code> file in the example folder. We will go through essentials of the code in details (For more detail of the solver see the documentation for <a class="el" href="classgismo_1_1gsPoissonAssembler.html">gsPoissonAssembler</a>, <a class="el" href="classgismo_1_1gsAssembler.html">gsAssembler</a>, and <a class="el" href="classgismo_1_1gsVisitorPoisson.html">gsVisitorPoisson</a>.)</p>
<p>First we include the library and use the gismo namespace.</p>
<div class="fragment"></div><!-- fragment --><p>We add a command-line argument which allows the user to create a Paraview visualization file.</p>
<div class="fragment"></div><!-- fragment --><p>Our Poisson problem is defined by source (right-hand side) function and Dirichlet function data:</p>
<div class="fragment"></div><!-- fragment --><h1><a class="anchor" id="TPGeometry"></a>
Geometry</h1>
<p>Inside the main function we declare the geometry. Note that we use the <a class="el" href="classgismo_1_1gsMultiPatch.html">gsMultiPatch</a> class even if we only have a single patch geometry. The <a class="el" href="structgismo_1_1gsNurbsCreator.html">gsNurbsCreator</a> class creates several simple geometries:</p>
<div class="fragment"></div><!-- fragment --><p>The chosen geometry represents the unit square consisting of 2 x 2 squares, which all have side-length 0.5, i.e., the computational domain is the unit square \(\Omega = (0,1)^2\) .</p>
<p>In this example, the four patches are numbered as follows:</p>
<table class="doxtable">
<tr>
<td>1</td><td>3 </td></tr>
<tr>
<td>0</td><td>2 </td></tr>
</table>
<h1><a class="anchor" id="BCs"></a>
Boundary Conditions</h1>
<p>The boundary conditions are stored in an object of type <a class="el" href="classgismo_1_1gsBoundaryConditions.html">gsBoundaryConditions</a> :</p>
<p>In the 2D case, each patch has 4 boundary sides: <em>west</em>, <em>east</em>, <em>south</em> and <em>north</em> (in addition there is <em>front</em> and <em>back</em> for 3D geometries). The boundary conditions must be specified for each patch.</p>
<p>In this example we have 4 patches forming a unit square, hence we need to specify 8 boundary conditions:</p>
<div class="fragment"></div><!-- fragment --><p>Note that the first argument in the <code>addCondition</code> is the patch number.</p>
<h1><a class="anchor" id="tp_dbasis"></a>
Discretization Basis</h1>
<p>We now need a discretization basis. We use the basis from the patches. We can h or/and p refine this basis (in any order).</p>
<div class="fragment"></div><!-- fragment --><p>Here, we perform h- and k-refinement.</p>
<h1><a class="anchor" id="solver"></a>
Setting up and using the Assembler</h1>
<p>We use <a class="el" href="classgismo_1_1gsPoissonAssembler.html">gsPoissonAssembler</a> class to assemble and the Poisson equation. First we initialize the class object by giving the geometry (patches), discretization basis, boundary condition, source function, and the strategies for treating Dirichlet boundary conditions and patch interfaces:</p>
<div class="fragment"></div><!-- fragment --><p>With <code>dirichlet::elimination</code>, we specify that the degrees of freedom (DOF) on the Dirichlet bondary should be eliminated already during the assembling process.</p>
<p>By <code>iFace::glue</code>, we specify that the DOFs at interfaces should be "glued" together in the sense that corresponding DOFs will be identified with each other and treated as one global DOF (which results in \(C^0\)-continuity at the interfaces).</p>
<p>Executing the assembling process is then done by calling </p><div class="fragment"><div class="line">assembler.assemble();</div>
</div><!-- fragment --><p> The assembled system matrix and the right-hand-side can be accessed via </p><div class="fragment"><div class="line">assembler.matrix();</div>
<div class="line">assembler.rhs();</div>
</div><!-- fragment --><p> where the system matrix is stored as a <a class="el" href="classgismo_1_1gsSparseMatrix.html">gsSparseMatrix</a> and the right-hand-side as <a class="el" href="classgismo_1_1gsMatrix.html">gsMatrix</a>.</p>
<h1><a class="anchor" id="GetPostProcSolution"></a>
Computing and Post processing the solution</h1>
<p>Solving the linear system of equations is done in the main file. In this example of the Poisson problem, where we have a symmetric and positive definite system matrix, we can, for example, use the CG-solver of the <a class="elRef" href="http://eigen.tuxfamily.org/dox/namespaceEigen.html">Eigen</a> library, with a diagonal preconditioner.</p>
<div class="fragment"></div><!-- fragment --><p>The <code>solVector</code> contains the computed coefficients <em>without</em> the Dirichlet DOFs (which were eliminated). In order to obtain the discrete solution as a <a class="el" href="classgismo_1_1gsField.html">gsField</a>, we call</p>
<div class="fragment"></div><!-- fragment --><p>Finally we want to evaluate the (exact and approximate) solutions and write to a file:</p>
<div class="fragment"></div><!-- fragment --><p>the solutions can now opened and viewed in paraview.</p>
<h1><a class="anchor" id="poisson_exampleAnnotated"></a>
Annotated source file</h1>
<p>Here is the full file <code>examples/poisson_example.cpp</code>. Clicking on a function or class name will lead you to its reference documentation.</p>
<div class="fragment"></div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Jan 20 2025 09:35:27 for G+Smo by Doxygen v1.9.8 </li>
  </ul>
</div>
<!-- Piwik --> 
<!--
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? "https://stats.sylphide-consulting.com/piwik/" : "http://stats.sylphide-consulting.com/piwik/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 20);
piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
</script><noscript><p><img src="http://stats.sylphide-consulting.com/piwik/piwik.php?idsite=20" style="border:0" alt="" /></p></noscript>
-->
<!-- End Piwik Tracking Code -->
</body>
</html>
